<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>APM:Libraries: libraries/AP_AHRS/AP_AHRS.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_85ad937bf7c11de5c2907a482c9c56bd.html">AP_AHRS</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AP_AHRS.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AP__AHRS_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">  APM_AHRS.cpp</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">  This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">  it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">  the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">  (at your option) any later version.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">  This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">  GNU General Public License for more details.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">  along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__AHRS_8h.html">AP_AHRS.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__AHRS__View_8h.html">AP_AHRS_View.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__HAL_8h.html">AP_HAL/AP_HAL.h</a>&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__Logger_8h.html">AP_Logger/AP_Logger.h</a>&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__GPS_8h.html">AP_GPS/AP_GPS.h</a>&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__Baro_8h.html">AP_Baro/AP_Baro.h</a>&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__NMEA__Output_8h.html">AP_NMEA_Output/AP_NMEA_Output.h</a>&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code" href="AP__AHRS_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">// table of user settable parameters</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">const</span> <a class="code" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code" href="classAP__AHRS.html#ac88d8ea5756954941e568cc76670a674">AP_AHRS::var_info</a>[] = {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">// index 0 and 1 are for old parameters that are no longer not used</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">// @Param: GPS_GAIN</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="comment">// @DisplayName: AHRS GPS gain</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <span class="comment">// @Description: This controls how much to use the GPS to correct the attitude. This should never be set to zero for a plane as it would result in the plane losing control in turns. For a plane please use the default value of 1.0.</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// @Range: 0.0 1.0</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// @Increment: .01</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;GPS_GAIN&quot;</span>,  2, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, gps_gain, 1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// @Param: GPS_USE</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="comment">// @DisplayName: AHRS use GPS for navigation</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="comment">// @Description: This controls whether to use dead-reckoning or GPS based navigation. If set to 0 then the GPS won&#39;t be used for navigation, and only dead reckoning will be used. A value of zero should never be used for normal flight. Currently this affects only the DCM-based AHRS: the EKF uses GPS whenever it is available.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;GPS_USE&quot;</span>,  3, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _gps_use, 1),</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// @Param: YAW_P</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// @DisplayName: Yaw P</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <span class="comment">// @Description: This controls the weight the compass or GPS has on the heading. A higher value means the heading will track the yaw source (GPS or compass) more rapidly.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="comment">// @Range: 0.1 0.4</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// @Increment: .01</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;YAW_P&quot;</span>, 4,    <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _kp_yaw, 0.2<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// @Param: RP_P</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// @DisplayName: AHRS RP_P</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// @Description: This controls how fast the accelerometers correct the attitude</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// @Range: 0.1 0.4</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// @Increment: .01</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;RP_P&quot;</span>,  5,    <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _kp, 0.2<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// @Param: WIND_MAX</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// @DisplayName: Maximum wind</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// @Description: This sets the maximum allowable difference between ground speed and airspeed. This allows the plane to cope with a failing airspeed sensor. A value of zero means to use the airspeed as is.</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// @Range: 0 127</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// @Units: m/s</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;WIND_MAX&quot;</span>,  6,    <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _wind_max, 0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// NOTE: 7 was BARO_USE</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// @Param: TRIM_X</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// @DisplayName: AHRS Trim Roll</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// @Description: Compensates for the roll angle difference between the control board and the frame. Positive values make the vehicle roll right.</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// @Units: rad</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// @Range: -0.1745 +0.1745</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="comment">// @Increment: 0.01</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// @Param: TRIM_Y</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// @DisplayName: AHRS Trim Pitch</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// @Description: Compensates for the pitch angle difference between the control board and the frame. Positive values make the vehicle pitch up/back.</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// @Units: rad</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// @Range: -0.1745 +0.1745</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="comment">// @Increment: 0.01</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// @Param: TRIM_Z</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// @DisplayName: AHRS Trim Yaw</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// @Description: Not Used</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// @Units: rad</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// @Range: -0.1745 +0.1745</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="comment">// @Increment: 0.01</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;TRIM&quot;</span>, 8, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _trim, 0),</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// @Param: ORIENTATION</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// @DisplayName: Board Orientation</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// @Description: Overall board orientation relative to the standard orientation for the board type. This rotates the IMU and compass readings to allow the board to be oriented in your vehicle at any 90 or 45 degree angle. This option takes affect on next boot. After changing you will need to re-level your vehicle.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="comment">// @Values: 0:None,1:Yaw45,2:Yaw90,3:Yaw135,4:Yaw180,5:Yaw225,6:Yaw270,7:Yaw315,8:Roll180,9:Roll180Yaw45,10:Roll180Yaw90,11:Roll180Yaw135,12:Pitch180,13:Roll180Yaw225,14:Roll180Yaw270,15:Roll180Yaw315,16:Roll90,17:Roll90Yaw45,18:Roll90Yaw90,19:Roll90Yaw135,20:Roll270,21:Roll270Yaw45,22:Roll270Yaw90,23:Roll270Yaw135,24:Pitch90,25:Pitch270,26:Pitch180Yaw90,27:Pitch180Yaw270,28:Roll90Pitch90,29:Roll180Pitch90,30:Roll270Pitch90,31:Roll90Pitch180,32:Roll270Pitch180,33:Roll90Pitch270,34:Roll180Pitch270,35:Roll270Pitch270,36:Roll90Pitch180Yaw90,37:Roll90Yaw270,38:Yaw293Pitch68Roll180,39:Pitch315,40:Roll90Pitch315,100:Custom</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ORIENTATION&quot;</span>, 9, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _board_orientation, 0),</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// @Param: COMP_BETA</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// @DisplayName: AHRS Velocity Complementary Filter Beta Coefficient</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// @Description: This controls the time constant for the cross-over frequency used to fuse AHRS (airspeed and heading) and GPS data to estimate ground velocity. Time constant is 0.1/beta. A larger time constant will use GPS data less and a small time constant will use air data less.</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// @Range: 0.001 0.5</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// @Increment: .01</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;COMP_BETA&quot;</span>,  10, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, beta, 0.1<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>),</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// @Param: GPS_MINSATS</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">// @DisplayName: AHRS GPS Minimum satellites</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// @Description: Minimum number of satellites visible to use GPS for velocity based corrections attitude correction. This defaults to 6, which is about the point at which the velocity numbers from a GPS become too unreliable for accurate correction of the accelerometers.</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// @Range: 0 10</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;GPS_MINSATS&quot;</span>, 11, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _gps_minsats, 6),</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// NOTE: index 12 was for GPS_DELAY, but now removed, fixed delay</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// of 1 was found to be the best choice</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// 13 was the old EKF_USE</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#if AP_AHRS_NAVEKF_AVAILABLE</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// @Param: EKF_TYPE</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// @DisplayName: Use NavEKF Kalman filter for attitude and position estimation</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// @Description: This controls which NavEKF Kalman filter version is used for attitude and position estimation</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// @Values: 0:Disabled,2:Enable EKF2,3:Enable EKF3</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EKF_TYPE&quot;</span>,  14, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _ekf_type, 2),</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// @Param: CUSTOM_ROLL</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// @DisplayName: Board orientation roll offset</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// @Description: Autopilot mounting position roll offset. Positive values = roll right, negative values = roll left. This parameter is only used when AHRS_ORIENTATION is set to CUSTOM.</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// @Range: -180 180</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// @Units: deg</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;CUSTOM_ROLL&quot;</span>, 15, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _custom_roll, 0),</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// @Param: CUSTOM_PIT</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// @DisplayName: Board orientation pitch offset</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// @Description: Autopilot mounting position pitch offset. Positive values = pitch up, negative values = pitch down. This parameter is only used when AHRS_ORIENTATION is set to CUSTOM.</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="comment">// @Range: -180 180</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// @Units: deg</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;CUSTOM_PIT&quot;</span>, 16, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _custom_pitch, 0),</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// @Param: CUSTOM_YAW</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// @DisplayName: Board orientation yaw offset</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// @Description: Autopilot mounting position yaw offset. Positive values = yaw right, negative values = yaw left. This parameter is only used when AHRS_ORIENTATION is set to CUSTOM.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// @Range: -180 180</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// @Units: deg</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;CUSTOM_YAW&quot;</span>, 17, <a class="code" href="classAP__AHRS.html">AP_AHRS</a>, _custom_yaw, 0),</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;};</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">// init sets up INS board orientation</span></div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a61a8beb36c6b10a6ece0d06f76d4bd2d">  166</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a61a8beb36c6b10a6ece0d06f76d4bd2d">AP_AHRS::init</a>()</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;{</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classAP__AHRS.html#a7284d5e65c5863f5678b4d93000b116e">update_orientation</a>();</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#if !HAL_MINIMIZE_FEATURES &amp;&amp; AP_AHRS_NAVEKF_AVAILABLE</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classAP__AHRS.html#a95844517e2d3f5cc31db1d6b7c0d0982">_nmea_out</a> = AP_NMEA_Output::probe();</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">// return a smoothed and corrected gyro vector using the latest ins data (which may not have been consumed by the EKF yet)</span></div><div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a6a87cc57a950be81a068cc2cf270447a">  176</a></span>&#160;<a class="code" href="classVector3.html">Vector3f</a> <a class="code" href="classAP__AHRS.html#a6a87cc57a950be81a068cc2cf270447a">AP_AHRS::get_gyro_latest</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keyword">const</span> uint8_t primary_gyro = <a class="code" href="classAP__AHRS.html#ad317e5df250980cadcb8cea9f074ed1e">get_primary_gyro_index</a>();</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceAP.html#ac571aa5a2ef71b7f4b4b2bfa09143fb9">AP::ins</a>().<a class="code" href="classAP__InertialSensor.html#a8ca4ae8fdc18ff0d78f8dea93759cc93">get_gyro</a>(primary_gyro) + <a class="code" href="classAP__AHRS.html#a6876435645c1049077f33f225ab828f7">get_gyro_drift</a>();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;}</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">// return airspeed estimate if available</span></div><div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#aba88eab2ab7bb6f525934fb06d30e780">  183</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAP__AHRS.html#aba88eab2ab7bb6f525934fb06d30e780">AP_AHRS::airspeed_estimate</a>(<span class="keywordtype">float</span> *airspeed_ret)<span class="keyword"> const</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a47ea335b3b317f0c5e54320f59d5ca8a">airspeed_sensor_enabled</a>()) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        *airspeed_ret = <a class="code" href="classAP__AHRS.html#a2aaf9d61606d9973dca3890ca7b91eb2">_airspeed</a>-&gt;<a class="code" href="classAP__Airspeed.html#a02885c320f3cedbc08c02bc8894aba04">get_airspeed</a>();</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#acad24c37755823c587a684969b1cbf22">_wind_max</a> &gt; 0 &amp;&amp; <a class="code" href="namespaceAP.html#ae6eeec356455220f913e47e323057cd5">AP::gps</a>().status() &gt;= <a class="code" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">AP_GPS::GPS_OK_FIX_2D</a>) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="comment">// constrain the airspeed by the ground speed</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="comment">// and AHRS_WIND_MAX</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> gnd_speed = <a class="code" href="namespaceAP.html#ae6eeec356455220f913e47e323057cd5">AP::gps</a>().<a class="code" href="classAP__GPS.html#ae7f097588dd863d4624f6fec1509e0e6">ground_speed</a>();</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            <span class="keywordtype">float</span> true_airspeed = *airspeed_ret * <a class="code" href="classAP__AHRS.html#a64786b58a1607ee420ed4f0696c755b6">get_EAS2TAS</a>();</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            true_airspeed = <a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(true_airspeed,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                            gnd_speed - <a class="code" href="classAP__AHRS.html#acad24c37755823c587a684969b1cbf22">_wind_max</a>,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                            gnd_speed + <a class="code" href="classAP__AHRS.html#acad24c37755823c587a684969b1cbf22">_wind_max</a>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            *airspeed_ret = true_airspeed / <a class="code" href="classAP__AHRS.html#a64786b58a1607ee420ed4f0696c755b6">get_EAS2TAS</a>();</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">// set_trim</span></div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#ab45359e5c71751e421577e6a2d85625e">  203</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#ab45359e5c71751e421577e6a2d85625e">AP_AHRS::set_trim</a>(<span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;new_trim)</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;{</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="classVector3.html">Vector3f</a> trim;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    trim.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> = <a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(new_trim.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(-<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>), <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>));</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    trim.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> = <a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(new_trim.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>, <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(-<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>), <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>));</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">_trim</a>.set_and_save(trim);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">// add_trim - adjust the roll and pitch trim up to a total of 10 degrees</span></div><div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a783631a678ef9034b1357c9aa93e1280">  212</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a783631a678ef9034b1357c9aa93e1280">AP_AHRS::add_trim</a>(<span class="keywordtype">float</span> roll_in_radians, <span class="keywordtype">float</span> pitch_in_radians, <span class="keywordtype">bool</span> save_to_eeprom)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="classVector3.html">Vector3f</a> trim = <a class="code" href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">_trim</a>.get();</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// add new trim</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    trim.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> = <a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(trim.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> + roll_in_radians, <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(-<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>), <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>));</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    trim.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> = <a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(trim.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> + pitch_in_radians, <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(-<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>), <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(<a class="code" href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a>));</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// set new trim values</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">_trim</a>.set(trim);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// save to eeprom</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span>( save_to_eeprom ) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <a class="code" href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">_trim</a>.save();</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;}</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">// Set the board mounting orientation, may be called while disarmed</span></div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a7284d5e65c5863f5678b4d93000b116e">  230</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a7284d5e65c5863f5678b4d93000b116e">AP_AHRS::update_orientation</a>()</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;{</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keyword">const</span> <span class="keyword">enum</span> <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681">Rotation</a> orientation = (<span class="keyword">enum</span> <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681">Rotation</a>)<a class="code" href="classAP__AHRS.html#a5c987313ac84c5548c4b0c1c387ea933">_board_orientation</a>.get();</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (orientation != <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a621932380092e03bd929b22f6a1945ed">ROTATION_CUSTOM</a>) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <a class="code" href="namespaceAP.html#ac571aa5a2ef71b7f4b4b2bfa09143fb9">AP::ins</a>().<a class="code" href="classAP__InertialSensor.html#a101cb0b8b188ced0f16db50a5e45fb7b">set_board_orientation</a>(orientation);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a21b884a673a423f46958f216a5ce6a86">_compass</a> != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <a class="code" href="classAP__AHRS.html#a21b884a673a423f46958f216a5ce6a86">_compass</a>-&gt;<a class="code" href="classCompass.html#ad7386676db63a3c8da5ecaa977522526">set_board_orientation</a>(orientation);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="classAP__AHRS.html#ad90dcc92a4e33a426f2cce84571e91d3">_custom_rotation</a>.<a class="code" href="classMatrix3.html#a62587bd216436f09f06b9e1330f84bc0">from_euler</a>(<a class="code" href="classAP__AHRS.html#a81276058507961059a7793e8cce07a4b">_custom_roll</a>, <a class="code" href="classAP__AHRS.html#a1bffad8e44fe1764ac5833ad649205b5">_custom_pitch</a>, <a class="code" href="classAP__AHRS.html#a354defc08c7357268a3a3337bb4d4d37">_custom_yaw</a>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="namespaceAP.html#ac571aa5a2ef71b7f4b4b2bfa09143fb9">AP::ins</a>().<a class="code" href="classAP__InertialSensor.html#a101cb0b8b188ced0f16db50a5e45fb7b">set_board_orientation</a>(orientation, &amp;<a class="code" href="classAP__AHRS.html#ad90dcc92a4e33a426f2cce84571e91d3">_custom_rotation</a>);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a21b884a673a423f46958f216a5ce6a86">_compass</a> != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            <a class="code" href="classAP__AHRS.html#a21b884a673a423f46958f216a5ce6a86">_compass</a>-&gt;<a class="code" href="classCompass.html#ad7386676db63a3c8da5ecaa977522526">set_board_orientation</a>(orientation, &amp;<a class="code" href="classAP__AHRS.html#ad90dcc92a4e33a426f2cce84571e91d3">_custom_rotation</a>);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;}</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">// return a ground speed estimate in m/s</span></div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#aa2fd48ce0265df723cc8d05bb2150749">  248</a></span>&#160;<a class="code" href="structVector2.html">Vector2f</a> <a class="code" href="classAP__AHRS.html#aa2fd48ce0265df723cc8d05bb2150749">AP_AHRS::groundspeed_vector</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;{</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// Generate estimate of ground speed vector using air data system</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="structVector2.html">Vector2f</a> gndVelADS;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <a class="code" href="structVector2.html">Vector2f</a> gndVelGPS;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordtype">float</span> <a class="code" href="Airspeed_8cpp.html#abfed87a61c42e885ee14d5222b47583f">airspeed</a> = 0;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> gotAirspeed = <a class="code" href="classAP__AHRS.html#a29755586a9138e9562961044340b1f0a">airspeed_estimate_true</a>(&amp;<a class="code" href="Airspeed_8cpp.html#abfed87a61c42e885ee14d5222b47583f">airspeed</a>);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> gotGPS = (<a class="code" href="namespaceAP.html#ae6eeec356455220f913e47e323057cd5">AP::gps</a>().<a class="code" href="classAP__GPS.html#ac22b61d2e6cf0b6ff647173ea336de01">status</a>() &gt;= <a class="code" href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">AP_GPS::GPS_OK_FIX_2D</a>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (gotAirspeed) {</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> wind = <a class="code" href="classAP__AHRS.html#a01436317dbb7f62470f56b66af4e872d">wind_estimate</a>();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keyword">const</span> <a class="code" href="structVector2.html">Vector2f</a> wind2d(wind.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, wind.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keyword">const</span> <a class="code" href="structVector2.html">Vector2f</a> airspeed_vector(<a class="code" href="classAP__AHRS.html#a31317890a8768d2896b339e23147bada">_cos_yaw</a> * <a class="code" href="Airspeed_8cpp.html#abfed87a61c42e885ee14d5222b47583f">airspeed</a>, <a class="code" href="classAP__AHRS.html#a1b78799772ad2c3adfd4ea2b422a704d">_sin_yaw</a> * <a class="code" href="Airspeed_8cpp.html#abfed87a61c42e885ee14d5222b47583f">airspeed</a>);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        gndVelADS = airspeed_vector + wind2d;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// Generate estimate of ground speed vector using GPS</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> (gotGPS) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> cog = <a class="code" href="AP__Math_8h.html#a37d7c62a8231d9d22826261297b99da4">radians</a>(<a class="code" href="namespaceAP.html#ae6eeec356455220f913e47e323057cd5">AP::gps</a>().ground_course_cd()*0.01<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        gndVelGPS = <a class="code" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(cosf(cog), sinf(cog)) * <a class="code" href="namespaceAP.html#ae6eeec356455220f913e47e323057cd5">AP::gps</a>().<a class="code" href="classAP__GPS.html#ae7f097588dd863d4624f6fec1509e0e6">ground_speed</a>();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">// If both ADS and GPS data is available, apply a complementary filter</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">if</span> (gotAirspeed &amp;&amp; gotGPS) {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">// The LPF is applied to the GPS and the HPF is applied to the air data estimate</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// before the two are summed</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="comment">//Define filter coefficients</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// alpha and beta must sum to one</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="comment">// beta = dt/Tau, where</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">// dt = filter time step (0.1 sec if called by nav loop)</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="comment">// Tau = cross-over time constant (nominal 2 seconds)</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="comment">// More lag on GPS requires Tau to be bigger, less lag allows it to be smaller</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        <span class="comment">// To-Do - set Tau as a function of GPS lag.</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> alpha = 1.0f - <a class="code" href="classAP__AHRS.html#a80d5ae913ca88ab8fbdcca779221c8cc">beta</a>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="comment">// Run LP filters</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <a class="code" href="classAP__AHRS.html#adedc7b6972ea5295658549c3a4d357cf">_lp</a> = gndVelGPS * <a class="code" href="classAP__AHRS.html#a80d5ae913ca88ab8fbdcca779221c8cc">beta</a>  + <a class="code" href="classAP__AHRS.html#adedc7b6972ea5295658549c3a4d357cf">_lp</a> * alpha;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="comment">// Run HP filters</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <a class="code" href="classAP__AHRS.html#a871b43cfe1eb9237ed763d83d4d3cbe2">_hp</a> = (gndVelADS - <a class="code" href="classAP__AHRS.html#a8a371073599619698a9bad679a55b6d7">_lastGndVelADS</a>) + <a class="code" href="classAP__AHRS.html#a871b43cfe1eb9237ed763d83d4d3cbe2">_hp</a> * alpha;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="comment">// Save the current ADS ground vector for the next time step</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="classAP__AHRS.html#a8a371073599619698a9bad679a55b6d7">_lastGndVelADS</a> = gndVelADS;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="comment">// Sum the HP and LP filter outputs</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classAP__AHRS.html#a871b43cfe1eb9237ed763d83d4d3cbe2">_hp</a> + <a class="code" href="classAP__AHRS.html#adedc7b6972ea5295658549c3a4d357cf">_lp</a>;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// Only ADS data is available return ADS estimate</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span> (gotAirspeed &amp;&amp; !gotGPS) {</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">return</span> gndVelADS;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// Only GPS data is available so return GPS estimate</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (!gotAirspeed &amp;&amp; gotGPS) {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">return</span> gndVelGPS;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Airspeed_8cpp.html#abfed87a61c42e885ee14d5222b47583f">airspeed</a> &gt; 0) {</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="comment">// we have a rough airspeed, and we have a yaw. For</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="comment">// dead-reckoning purposes we can create a estimated</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="comment">// groundspeed vector</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="structVector2.html">Vector2f</a> ret(cosf(<a class="code" href="classAP__AHRS.html#a63359ca9325c63642050bcf1c3e1cd63">yaw</a>), sinf(<a class="code" href="classAP__AHRS.html#a63359ca9325c63642050bcf1c3e1cd63">yaw</a>));</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        ret *= <a class="code" href="Airspeed_8cpp.html#abfed87a61c42e885ee14d5222b47583f">airspeed</a>;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="comment">// adjust for estimated wind</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> wind = <a class="code" href="classAP__AHRS.html#a01436317dbb7f62470f56b66af4e872d">wind_estimate</a>();</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        ret.<a class="code" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a> += wind.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        ret.<a class="code" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a> += wind.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>, 0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;}</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">  calculate sin and cos of roll/pitch/yaw from a body_to_ned rotation matrix</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#af55335ae1d37aff06bc6ad997b9f5ab0">  317</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#af55335ae1d37aff06bc6ad997b9f5ab0">AP_AHRS::calc_trig</a>(<span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3f</a> &amp;rot,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                        <span class="keywordtype">float</span> &amp;cr, <span class="keywordtype">float</span> &amp;cp, <span class="keywordtype">float</span> &amp;cy,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                        <span class="keywordtype">float</span> &amp;sr, <span class="keywordtype">float</span> &amp;sp, <span class="keywordtype">float</span> &amp;sy)<span class="keyword"> const</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="structVector2.html">Vector2f</a> yaw_vector(rot.<a class="code" href="classMatrix3.html#acd7bf3421047fa155168a9c8e5164a2b">a</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, rot.<a class="code" href="classMatrix3.html#ae16bed039ad87c3337f15837c33fe2fb">b</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (fabsf(yaw_vector.<a class="code" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a>) &gt; 0 ||</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        fabsf(yaw_vector.<a class="code" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a>) &gt; 0) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        yaw_vector.<a class="code" href="structVector2.html#ace2a626eaa79412e2946216e9c3e63c6">normalize</a>();</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    sy = <a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(yaw_vector.<a class="code" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a>, -1.0f, 1.0f);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    cy = <a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(yaw_vector.<a class="code" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a>, -1.0f, 1.0f);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// sanity checks</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (yaw_vector.<a class="code" href="structVector2.html#a4e9114e7f5f457d4ab8b4d33e9d253c9">is_inf</a>() || yaw_vector.<a class="code" href="structVector2.html#aa53d6fde95d48878ba8eb99abab80997">is_nan</a>()) {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        sy = 0.0f;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        cy = 1.0f;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> cx2 = rot.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> * rot.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> (cx2 &gt;= 1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        cp = 0;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        cr = 1.0f;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        cp = <a class="code" href="AP__Math_8cpp.html#ac89eb1832d8e4d67fcf1ac07e3c25184">safe_sqrt</a>(1 - cx2);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        cr = rot.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> / cp;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    cp = <a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(cp, 0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>, 1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    cr = <a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(cr, -1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>, 1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>); <span class="comment">// this relies on constrain_float() of infinity doing the right thing</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    sp = -rot.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(cp)) {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        sr = rot.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> / cp;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(cp) || isinf(cr) || isnan(cr) || isinf(sr) || isnan(sr)) {</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordtype">float</span> r, p, y;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        rot.<a class="code" href="classMatrix3.html#a3a809878d75c408fb8173b052016b529">to_euler</a>(&amp;r, &amp;p, &amp;y);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        cr = cosf(r);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        sr = sinf(r);</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;}</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">// update_trig - recalculates _cos_roll, _cos_pitch, etc based on latest attitude</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">//      should be called after _dcm_matrix is updated</span></div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a34c0a28db3bc87426f69e34e5949bd8b">  363</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a34c0a28db3bc87426f69e34e5949bd8b">AP_AHRS::update_trig</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a2b1eae408a12feccfe34308ef0608e21">_last_trim</a> != <a class="code" href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">_trim</a>.get()) {</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="classAP__AHRS.html#a2b1eae408a12feccfe34308ef0608e21">_last_trim</a> = <a class="code" href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">_trim</a>.get();</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <a class="code" href="classAP__AHRS.html#a5286f1508ed0f81d4a81086c9bc88d7e">_rotation_autopilot_body_to_vehicle_body</a>.<a class="code" href="classMatrix3.html#a62587bd216436f09f06b9e1330f84bc0">from_euler</a>(<a class="code" href="classAP__AHRS.html#a2b1eae408a12feccfe34308ef0608e21">_last_trim</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>, <a class="code" href="classAP__AHRS.html#a2b1eae408a12feccfe34308ef0608e21">_last_trim</a>.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>, 0.0f);</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <a class="code" href="classAP__AHRS.html#a641b4bea4de708dbfa1d01039bfde2e8">_rotation_vehicle_body_to_autopilot_body</a> = <a class="code" href="classAP__AHRS.html#a5286f1508ed0f81d4a81086c9bc88d7e">_rotation_autopilot_body_to_vehicle_body</a>.<a class="code" href="classMatrix3.html#aa964ba5be20b0fb821685cc065156f56">transposed</a>();</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="classAP__AHRS.html#af55335ae1d37aff06bc6ad997b9f5ab0">calc_trig</a>(<a class="code" href="classAP__AHRS.html#a8a1988bb283c488c86b329be18271fbf">get_rotation_body_to_ned</a>(),</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;              <a class="code" href="classAP__AHRS.html#a0bd52134b07d344dfef3dc94c72e9dff">_cos_roll</a>, <a class="code" href="classAP__AHRS.html#a7d767db49bc14c505049e93ab11e793c">_cos_pitch</a>, <a class="code" href="classAP__AHRS.html#a31317890a8768d2896b339e23147bada">_cos_yaw</a>,</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;              <a class="code" href="classAP__AHRS.html#a4eb96371ee8cf2b4fb9f453aced2ac44">_sin_roll</a>, <a class="code" href="classAP__AHRS.html#a99bd2d830e0c1c57c6e4aba4b53d967d">_sin_pitch</a>, <a class="code" href="classAP__AHRS.html#a1b78799772ad2c3adfd4ea2b422a704d">_sin_yaw</a>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;}</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">  update the centi-degree values</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00379"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a8bf3f8d2410b5456bc43b937c872e6bb">  379</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a8bf3f8d2410b5456bc43b937c872e6bb">AP_AHRS::update_cd_values</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;{</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="classAP__AHRS.html#a0c6e82280b005a339b04028b1f5ea70d">roll_sensor</a>  = <a class="code" href="moduletest_8c.html#a903c4797a4c2860e3b9a6a978f98a44d">degrees</a>(<a class="code" href="classAP__AHRS.html#a384a23e205126cf43e91bec9668b7ed0">roll</a>) * 100;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="classAP__AHRS.html#af3394de208d1f96457382d79ab7a8d01">pitch_sensor</a> = <a class="code" href="moduletest_8c.html#a903c4797a4c2860e3b9a6a978f98a44d">degrees</a>(<a class="code" href="classAP__AHRS.html#a2aa61744614d8e0ef64803583359a56e">pitch</a>) * 100;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <a class="code" href="classAP__AHRS.html#a8a160130dd99016a19abab9d85917261">yaw_sensor</a>   = <a class="code" href="moduletest_8c.html#a903c4797a4c2860e3b9a6a978f98a44d">degrees</a>(<a class="code" href="classAP__AHRS.html#a63359ca9325c63642050bcf1c3e1cd63">yaw</a>) * 100;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a8a160130dd99016a19abab9d85917261">yaw_sensor</a> &lt; 0)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <a class="code" href="classAP__AHRS.html#a8a160130dd99016a19abab9d85917261">yaw_sensor</a> += 36000;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">  create a rotated view of AP_AHRS with optional pitch trim</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#aed32713548839b922b9bc27379074ddb">  391</a></span>&#160;<a class="code" href="classAP__AHRS__View.html">AP_AHRS_View</a> *<a class="code" href="classAP__AHRS.html#aed32713548839b922b9bc27379074ddb">AP_AHRS::create_view</a>(<span class="keyword">enum</span> <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681">Rotation</a> rotation, <span class="keywordtype">float</span> pitch_trim_deg)</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;{</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#ad3ac110b7f3e2e6c8eaca68fad92090e">_view</a> != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// can only have one</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="classAP__AHRS.html#ad3ac110b7f3e2e6c8eaca68fad92090e">_view</a> = <span class="keyword">new</span> <a class="code" href="classAP__AHRS.html#ab5d0d060c6bf6239e469dc0cbd5fa75c">AP_AHRS_View</a>(*<span class="keyword">this</span>, rotation, pitch_trim_deg);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classAP__AHRS.html#ad3ac110b7f3e2e6c8eaca68fad92090e">_view</a>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;}</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"> * Update AOA and SSA estimation based on airspeed, velocity vector and wind vector</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment"> * Based on:</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"> * &quot;On estimation of wind velocity, angle-of-attack and sideslip angle of small UAVs using standard sensors&quot; by</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"> * Tor A. Johansen, Andrea Cristofaro, Kim Sorensen, Jakob M. Hansen, Thor I. Fossen</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"> * &quot;Multi-Stage Fusion Algorithm for Estimation of Aerodynamic Angles in Mini Aerial Vehicle&quot; by</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment"> * C.Ramprasadh and Hemendra Arya</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"> * &quot;ANGLE OF ATTACK AND SIDESLIP ESTIMATION USING AN INERTIAL REFERENCE PLATFORM&quot; by</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"> * JOSEPH E. ZEIS, JR., CAPTAIN, USAF</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a7328e4bc4caf3cb87a16915edcde932e">  414</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a7328e4bc4caf3cb87a16915edcde932e">AP_AHRS::update_AOA_SSA</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;{</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#if APM_BUILD_TYPE(APM_BUILD_ArduPlane)</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keyword">const</span> uint32_t now = <a class="code" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>();</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="keywordflow">if</span> (now - <a class="code" href="classAP__AHRS.html#a759ae3406c3e0c9c5a5464dcbd1e074d">_last_AOA_update_ms</a> &lt; 50) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="comment">// don&#39;t update at more than 20Hz</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <a class="code" href="classAP__AHRS.html#a759ae3406c3e0c9c5a5464dcbd1e074d">_last_AOA_update_ms</a> = now;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    </div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <a class="code" href="classVector3.html">Vector3f</a> aoa_velocity, aoa_wind;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// get velocity and wind</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a69b21caefc3aab8edc889cb7a181a756">get_velocity_NED</a>(aoa_velocity) == <span class="keyword">false</span>) {</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    aoa_wind = <a class="code" href="classAP__AHRS.html#a01436317dbb7f62470f56b66af4e872d">wind_estimate</a>();</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// Rotate vectors to the body frame and calculate velocity and wind</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3f</a> &amp;rot = <a class="code" href="classAP__AHRS.html#a8a1988bb283c488c86b329be18271fbf">get_rotation_body_to_ned</a>();</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    aoa_velocity = rot.<a class="code" href="classMatrix3.html#a212a94e2a9c26def827fa766f4d0ae3e">mul_transpose</a>(aoa_velocity);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    aoa_wind = rot.<a class="code" href="classMatrix3.html#a212a94e2a9c26def827fa766f4d0ae3e">mul_transpose</a>(aoa_wind);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">// calculate relative velocity in body coordinates</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    aoa_velocity = aoa_velocity - aoa_wind;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">float</span> vel_len = aoa_velocity.<a class="code" href="classVector3.html#afcdfe81173c23d57e4a53a0282cddae7">length</a>();</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">// do not calculate if speed is too low</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">if</span> (vel_len &lt; 2.0) {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <a class="code" href="classAP__AHRS.html#a29132639c26378ac1003c49477d98dd3">_AOA</a> = 0;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <a class="code" href="classAP__AHRS.html#a0ec7142b7338d3049f67ef4f042e288e">_SSA</a> = 0;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    }</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// Calculate AOA and SSA</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span> (aoa_velocity.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> &gt; 0) {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <a class="code" href="classAP__AHRS.html#a29132639c26378ac1003c49477d98dd3">_AOA</a> = <a class="code" href="moduletest_8c.html#a903c4797a4c2860e3b9a6a978f98a44d">degrees</a>(atanf(aoa_velocity.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> / aoa_velocity.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>));</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <a class="code" href="classAP__AHRS.html#a29132639c26378ac1003c49477d98dd3">_AOA</a> = 0;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    }</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="classAP__AHRS.html#a0ec7142b7338d3049f67ef4f042e288e">_SSA</a> = <a class="code" href="moduletest_8c.html#a903c4797a4c2860e3b9a6a978f98a44d">degrees</a>(<a class="code" href="AP__Math_8cpp.html#a3370ada2588e54722319d65e00d8545c">safe_asin</a>(aoa_velocity.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> / vel_len));</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;}</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">// return current AOA</span></div><div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a6f06d92b5a60228c9e14ed04a52d6743">  461</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classAP__AHRS.html#a6f06d92b5a60228c9e14ed04a52d6743">AP_AHRS::getAOA</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;{</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="classAP__AHRS.html#a7328e4bc4caf3cb87a16915edcde932e">update_AOA_SSA</a>();</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classAP__AHRS.html#a29132639c26378ac1003c49477d98dd3">_AOA</a>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;}</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">// return calculated SSA</span></div><div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a6b7ca065135dc4f0c06879b6a5bca2db">  468</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classAP__AHRS.html#a6b7ca065135dc4f0c06879b6a5bca2db">AP_AHRS::getSSA</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;{</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="classAP__AHRS.html#a7328e4bc4caf3cb87a16915edcde932e">update_AOA_SSA</a>();</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classAP__AHRS.html#a0ec7142b7338d3049f67ef4f042e288e">_SSA</a>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;}</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">// rotate a 2D vector from earth frame to body frame</span></div><div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a81be6f5e1f8b4b753cc5131532802bc2">  475</a></span>&#160;<a class="code" href="structVector2.html">Vector2f</a> <a class="code" href="classAP__AHRS.html#a81be6f5e1f8b4b753cc5131532802bc2">AP_AHRS::rotate_earth_to_body2D</a>(<span class="keyword">const</span> <a class="code" href="structVector2.html">Vector2f</a> &amp;ef)<span class="keyword"> const</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(ef.<a class="code" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a> * <a class="code" href="classAP__AHRS.html#a31317890a8768d2896b339e23147bada">_cos_yaw</a> + ef.<a class="code" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a> * <a class="code" href="classAP__AHRS.html#a1b78799772ad2c3adfd4ea2b422a704d">_sin_yaw</a>,</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    -ef.<a class="code" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a> * <a class="code" href="classAP__AHRS.html#a1b78799772ad2c3adfd4ea2b422a704d">_sin_yaw</a> + ef.<a class="code" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a> * <a class="code" href="classAP__AHRS.html#a31317890a8768d2896b339e23147bada">_cos_yaw</a>);</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;}</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">// rotate a 2D vector from earth frame to body frame</span></div><div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#af4b0173305e02652ff9362c8718d9033">  482</a></span>&#160;<a class="code" href="structVector2.html">Vector2f</a> <a class="code" href="classAP__AHRS.html#af4b0173305e02652ff9362c8718d9033">AP_AHRS::rotate_body_to_earth2D</a>(<span class="keyword">const</span> <a class="code" href="structVector2.html">Vector2f</a> &amp;bf)<span class="keyword"> const</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(bf.<a class="code" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a> * <a class="code" href="classAP__AHRS.html#a31317890a8768d2896b339e23147bada">_cos_yaw</a> - bf.<a class="code" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a> * <a class="code" href="classAP__AHRS.html#a1b78799772ad2c3adfd4ea2b422a704d">_sin_yaw</a>,</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    bf.<a class="code" href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">x</a> * <a class="code" href="classAP__AHRS.html#a1b78799772ad2c3adfd4ea2b422a704d">_sin_yaw</a> + bf.<a class="code" href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">y</a> * <a class="code" href="classAP__AHRS.html#a31317890a8768d2896b339e23147bada">_cos_yaw</a>);</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;}</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">// log ahrs home and EKF origin</span></div><div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#ac9514f5193b6a15b16d995fd8ee0e4c4">  489</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#ac9514f5193b6a15b16d995fd8ee0e4c4">AP_AHRS::Log_Write_Home_And_Origin</a>()</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;{</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="classAP__Logger.html">AP_Logger</a> *<a class="code" href="AHRS__Test_8cpp.html#a9fede12aaeb5750bcb131cae0430647c">logger</a> = <a class="code" href="classAP__Logger.html#a7dfeda4dc3df2edc8531110c9d7252dc">AP_Logger::get_singleton</a>();</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AHRS__Test_8cpp.html#a9fede12aaeb5750bcb131cae0430647c">logger</a> == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="preprocessor">#if AP_AHRS_NAVEKF_AVAILABLE</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="classLocation.html">Location</a> ekf_orig;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a1c0edc87d7376462e827a694613df3b4">get_origin</a>(ekf_orig)) {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        <a class="code" href="AHRS__Test_8cpp.html#a9fede12aaeb5750bcb131cae0430647c">logger</a>-&gt;<a class="code" href="classAP__Logger.html#ac62c839cf8b76931790297cec22305da">Write_Origin</a>(<a class="code" href="LogStructure_8h.html#ab36c838093e3699b68977ecfff272bc8a5f73dc8b4696c3114bbc7015b24103fd">LogOriginType::ekf_origin</a>, ekf_orig);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a4ffe6b0b13f7f4106740105101fed115">home_is_set</a>()) {</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <a class="code" href="AHRS__Test_8cpp.html#a9fede12aaeb5750bcb131cae0430647c">logger</a>-&gt;<a class="code" href="classAP__Logger.html#ac62c839cf8b76931790297cec22305da">Write_Origin</a>(<a class="code" href="LogStructure_8h.html#ab36c838093e3699b68977ecfff272bc8a79a3f059d8a988f397e881e1045e8e39">LogOriginType::ahrs_home</a>, <a class="code" href="classAP__AHRS.html#a015bc176be954e9814ff3bdc4c2733af">_home</a>);</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    }</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">// get apparent to true airspeed ratio</span></div><div class="line"><a name="l00508"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a64786b58a1607ee420ed4f0696c755b6">  508</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classAP__AHRS.html#a64786b58a1607ee420ed4f0696c755b6">AP_AHRS::get_EAS2TAS</a>(<span class="keywordtype">void</span>)<span class="keyword"> const </span>{</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceAP.html#a8aec57eb0b7a79044cbc1f0ca4b75bcf">AP::baro</a>().<a class="code" href="classAP__Baro.html#a0115c37618652051c1f6efd072fcc74b">get_EAS2TAS</a>();</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;</div><div class="line"><a name="l00512"></a><span class="lineno"><a class="line" href="classAP__AHRS.html#a2b86eabfd597341fcc87928c36d0470f">  512</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__AHRS.html#a2b86eabfd597341fcc87928c36d0470f">AP_AHRS::update_nmea_out</a>()</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">#if !HAL_MINIMIZE_FEATURES &amp;&amp; AP_AHRS_NAVEKF_AVAILABLE</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__AHRS.html#a95844517e2d3f5cc31db1d6b7c0d0982">_nmea_out</a> != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="classAP__AHRS.html#a95844517e2d3f5cc31db1d6b7c0d0982">_nmea_out</a>-&gt;update();</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    }</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;}</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">// singleton instance</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<a class="code" href="classAP__AHRS.html">AP_AHRS</a> *<a class="code" href="classAP__AHRS.html#a2e78db63454dfa1e2ef3baa6f7be7b6c">AP_AHRS::_singleton</a>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceAP.html">AP</a> {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;</div><div class="line"><a name="l00526"></a><span class="lineno"><a class="line" href="namespaceAP.html#a99432cfdb696952c9b7146f155a815aa">  526</a></span>&#160;<a class="code" href="classAP__AHRS.html">AP_AHRS</a> &amp;<a class="code" href="namespaceAP.html#a99432cfdb696952c9b7146f155a815aa">ahrs</a>()</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;{</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">return</span> *<a class="code" href="classAP__AHRS.html#a3db167e808ba6d312c3b746e558008e9">AP_AHRS::get_singleton</a>();</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div><div class="ttc" id="classAP__AHRS__View_html"><div class="ttname"><a href="classAP__AHRS__View.html">AP_AHRS_View</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS__View_8h_source.html#l00025">AP_AHRS_View.h:25</a></div></div>
<div class="ttc" id="classAP__AHRS_html_ac88d8ea5756954941e568cc76670a674"><div class="ttname"><a href="classAP__AHRS.html#ac88d8ea5756954941e568cc76670a674">AP_AHRS::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00421">AP_AHRS.h:421</a></div></div>
<div class="ttc" id="structVector2_html_aa53d6fde95d48878ba8eb99abab80997"><div class="ttname"><a href="structVector2.html#aa53d6fde95d48878ba8eb99abab80997">Vector2::is_nan</a></div><div class="ttdeci">bool is_nan(void) const</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8cpp_source.html#l00071">vector2.cpp:71</a></div></div>
<div class="ttc" id="classMatrix3_html_a3a809878d75c408fb8173b052016b529"><div class="ttname"><a href="classMatrix3.html#a3a809878d75c408fb8173b052016b529">Matrix3::to_euler</a></div><div class="ttdeci">void to_euler(float *roll, float *pitch, float *yaw) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8cpp_source.html#l00049">matrix3.cpp:49</a></div></div>
<div class="ttc" id="vector2_8h_html_a9f3739462b0605dcb64299fa289b6afe"><div class="ttname"><a href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a></div><div class="ttdeci">Vector2&lt; float &gt; Vector2f</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8h_source.html#l00260">vector2.h:260</a></div></div>
<div class="ttc" id="AP__Baro_8h_html"><div class="ttname"><a href="AP__Baro_8h.html">AP_Baro.h</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a384a23e205126cf43e91bec9668b7ed0"><div class="ttname"><a href="classAP__AHRS.html#a384a23e205126cf43e91bec9668b7ed0">AP_AHRS::roll</a></div><div class="ttdeci">float roll</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00220">AP_AHRS.h:220</a></div></div>
<div class="ttc" id="classAP__AHRS_html_acad24c37755823c587a684969b1cbf22"><div class="ttname"><a href="classAP__AHRS.html#acad24c37755823c587a684969b1cbf22">AP_AHRS::_wind_max</a></div><div class="ttdeci">AP_Int8 _wind_max</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00596">AP_AHRS.h:596</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a69b21caefc3aab8edc889cb7a181a756"><div class="ttname"><a href="classAP__AHRS.html#a69b21caefc3aab8edc889cb7a181a756">AP_AHRS::get_velocity_NED</a></div><div class="ttdeci">virtual bool get_velocity_NED(Vector3f &amp;vec) const WARN_IF_UNUSED</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00314">AP_AHRS.h:314</a></div></div>
<div class="ttc" id="classCompass_html_ad7386676db63a3c8da5ecaa977522526"><div class="ttname"><a href="classCompass.html#ad7386676db63a3c8da5ecaa977522526">Compass::set_board_orientation</a></div><div class="ttdeci">void set_board_orientation(enum Rotation orientation, Matrix3f *custom_rotation=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00204">AP_Compass.h:204</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a6f06d92b5a60228c9e14ed04a52d6743"><div class="ttname"><a href="classAP__AHRS.html#a6f06d92b5a60228c9e14ed04a52d6743">AP_AHRS::getAOA</a></div><div class="ttdeci">float getAOA(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00461">AP_AHRS.cpp:461</a></div></div>
<div class="ttc" id="AP__Math_8cpp_html_ac89eb1832d8e4d67fcf1ac07e3c25184"><div class="ttname"><a href="AP__Math_8cpp.html#ac89eb1832d8e4d67fcf1ac07e3c25184">safe_sqrt</a></div><div class="ttdeci">float safe_sqrt(const T v)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8cpp_source.html#l00066">AP_Math.cpp:66</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a4eb96371ee8cf2b4fb9f453aced2ac44"><div class="ttname"><a href="classAP__AHRS.html#a4eb96371ee8cf2b4fb9f453aced2ac44">AP_AHRS::_sin_roll</a></div><div class="ttdeci">float _sin_roll</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00672">AP_AHRS.h:672</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a2aaf9d61606d9973dca3890ca7b91eb2"><div class="ttname"><a href="classAP__AHRS.html#a2aaf9d61606d9973dca3890ca7b91eb2">AP_AHRS::_airspeed</a></div><div class="ttdeci">AP_Airspeed * _airspeed</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00638">AP_AHRS.h:638</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a29132639c26378ac1003c49477d98dd3"><div class="ttname"><a href="classAP__AHRS.html#a29132639c26378ac1003c49477d98dd3">AP_AHRS::_AOA</a></div><div class="ttdeci">float _AOA</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00681">AP_AHRS.h:681</a></div></div>
<div class="ttc" id="AP__HAL_8h_html"><div class="ttname"><a href="AP__HAL_8h.html">AP_HAL.h</a></div></div>
<div class="ttc" id="classAP__InertialSensor_html_a8ca4ae8fdc18ff0d78f8dea93759cc93"><div class="ttname"><a href="classAP__InertialSensor.html#a8ca4ae8fdc18ff0d78f8dea93759cc93">AP_InertialSensor::get_gyro</a></div><div class="ttdeci">const Vector3f &amp; get_gyro(uint8_t i) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor_8h_source.html#l00098">AP_InertialSensor.h:98</a></div></div>
<div class="ttc" id="AP__Common_8h_html_a728f9499baea61e7df3ae70a374f2512"><div class="ttname"><a href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a></div><div class="ttdeci">#define ToRad(x)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Common_8h_source.html#l00063">AP_Common.h:63</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a01436317dbb7f62470f56b66af4e872d"><div class="ttname"><a href="classAP__AHRS.html#a01436317dbb7f62470f56b66af4e872d">AP_AHRS::wind_estimate</a></div><div class="ttdeci">virtual Vector3f wind_estimate(void) const =0</div></div>
<div class="ttc" id="classAP__AHRS_html_a5c987313ac84c5548c4b0c1c387ea933"><div class="ttname"><a href="classAP__AHRS.html#a5c987313ac84c5548c4b0c1c387ea933">AP_AHRS::_board_orientation</a></div><div class="ttdeci">AP_Int8 _board_orientation</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00597">AP_AHRS.h:597</a></div></div>
<div class="ttc" id="structVector2_html_a4e9114e7f5f457d4ab8b4d33e9d253c9"><div class="ttname"><a href="structVector2.html#a4e9114e7f5f457d4ab8b4d33e9d253c9">Vector2::is_inf</a></div><div class="ttdeci">bool is_inf(void) const</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8cpp_source.html#l00077">vector2.cpp:77</a></div></div>
<div class="ttc" id="classAP__Airspeed_html_a02885c320f3cedbc08c02bc8894aba04"><div class="ttname"><a href="classAP__Airspeed.html#a02885c320f3cedbc08c02bc8894aba04">AP_Airspeed::get_airspeed</a></div><div class="ttdeci">float get_airspeed(uint8_t i) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Airspeed_8h_source.html#l00053">AP_Airspeed.h:53</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a78a408c84f2a1bafde256ac650142e4d"><div class="ttname"><a href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, clazz, element, def)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00100">AP_Param.h:100</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a1c0edc87d7376462e827a694613df3b4"><div class="ttname"><a href="classAP__AHRS.html#a1c0edc87d7376462e827a694613df3b4">AP_AHRS::get_origin</a></div><div class="ttdeci">virtual bool get_origin(Location &amp;ret) const WARN_IF_UNUSED</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00469">AP_AHRS.h:469</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a2aa61744614d8e0ef64803583359a56e"><div class="ttname"><a href="classAP__AHRS.html#a2aa61744614d8e0ef64803583359a56e">AP_AHRS::pitch</a></div><div class="ttdeci">float pitch</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00221">AP_AHRS.h:221</a></div></div>
<div class="ttc" id="AP__Logger_8h_html"><div class="ttname"><a href="AP__Logger_8h.html">AP_Logger.h</a></div></div>
<div class="ttc" id="classMatrix3_html"><div class="ttname"><a href="classMatrix3.html">Matrix3&lt; float &gt;</a></div></div>
<div class="ttc" id="classMatrix3_html_a62587bd216436f09f06b9e1330f84bc0"><div class="ttname"><a href="classMatrix3.html#a62587bd216436f09f06b9e1330f84bc0">Matrix3::from_euler</a></div><div class="ttdeci">void from_euler(float roll, float pitch, float yaw)</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8cpp_source.html#l00026">matrix3.cpp:26</a></div></div>
<div class="ttc" id="classAP__AHRS_html"><div class="ttname"><a href="classAP__AHRS.html">AP_AHRS</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00050">AP_AHRS.h:50</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a8a371073599619698a9bad679a55b6d7"><div class="ttname"><a href="classAP__AHRS.html#a8a371073599619698a9bad679a55b6d7">AP_AHRS::_lastGndVelADS</a></div><div class="ttdeci">Vector2f _lastGndVelADS</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00663">AP_AHRS.h:663</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a63359ca9325c63642050bcf1c3e1cd63"><div class="ttname"><a href="classAP__AHRS.html#a63359ca9325c63642050bcf1c3e1cd63">AP_AHRS::yaw</a></div><div class="ttdeci">float yaw</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00222">AP_AHRS.h:222</a></div></div>
<div class="ttc" id="classAP__AHRS_html_ac9514f5193b6a15b16d995fd8ee0e4c4"><div class="ttname"><a href="classAP__AHRS.html#ac9514f5193b6a15b16d995fd8ee0e4c4">AP_AHRS::Log_Write_Home_And_Origin</a></div><div class="ttdeci">void Log_Write_Home_And_Origin()</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00489">AP_AHRS.cpp:489</a></div></div>
<div class="ttc" id="classAP__AHRS_html_aa2fd48ce0265df723cc8d05bb2150749"><div class="ttname"><a href="classAP__AHRS.html#aa2fd48ce0265df723cc8d05bb2150749">AP_AHRS::groundspeed_vector</a></div><div class="ttdeci">virtual Vector2f groundspeed_vector(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00248">AP_AHRS.cpp:248</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a7328e4bc4caf3cb87a16915edcde932e"><div class="ttname"><a href="classAP__AHRS.html#a7328e4bc4caf3cb87a16915edcde932e">AP_AHRS::update_AOA_SSA</a></div><div class="ttdeci">virtual void update_AOA_SSA(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00414">AP_AHRS.cpp:414</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a8a1988bb283c488c86b329be18271fbf"><div class="ttname"><a href="classAP__AHRS.html#a8a1988bb283c488c86b329be18271fbf">AP_AHRS::get_rotation_body_to_ned</a></div><div class="ttdeci">virtual const Matrix3f &amp; get_rotation_body_to_ned(void) const =0</div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681">Rotation</a></div><div class="ttdeci">Rotation</div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00027">rotations.h:27</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a3db167e808ba6d312c3b746e558008e9"><div class="ttname"><a href="classAP__AHRS.html#a3db167e808ba6d312c3b746e558008e9">AP_AHRS::get_singleton</a></div><div class="ttdeci">static AP_AHRS * get_singleton()</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00083">AP_AHRS.h:83</a></div></div>
<div class="ttc" id="classAP__Baro_html_a0115c37618652051c1f6efd072fcc74b"><div class="ttname"><a href="classAP__Baro.html#a0115c37618652051c1f6efd072fcc74b">AP_Baro::get_EAS2TAS</a></div><div class="ttdeci">float get_EAS2TAS(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Baro_8cpp_source.html#l00316">AP_Baro.cpp:316</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a81be6f5e1f8b4b753cc5131532802bc2"><div class="ttname"><a href="classAP__AHRS.html#a81be6f5e1f8b4b753cc5131532802bc2">AP_AHRS::rotate_earth_to_body2D</a></div><div class="ttdeci">Vector2f rotate_earth_to_body2D(const Vector2f &amp;ef_vector) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00475">AP_AHRS.cpp:475</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a783631a678ef9034b1357c9aa93e1280"><div class="ttname"><a href="classAP__AHRS.html#a783631a678ef9034b1357c9aa93e1280">AP_AHRS::add_trim</a></div><div class="ttdeci">void add_trim(float roll_in_radians, float pitch_in_radians, bool save_to_eeprom=true)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00212">AP_AHRS.cpp:212</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a2b86eabfd597341fcc87928c36d0470f"><div class="ttname"><a href="classAP__AHRS.html#a2b86eabfd597341fcc87928c36d0470f">AP_AHRS::update_nmea_out</a></div><div class="ttdeci">void update_nmea_out()</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00512">AP_AHRS.cpp:512</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a0c6e82280b005a339b04028b1f5ea70d"><div class="ttname"><a href="classAP__AHRS.html#a0c6e82280b005a339b04028b1f5ea70d">AP_AHRS::roll_sensor</a></div><div class="ttdeci">int32_t roll_sensor</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00225">AP_AHRS.h:225</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a641b4bea4de708dbfa1d01039bfde2e8"><div class="ttname"><a href="classAP__AHRS.html#a641b4bea4de708dbfa1d01039bfde2e8">AP_AHRS::_rotation_vehicle_body_to_autopilot_body</a></div><div class="ttdeci">Matrix3f _rotation_vehicle_body_to_autopilot_body</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00649">AP_AHRS.h:649</a></div></div>
<div class="ttc" id="classAP__AHRS_html_adedc7b6972ea5295658549c3a4d357cf"><div class="ttname"><a href="classAP__AHRS.html#adedc7b6972ea5295658549c3a4d357cf">AP_AHRS::_lp</a></div><div class="ttdeci">Vector2f _lp</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00661">AP_AHRS.h:661</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a7284d5e65c5863f5678b4d93000b116e"><div class="ttname"><a href="classAP__AHRS.html#a7284d5e65c5863f5678b4d93000b116e">AP_AHRS::update_orientation</a></div><div class="ttdeci">void update_orientation()</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00230">AP_AHRS.cpp:230</a></div></div>
<div class="ttc" id="classMatrix3_html_aa964ba5be20b0fb821685cc065156f56"><div class="ttname"><a href="classMatrix3.html#aa964ba5be20b0fb821685cc065156f56">Matrix3::transposed</a></div><div class="ttdeci">Matrix3&lt; T &gt; transposed(void) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8cpp_source.html#l00182">matrix3.cpp:182</a></div></div>
<div class="ttc" id="structVector2_html_a6cfed8355591aa269f4dba43bd806ef9"><div class="ttname"><a href="structVector2.html#a6cfed8355591aa269f4dba43bd806ef9">Vector2::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8h_source.html#l00037">vector2.h:37</a></div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681a621932380092e03bd929b22f6a1945ed"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a621932380092e03bd929b22f6a1945ed">ROTATION_CUSTOM</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00077">rotations.h:77</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a2b1eae408a12feccfe34308ef0608e21"><div class="ttname"><a href="classAP__AHRS.html#a2b1eae408a12feccfe34308ef0608e21">AP_AHRS::_last_trim</a></div><div class="ttdeci">Vector3f _last_trim</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00647">AP_AHRS.h:647</a></div></div>
<div class="ttc" id="classAP__AHRS_html_ad90dcc92a4e33a426f2cce84571e91d3"><div class="ttname"><a href="classAP__AHRS.html#ad90dcc92a4e33a426f2cce84571e91d3">AP_AHRS::_custom_rotation</a></div><div class="ttdeci">Matrix3f _custom_rotation</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00605">AP_AHRS.h:605</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a871b43cfe1eb9237ed763d83d4d3cbe2"><div class="ttname"><a href="classAP__AHRS.html#a871b43cfe1eb9237ed763d83d4d3cbe2">AP_AHRS::_hp</a></div><div class="ttdeci">Vector2f _hp</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00662">AP_AHRS.h:662</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00021">HAL.h:21</a></div></div>
<div class="ttc" id="namespaceAP_html"><div class="ttname"><a href="namespaceAP.html">AP</a></div><div class="ttdef"><b>Definition:</b> <a href="AC__Avoid_8cpp_source.html#l00655">AC_Avoid.cpp:655</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a99bd2d830e0c1c57c6e4aba4b53d967d"><div class="ttname"><a href="classAP__AHRS.html#a99bd2d830e0c1c57c6e4aba4b53d967d">AP_AHRS::_sin_pitch</a></div><div class="ttdeci">float _sin_pitch</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00672">AP_AHRS.h:672</a></div></div>
<div class="ttc" id="classAP__GPS_html_ae7f097588dd863d4624f6fec1509e0e6"><div class="ttname"><a href="classAP__GPS.html#ae7f097588dd863d4624f6fec1509e0e6">AP_GPS::ground_speed</a></div><div class="ttdeci">float ground_speed(uint8_t instance) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__GPS_8h_source.html#l00231">AP_GPS.h:231</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a1b78799772ad2c3adfd4ea2b422a704d"><div class="ttname"><a href="classAP__AHRS.html#a1b78799772ad2c3adfd4ea2b422a704d">AP_AHRS::_sin_yaw</a></div><div class="ttdeci">float _sin_yaw</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00672">AP_AHRS.h:672</a></div></div>
<div class="ttc" id="classAP__AHRS_html_af3394de208d1f96457382d79ab7a8d01"><div class="ttname"><a href="classAP__AHRS.html#af3394de208d1f96457382d79ab7a8d01">AP_AHRS::pitch_sensor</a></div><div class="ttdeci">int32_t pitch_sensor</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00226">AP_AHRS.h:226</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a8bf3f8d2410b5456bc43b937c872e6bb"><div class="ttname"><a href="classAP__AHRS.html#a8bf3f8d2410b5456bc43b937c872e6bb">AP_AHRS::update_cd_values</a></div><div class="ttdeci">void update_cd_values(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00379">AP_AHRS.cpp:379</a></div></div>
<div class="ttc" id="AP__Math_8h_html_a2a12cce483e9b870da70d30406d82c60"><div class="ttname"><a href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a></div><div class="ttdeci">bool is_zero(const T fVal1)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00040">AP_Math.h:40</a></div></div>
<div class="ttc" id="DerivativeFilter_8cpp_html_a357394e0f6f88c8a57bd893ab28dc8f8"><div class="ttname"><a href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a></div><div class="ttdeci">#define f(i)</div></div>
<div class="ttc" id="classAP__AHRS_html_a6b7ca065135dc4f0c06879b6a5bca2db"><div class="ttname"><a href="classAP__AHRS.html#a6b7ca065135dc4f0c06879b6a5bca2db">AP_AHRS::getSSA</a></div><div class="ttdeci">float getSSA(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00468">AP_AHRS.cpp:468</a></div></div>
<div class="ttc" id="structVector2_html"><div class="ttname"><a href="structVector2.html">Vector2&lt; float &gt;</a></div></div>
<div class="ttc" id="classVector3_html_a561df88b28e106e337a25bb86554a569"><div class="ttname"><a href="classVector3.html#a561df88b28e106e337a25bb86554a569">Vector3::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00067">vector3.h:67</a></div></div>
<div class="ttc" id="classAP__AHRS_html_ab5d0d060c6bf6239e469dc0cbd5fa75c"><div class="ttname"><a href="classAP__AHRS.html#ab5d0d060c6bf6239e469dc0cbd5fa75c">AP_AHRS::AP_AHRS_View</a></div><div class="ttdeci">friend class AP_AHRS_View</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00053">AP_AHRS.h:53</a></div></div>
<div class="ttc" id="classMatrix3_html_a7efa0e7bd4c621a7fe76cd9168960b94"><div class="ttname"><a href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">Matrix3::c</a></div><div class="ttdeci">Vector3&lt; T &gt; c</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8h_source.html#l00049">matrix3.h:49</a></div></div>
<div class="ttc" id="namespaceAP__HAL_html_a77dffbb18891996280308e21316ec186"><div class="ttname"><a href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a></div><div class="ttdeci">uint32_t millis()</div><div class="ttdef"><b>Definition:</b> <a href="ChibiOS_2system_8cpp_source.html#l00157">system.cpp:157</a></div></div>
<div class="ttc" id="classAP__InertialSensor_html_a101cb0b8b188ced0f16db50a5e45fb7b"><div class="ttname"><a href="classAP__InertialSensor.html#a101cb0b8b188ced0f16db50a5e45fb7b">AP_InertialSensor::set_board_orientation</a></div><div class="ttdeci">void set_board_orientation(enum Rotation orientation, Matrix3f *custom_rotation=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor_8h_source.html#l00189">AP_InertialSensor.h:189</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a5286f1508ed0f81d4a81086c9bc88d7e"><div class="ttname"><a href="classAP__AHRS.html#a5286f1508ed0f81d4a81086c9bc88d7e">AP_AHRS::_rotation_autopilot_body_to_vehicle_body</a></div><div class="ttdeci">Matrix3f _rotation_autopilot_body_to_vehicle_body</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00648">AP_AHRS.h:648</a></div></div>
<div class="ttc" id="classAP__Logger_html_ac62c839cf8b76931790297cec22305da"><div class="ttname"><a href="classAP__Logger.html#ac62c839cf8b76931790297cec22305da">AP_Logger::Write_Origin</a></div><div class="ttdeci">void Write_Origin(uint8_t origin_type, const Location &amp;loc)</div><div class="ttdef"><b>Definition:</b> <a href="LogFile_8cpp_source.html#l00792">LogFile.cpp:792</a></div></div>
<div class="ttc" id="classAP__Logger_html"><div class="ttname"><a href="classAP__Logger.html">AP_Logger</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Logger_8h_source.html#l00169">AP_Logger.h:169</a></div></div>
<div class="ttc" id="classAP__AHRS_html_af4b0173305e02652ff9362c8718d9033"><div class="ttname"><a href="classAP__AHRS.html#af4b0173305e02652ff9362c8718d9033">AP_AHRS::rotate_body_to_earth2D</a></div><div class="ttdeci">Vector2f rotate_body_to_earth2D(const Vector2f &amp;bf) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00482">AP_AHRS.cpp:482</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a6a87cc57a950be81a068cc2cf270447a"><div class="ttname"><a href="classAP__AHRS.html#a6a87cc57a950be81a068cc2cf270447a">AP_AHRS::get_gyro_latest</a></div><div class="ttdeci">Vector3f get_gyro_latest(void) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00176">AP_AHRS.cpp:176</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a81276058507961059a7793e8cce07a4b"><div class="ttname"><a href="classAP__AHRS.html#a81276058507961059a7793e8cce07a4b">AP_AHRS::_custom_roll</a></div><div class="ttdeci">AP_Float _custom_roll</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00601">AP_AHRS.h:601</a></div></div>
<div class="ttc" id="classVector3_html_ab3e7f5401dd6e951978bfa746809f74f"><div class="ttname"><a href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">Vector3::z</a></div><div class="ttdeci">T z</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00067">vector3.h:67</a></div></div>
<div class="ttc" id="structAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00142">AP_Param.h:142</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a6876435645c1049077f33f225ab828f7"><div class="ttname"><a href="classAP__AHRS.html#a6876435645c1049077f33f225ab828f7">AP_AHRS::get_gyro_drift</a></div><div class="ttdeci">virtual const Vector3f &amp; get_gyro_drift(void) const =0</div></div>
<div class="ttc" id="classAP__AHRS_html_a354defc08c7357268a3a3337bb4d4d37"><div class="ttname"><a href="classAP__AHRS.html#a354defc08c7357268a3a3337bb4d4d37">AP_AHRS::_custom_yaw</a></div><div class="ttdeci">AP_Float _custom_yaw</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00603">AP_AHRS.h:603</a></div></div>
<div class="ttc" id="AP__AHRS_8cpp_html_ae08c3ca4ba26b63cda0bb3e3c6c02785"><div class="ttname"><a href="AP__AHRS_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdef"><b>Definition:</b> <a href="AC__PID__test_8cpp_source.html#l00021">AC_PID_test.cpp:21</a></div></div>
<div class="ttc" id="classAP__GPS_html_a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff"><div class="ttname"><a href="classAP__GPS.html#a7409121ce557236dce2fd541309af5fca039c0783250f3296425dfc7b53bbdbff">AP_GPS::GPS_OK_FIX_2D</a></div><div class="ttdoc">Receiving valid messages and 2D lock.</div><div class="ttdef"><b>Definition:</b> <a href="AP__GPS_8h_source.html#l00094">AP_GPS.h:94</a></div></div>
<div class="ttc" id="classAP__GPS_html_ac22b61d2e6cf0b6ff647173ea336de01"><div class="ttname"><a href="classAP__GPS.html#ac22b61d2e6cf0b6ff647173ea336de01">AP_GPS::status</a></div><div class="ttdeci">GPS_Status status(uint8_t instance) const</div><div class="ttdoc">Query GPS status.</div><div class="ttdef"><b>Definition:</b> <a href="AP__GPS_8h_source.html#l00185">AP_GPS.h:185</a></div></div>
<div class="ttc" id="AP__GPS_8h_html"><div class="ttname"><a href="AP__GPS_8h.html">AP_GPS.h</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a80d5ae913ca88ab8fbdcca779221c8cc"><div class="ttname"><a href="classAP__AHRS.html#a80d5ae913ca88ab8fbdcca779221c8cc">AP_AHRS::beta</a></div><div class="ttdeci">AP_Float beta</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00594">AP_AHRS.h:594</a></div></div>
<div class="ttc" id="classAP__AHRS_html_ab45359e5c71751e421577e6a2d85625e"><div class="ttname"><a href="classAP__AHRS.html#ab45359e5c71751e421577e6a2d85625e">AP_AHRS::set_trim</a></div><div class="ttdeci">void set_trim(const Vector3f &amp;new_trim)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00203">AP_AHRS.cpp:203</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a95844517e2d3f5cc31db1d6b7c0d0982"><div class="ttname"><a href="classAP__AHRS.html#a95844517e2d3f5cc31db1d6b7c0d0982">AP_AHRS::_nmea_out</a></div><div class="ttdeci">AP_NMEA_Output * _nmea_out</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00687">AP_AHRS.h:687</a></div></div>
<div class="ttc" id="AP__Math_8cpp_html_a3370ada2588e54722319d65e00d8545c"><div class="ttname"><a href="AP__Math_8cpp.html#a3370ada2588e54722319d65e00d8545c">safe_asin</a></div><div class="ttdeci">float safe_asin(const T v)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8cpp_source.html#l00045">AP_Math.cpp:45</a></div></div>
<div class="ttc" id="AP__AHRS_8h_html"><div class="ttname"><a href="AP__AHRS_8h.html">AP_AHRS.h</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a015bc176be954e9814ff3bdc4c2733af"><div class="ttname"><a href="classAP__AHRS.html#a015bc176be954e9814ff3bdc4c2733af">AP_AHRS::_home</a></div><div class="ttdeci">struct Location _home</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00666">AP_AHRS.h:666</a></div></div>
<div class="ttc" id="classVector3_html_afcdfe81173c23d57e4a53a0282cddae7"><div class="ttname"><a href="classVector3.html#afcdfe81173c23d57e4a53a0282cddae7">Vector3::length</a></div><div class="ttdeci">float length(void) const</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8cpp_source.html#l00297">vector3.cpp:297</a></div></div>
<div class="ttc" id="LogStructure_8h_html_ab36c838093e3699b68977ecfff272bc8a5f73dc8b4696c3114bbc7015b24103fd"><div class="ttname"><a href="LogStructure_8h.html#ab36c838093e3699b68977ecfff272bc8a5f73dc8b4696c3114bbc7015b24103fd">ekf_origin</a></div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01706">LogStructure.h:1706</a></div></div>
<div class="ttc" id="classMatrix3_html_a212a94e2a9c26def827fa766f4d0ae3e"><div class="ttname"><a href="classMatrix3.html#a212a94e2a9c26def827fa766f4d0ae3e">Matrix3::mul_transpose</a></div><div class="ttdeci">Vector3&lt; T &gt; mul_transpose(const Vector3&lt; T &gt; &amp;v) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8cpp_source.html#l00158">matrix3.cpp:158</a></div></div>
<div class="ttc" id="classAP__Logger_html_a7dfeda4dc3df2edc8531110c9d7252dc"><div class="ttname"><a href="classAP__Logger.html#a7dfeda4dc3df2edc8531110c9d7252dc">AP_Logger::get_singleton</a></div><div class="ttdeci">static AP_Logger * get_singleton(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Logger_8h_source.html#l00183">AP_Logger.h:183</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a1bffad8e44fe1764ac5833ad649205b5"><div class="ttname"><a href="classAP__AHRS.html#a1bffad8e44fe1764ac5833ad649205b5">AP_AHRS::_custom_pitch</a></div><div class="ttdeci">AP_Float _custom_pitch</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00602">AP_AHRS.h:602</a></div></div>
<div class="ttc" id="Airspeed_8cpp_html_abfed87a61c42e885ee14d5222b47583f"><div class="ttname"><a href="Airspeed_8cpp.html#abfed87a61c42e885ee14d5222b47583f">airspeed</a></div><div class="ttdeci">AP_Airspeed airspeed</div><div class="ttdef"><b>Definition:</b> <a href="Airspeed_8cpp_source.html#l00034">Airspeed.cpp:34</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a0bd52134b07d344dfef3dc94c72e9dff"><div class="ttname"><a href="classAP__AHRS.html#a0bd52134b07d344dfef3dc94c72e9dff">AP_AHRS::_cos_roll</a></div><div class="ttdeci">float _cos_roll</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00671">AP_AHRS.h:671</a></div></div>
<div class="ttc" id="AP__AHRS__View_8h_html"><div class="ttname"><a href="AP__AHRS__View_8h.html">AP_AHRS_View.h</a></div></div>
<div class="ttc" id="AP__Math_8h_html_ad525609d9dba6ffa556a0fbf08a3f9b4"><div class="ttname"><a href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a></div><div class="ttdeci">float constrain_float(const float amt, const float low, const float high)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00142">AP_Math.h:142</a></div></div>
<div class="ttc" id="structVector2_html_a78fa1f2ed5e261c7fbeb8f3536a1ee34"><div class="ttname"><a href="structVector2.html#a78fa1f2ed5e261c7fbeb8f3536a1ee34">Vector2::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8h_source.html#l00037">vector2.h:37</a></div></div>
<div class="ttc" id="namespaceAP_html_a99432cfdb696952c9b7146f155a815aa"><div class="ttname"><a href="namespaceAP.html#a99432cfdb696952c9b7146f155a815aa">AP::ahrs</a></div><div class="ttdeci">AP_AHRS &amp; ahrs()</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00526">AP_AHRS.cpp:526</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a29755586a9138e9562961044340b1f0a"><div class="ttname"><a href="classAP__AHRS.html#a29755586a9138e9562961044340b1f0a">AP_AHRS::airspeed_estimate_true</a></div><div class="ttdeci">bool airspeed_estimate_true(float *airspeed_ret) const WARN_IF_UNUSED</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00286">AP_AHRS.h:286</a></div></div>
<div class="ttc" id="AP__AHRS_8h_html_abb6a68205ef997ce848fafe7f22beb87"><div class="ttname"><a href="AP__AHRS_8h.html#abb6a68205ef997ce848fafe7f22beb87">AP_AHRS_TRIM_LIMIT</a></div><div class="ttdeci">#define AP_AHRS_TRIM_LIMIT</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00034">AP_AHRS.h:34</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a61a8beb36c6b10a6ece0d06f76d4bd2d"><div class="ttname"><a href="classAP__AHRS.html#a61a8beb36c6b10a6ece0d06f76d4bd2d">AP_AHRS::init</a></div><div class="ttdeci">virtual void init()</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00166">AP_AHRS.cpp:166</a></div></div>
<div class="ttc" id="classAP__AHRS_html_ad3ac110b7f3e2e6c8eaca68fad92090e"><div class="ttname"><a href="classAP__AHRS.html#ad3ac110b7f3e2e6c8eaca68fad92090e">AP_AHRS::_view</a></div><div class="ttdeci">AP_AHRS_View * _view</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00678">AP_AHRS.h:678</a></div></div>
<div class="ttc" id="AP__Math_8h_html_a37d7c62a8231d9d22826261297b99da4"><div class="ttname"><a href="AP__Math_8h.html#a37d7c62a8231d9d22826261297b99da4">radians</a></div><div class="ttdeci">static constexpr float radians(float deg)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00163">AP_Math.h:163</a></div></div>
<div class="ttc" id="structVector2_html_ace2a626eaa79412e2946216e9c3e63c6"><div class="ttname"><a href="structVector2.html#ace2a626eaa79412e2946216e9c3e63c6">Vector2::normalize</a></div><div class="ttdeci">void normalize()</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8cpp_source.html#l00253">vector2.cpp:253</a></div></div>
<div class="ttc" id="LogStructure_8h_html_ab36c838093e3699b68977ecfff272bc8a79a3f059d8a988f397e881e1045e8e39"><div class="ttname"><a href="LogStructure_8h.html#ab36c838093e3699b68977ecfff272bc8a79a3f059d8a988f397e881e1045e8e39">ahrs_home</a></div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01707">LogStructure.h:1707</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a21b884a673a423f46958f216a5ce6a86"><div class="ttname"><a href="classAP__AHRS.html#a21b884a673a423f46958f216a5ce6a86">AP_AHRS::_compass</a></div><div class="ttdeci">Compass * _compass</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00632">AP_AHRS.h:632</a></div></div>
<div class="ttc" id="classVector3_html"><div class="ttname"><a href="classVector3.html">Vector3&lt; float &gt;</a></div></div>
<div class="ttc" id="classAP__AHRS_html_ad317e5df250980cadcb8cea9f074ed1e"><div class="ttname"><a href="classAP__AHRS.html#ad317e5df250980cadcb8cea9f074ed1e">AP_AHRS::get_primary_gyro_index</a></div><div class="ttdeci">virtual uint8_t get_primary_gyro_index(void) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00178">AP_AHRS.h:178</a></div></div>
<div class="ttc" id="namespaceAP_html_ac571aa5a2ef71b7f4b4b2bfa09143fb9"><div class="ttname"><a href="namespaceAP.html#ac571aa5a2ef71b7f4b4b2bfa09143fb9">AP::ins</a></div><div class="ttdeci">AP_InertialSensor &amp; ins()</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor_8cpp_source.html#l02076">AP_InertialSensor.cpp:2076</a></div></div>
<div class="ttc" id="namespaceAP_html_ae6eeec356455220f913e47e323057cd5"><div class="ttname"><a href="namespaceAP.html#ae6eeec356455220f913e47e323057cd5">AP::gps</a></div><div class="ttdeci">AP_GPS &amp; gps()</div><div class="ttdef"><b>Definition:</b> <a href="AP__GPS_8cpp_source.html#l01574">AP_GPS.cpp:1574</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a0ec7142b7338d3049f67ef4f042e288e"><div class="ttname"><a href="classAP__AHRS.html#a0ec7142b7338d3049f67ef4f042e288e">AP_AHRS::_SSA</a></div><div class="ttdeci">float _SSA</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00681">AP_AHRS.h:681</a></div></div>
<div class="ttc" id="classMatrix3_html_ae16bed039ad87c3337f15837c33fe2fb"><div class="ttname"><a href="classMatrix3.html#ae16bed039ad87c3337f15837c33fe2fb">Matrix3::b</a></div><div class="ttdeci">Vector3&lt; T &gt; b</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8h_source.html#l00049">matrix3.h:49</a></div></div>
<div class="ttc" id="classAP__AHRS_html_af55335ae1d37aff06bc6ad997b9f5ab0"><div class="ttname"><a href="classAP__AHRS.html#af55335ae1d37aff06bc6ad997b9f5ab0">AP_AHRS::calc_trig</a></div><div class="ttdeci">void calc_trig(const Matrix3f &amp;rot, float &amp;cr, float &amp;cp, float &amp;cy, float &amp;sr, float &amp;sp, float &amp;sy) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00317">AP_AHRS.cpp:317</a></div></div>
<div class="ttc" id="classAP__AHRS_html_aba88eab2ab7bb6f525934fb06d30e780"><div class="ttname"><a href="classAP__AHRS.html#aba88eab2ab7bb6f525934fb06d30e780">AP_AHRS::airspeed_estimate</a></div><div class="ttdeci">virtual bool airspeed_estimate(float *airspeed_ret) const WARN_IF_UNUSED</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00183">AP_AHRS.cpp:183</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a47ea335b3b317f0c5e54320f59d5ca8a"><div class="ttname"><a href="classAP__AHRS.html#a47ea335b3b317f0c5e54320f59d5ca8a">AP_AHRS::airspeed_sensor_enabled</a></div><div class="ttdeci">bool airspeed_sensor_enabled(void) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00299">AP_AHRS.h:299</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a64786b58a1607ee420ed4f0696c755b6"><div class="ttname"><a href="classAP__AHRS.html#a64786b58a1607ee420ed4f0696c755b6">AP_AHRS::get_EAS2TAS</a></div><div class="ttdeci">float get_EAS2TAS(void) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00508">AP_AHRS.cpp:508</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a34c0a28db3bc87426f69e34e5949bd8b"><div class="ttname"><a href="classAP__AHRS.html#a34c0a28db3bc87426f69e34e5949bd8b">AP_AHRS::update_trig</a></div><div class="ttdeci">void update_trig(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00363">AP_AHRS.cpp:363</a></div></div>
<div class="ttc" id="moduletest_8c_html_a903c4797a4c2860e3b9a6a978f98a44d"><div class="ttname"><a href="moduletest_8c.html#a903c4797a4c2860e3b9a6a978f98a44d">degrees</a></div><div class="ttdeci">#define degrees(x)</div><div class="ttdef"><b>Definition:</b> <a href="moduletest_8c_source.html#l00023">moduletest.c:23</a></div></div>
<div class="ttc" id="namespaceAP_html_a8aec57eb0b7a79044cbc1f0ca4b75bcf"><div class="ttname"><a href="namespaceAP.html#a8aec57eb0b7a79044cbc1f0ca4b75bcf">AP::baro</a></div><div class="ttdeci">AP_Baro &amp; baro()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Baro_8cpp_source.html#l00860">AP_Baro.cpp:860</a></div></div>
<div class="ttc" id="classLocation_html"><div class="ttname"><a href="classLocation.html">Location</a></div><div class="ttdef"><b>Definition:</b> <a href="Location_8h_source.html#l00009">Location.h:9</a></div></div>
<div class="ttc" id="classAP__AHRS_html_aa6a48349ade83ef20981f85bf5364cb5"><div class="ttname"><a href="classAP__AHRS.html#aa6a48349ade83ef20981f85bf5364cb5">AP_AHRS::_trim</a></div><div class="ttdeci">AP_Vector3f _trim</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00644">AP_AHRS.h:644</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a4ffe6b0b13f7f4106740105101fed115"><div class="ttname"><a href="classAP__AHRS.html#a4ffe6b0b13f7f4106740105101fed115">AP_AHRS::home_is_set</a></div><div class="ttdeci">bool home_is_set(void) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00454">AP_AHRS.h:454</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a8a160130dd99016a19abab9d85917261"><div class="ttname"><a href="classAP__AHRS.html#a8a160130dd99016a19abab9d85917261">AP_AHRS::yaw_sensor</a></div><div class="ttdeci">int32_t yaw_sensor</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00227">AP_AHRS.h:227</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a31317890a8768d2896b339e23147bada"><div class="ttname"><a href="classAP__AHRS.html#a31317890a8768d2896b339e23147bada">AP_AHRS::_cos_yaw</a></div><div class="ttdeci">float _cos_yaw</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00671">AP_AHRS.h:671</a></div></div>
<div class="ttc" id="classMatrix3_html_acd7bf3421047fa155168a9c8e5164a2b"><div class="ttname"><a href="classMatrix3.html#acd7bf3421047fa155168a9c8e5164a2b">Matrix3::a</a></div><div class="ttdeci">Vector3&lt; T &gt; a</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8h_source.html#l00049">matrix3.h:49</a></div></div>
<div class="ttc" id="AHRS__Test_8cpp_html_a9fede12aaeb5750bcb131cae0430647c"><div class="ttname"><a href="AHRS__Test_8cpp.html#a9fede12aaeb5750bcb131cae0430647c">logger</a></div><div class="ttdeci">static AP_Logger logger</div><div class="ttdef"><b>Definition:</b> <a href="AHRS__Test_8cpp_source.html#l00029">AHRS_Test.cpp:29</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a7d767db49bc14c505049e93ab11e793c"><div class="ttname"><a href="classAP__AHRS.html#a7d767db49bc14c505049e93ab11e793c">AP_AHRS::_cos_pitch</a></div><div class="ttdeci">float _cos_pitch</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00671">AP_AHRS.h:671</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a2e78db63454dfa1e2ef3baa6f7be7b6c"><div class="ttname"><a href="classAP__AHRS.html#a2e78db63454dfa1e2ef3baa6f7be7b6c">AP_AHRS::_singleton</a></div><div class="ttdeci">static AP_AHRS * _singleton</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00685">AP_AHRS.h:685</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00118">AP_Param.h:118</a></div></div>
<div class="ttc" id="classAP__AHRS_html_aed32713548839b922b9bc27379074ddb"><div class="ttname"><a href="classAP__AHRS.html#aed32713548839b922b9bc27379074ddb">AP_AHRS::create_view</a></div><div class="ttdeci">AP_AHRS_View * create_view(enum Rotation rotation, float pitch_trim_deg=0)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00391">AP_AHRS.cpp:391</a></div></div>
<div class="ttc" id="classVector3_html_a1a0f7e168c71ca798099f0ba8a444244"><div class="ttname"><a href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">Vector3::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00067">vector3.h:67</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a759ae3406c3e0c9c5a5464dcbd1e074d"><div class="ttname"><a href="classAP__AHRS.html#a759ae3406c3e0c9c5a5464dcbd1e074d">AP_AHRS::_last_AOA_update_ms</a></div><div class="ttdeci">uint32_t _last_AOA_update_ms</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00682">AP_AHRS.h:682</a></div></div>
<div class="ttc" id="AP__NMEA__Output_8h_html"><div class="ttname"><a href="AP__NMEA__Output_8h.html">AP_NMEA_Output.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 11 2019 14:17:25 for APM:Libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
