<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>APM:Libraries: libraries/AP_Compass/AP_Compass.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_65717d02e6482fd400ba81c154f53df4.html">AP_Compass</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AP_Compass.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AP__Compass_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__HAL_8h.html">AP_HAL/AP_HAL.h</a>&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#if CONFIG_HAL_BOARD == HAL_BOARD_LINUX</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Linux_2I2CDevice_8h.html">AP_HAL_Linux/I2CDevice.h</a>&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__Vehicle_8h.html">AP_Vehicle/AP_Vehicle.h</a>&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__BoardConfig_8h.html">AP_BoardConfig/AP_BoardConfig.h</a>&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__Logger_8h.html">AP_Logger/AP_Logger.h</a>&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__SITL_8h.html">AP_Compass_SITL.h</a>&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__AK8963_8h.html">AP_Compass_AK8963.h</a>&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__Backend_8h.html">AP_Compass_Backend.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__BMM150_8h.html">AP_Compass_BMM150.h</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__HIL_8h.html">AP_Compass_HIL.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__HMC5843_8h.html">AP_Compass_HMC5843.h</a>&quot;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__IST8308_8h.html">AP_Compass_IST8308.h</a>&quot;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__IST8310_8h.html">AP_Compass_IST8310.h</a>&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__LSM303D_8h.html">AP_Compass_LSM303D.h</a>&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__LSM9DS1_8h.html">AP_Compass_LSM9DS1.h</a>&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__LIS3MDL_8h.html">AP_Compass_LIS3MDL.h</a>&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__AK09916_8h.html">AP_Compass_AK09916.h</a>&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__QMC5883L_8h.html">AP_Compass_QMC5883L.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#if HAL_WITH_UAVCAN</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__UAVCAN_8h.html">AP_Compass_UAVCAN.h</a>&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__MMC3416_8h.html">AP_Compass_MMC3416.h</a>&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__MAG3110_8h.html">AP_Compass_MAG3110.h</a>&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass__RM3100_8h.html">AP_Compass_RM3100.h</a>&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Compass_8h.html">AP_Compass.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Compass__learn_8h.html">Compass_learn.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">extern</span> <a class="code" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#if APM_BUILD_TYPE(APM_BUILD_ArduCopter) || APM_BUILD_TYPE(APM_BUILD_ArduSub)</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#define COMPASS_LEARN_DEFAULT Compass::LEARN_NONE</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="AP__Compass_8cpp.html#abbd00be969534e4587e3479da3759384">   36</a></span>&#160;<span class="preprocessor">#define COMPASS_LEARN_DEFAULT Compass::LEARN_INTERNAL</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#ifndef AP_COMPASS_OFFSETS_MAX_DEFAULT</span></div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="AP__Compass_8cpp.html#a6db3df6d28073ae8f6bb62bd31c7ca54">   40</a></span>&#160;<span class="preprocessor">#define AP_COMPASS_OFFSETS_MAX_DEFAULT 1800</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#ifndef HAL_COMPASS_FILTER_DEFAULT</span></div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="AP__Compass_8cpp.html#aced1819bbf63ee14663aa60cca76fa80">   44</a></span>&#160;<span class="preprocessor"> #define HAL_COMPASS_FILTER_DEFAULT 0 // turned off by default</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#ifndef HAL_COMPASS_AUTO_ROT_DEFAULT</span></div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="AP__Compass_8cpp.html#abd241224760f1a380278880c2908a112">   48</a></span>&#160;<span class="preprocessor">#define HAL_COMPASS_AUTO_ROT_DEFAULT 2</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="keyword">const</span> <a class="code" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code" href="classCompass.html#a93d4187acb991b33c5c25f9e16b3b0ce">Compass::var_info</a>[] = {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// index 0 was used for the old orientation matrix</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// @Param: OFS_X</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// @DisplayName: Compass offsets in milligauss on the X axis</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="comment">// @Description: Offset to be added to the compass x-axis values to compensate for metal in the frame</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="comment">// @Range: -400 400</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">// @Units: mGauss</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="comment">// @Param: OFS_Y</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// @DisplayName: Compass offsets in milligauss on the Y axis</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// @Description: Offset to be added to the compass y-axis values to compensate for metal in the frame</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">// @Range: -400 400</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">// @Units: mGauss</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">// @Param: OFS_Z</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// @DisplayName: Compass offsets in milligauss on the Z axis</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// @Description: Offset to be added to the compass z-axis values to compensate for metal in the frame</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="comment">// @Range: -400 400</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// @Units: mGauss</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;OFS&quot;</span>,    1, <a class="code" href="classCompass.html">Compass</a>, _state[0].offset, 0),</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="comment">// @Param: DEC</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="comment">// @DisplayName: Compass declination</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// @Description: An angle to compensate between the true north and magnetic north</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">// @Range: -3.142 3.142</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="comment">// @Units: rad</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">// @Increment: 0.01</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DEC&quot;</span>,    2, <a class="code" href="classCompass.html">Compass</a>, _declination, 0),</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="comment">// @Param: LEARN</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// @DisplayName: Learn compass offsets automatically</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// @Description: Enable or disable the automatic learning of compass offsets. You can enable learning either using a compass-only method that is suitable only for fixed wing aircraft or using the offsets learnt by the active EKF state estimator. If this option is enabled then the learnt offsets are saved when you disarm the vehicle. If InFlight learning is enabled then the compass with automatically start learning once a flight starts (must be armed). While InFlight learning is running you cannot use position control modes.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Internal-Learning,2:EKF-Learning,3:InFlight-Learning</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;LEARN&quot;</span>,  3, <a class="code" href="classCompass.html">Compass</a>, _learn, <a class="code" href="AP__Compass_8cpp.html#abbd00be969534e4587e3479da3759384">COMPASS_LEARN_DEFAULT</a>),</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// @Param: USE</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="comment">// @DisplayName: Use compass for yaw</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// @Description: Enable or disable the use of the compass (instead of the GPS) for determining heading</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USE&quot;</span>,    4, <a class="code" href="classCompass.html">Compass</a>, _state[0].use_for_yaw, 1), <span class="comment">// true if used for DCM yaw</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// @Param: AUTODEC</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="comment">// @DisplayName: Auto Declination</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// @Description: Enable or disable the automatic calculation of the declination based on gps location</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;AUTODEC&quot;</span>,5, <a class="code" href="classCompass.html">Compass</a>, _auto_declination, 1),</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// @Param: MOTCT</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation type</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// @Description: Set motor interference compensation type to disabled, throttle or current.  Do not change manually.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Use Throttle,2:Use Current</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;MOTCT&quot;</span>,    6, <a class="code" href="classCompass.html">Compass</a>, _motor_comp_type, <a class="code" href="AP__Compass_8h.html#aea476312c9a32f19ab3a0d62f4027869">AP_COMPASS_MOT_COMP_DISABLED</a>),</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">// @Param: MOT_X</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation for body frame X axis</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to the compass&#39;s x-axis values to compensate for motor interference (Offset per Amp or at Full Throttle)</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">// @Units: mGauss/A</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">// @Param: MOT_Y</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation for body frame Y axis</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to the compass&#39;s y-axis values to compensate for motor interference (Offset per Amp or at Full Throttle)</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">// @Units: mGauss/A</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// @Param: MOT_Z</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation for body frame Z axis</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to the compass&#39;s z-axis values to compensate for motor interference (Offset per Amp or at Full Throttle)</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// @Units: mGauss/A</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;MOT&quot;</span>,    7, <a class="code" href="classCompass.html">Compass</a>, _state[0].motor_compensation, 0),</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// @Param: ORIENT</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="comment">// @DisplayName: Compass orientation</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// @Description: The orientation of the first external compass relative to the vehicle frame. This value will be ignored unless this compass is set as an external compass. When set correctly in the northern hemisphere, pointing the nose and right side down should increase the MagX and MagY values respectively. Rolling the vehicle upside down should decrease the MagZ value. For southern hemisphere, switch increase and decrease. NOTE: For internal compasses, AHRS_ORIENT is used.</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// @Values: 0:None,1:Yaw45,2:Yaw90,3:Yaw135,4:Yaw180,5:Yaw225,6:Yaw270,7:Yaw315,8:Roll180,9:Roll180Yaw45,10:Roll180Yaw90,11:Roll180Yaw135,12:Pitch180,13:Roll180Yaw225,14:Roll180Yaw270,15:Roll180Yaw315,16:Roll90,17:Roll90Yaw45,18:Roll90Yaw90,19:Roll90Yaw135,20:Roll270,21:Roll270Yaw45,22:Roll270Yaw90,23:Roll270Yaw135,24:Pitch90,25:Pitch270,26:Pitch180Yaw90,27:Pitch180Yaw270,28:Roll90Pitch90,29:Roll180Pitch90,30:Roll270Pitch90,31:Roll90Pitch180,32:Roll270Pitch180,33:Roll90Pitch270,34:Roll180Pitch270,35:Roll270Pitch270,36:Roll90Pitch180Yaw90,37:Roll90Yaw270,38:Yaw293Pitch68Roll180,39:Pitch315,40:Roll90Pitch315</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ORIENT&quot;</span>, 8, <a class="code" href="classCompass.html">Compass</a>, _state[0].orientation, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>),</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// @Param: EXTERNAL</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// @DisplayName: Compass is attached via an external cable</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="comment">// @Description: Configure compass so it is attached externally. This is auto-detected on PX4 and Pixhawk. Set to 1 if the compass is externally connected. When externally connected the COMPASS_ORIENT option operates independently of the AHRS_ORIENTATION board orientation option. If set to 0 or 1 then auto-detection by bus connection can override the value. If set to 2 then auto-detection will be disabled.</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// @Values: 0:Internal,1:External,2:ForcedExternal</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EXTERNAL&quot;</span>, 9, <a class="code" href="classCompass.html">Compass</a>, _state[0].external, 0),</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">// @Param: OFS2_X</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="comment">// @DisplayName: Compass2 offsets in milligauss on the X axis</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="comment">// @Description: Offset to be added to compass2&#39;s x-axis values to compensate for metal in the frame</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="comment">// @Range: -400 400</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="comment">// @Units: mGauss</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// @Param: OFS2_Y</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// @DisplayName: Compass2 offsets in milligauss on the Y axis</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// @Description: Offset to be added to compass2&#39;s y-axis values to compensate for metal in the frame</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">// @Range: -400 400</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// @Units: mGauss</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// @Param: OFS2_Z</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="comment">// @DisplayName: Compass2 offsets in milligauss on the Z axis</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// @Description: Offset to be added to compass2&#39;s z-axis values to compensate for metal in the frame</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// @Range: -400 400</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// @Units: mGauss</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;OFS2&quot;</span>,    10, <a class="code" href="classCompass.html">Compass</a>, _state[1].offset, 0),</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="comment">// @Param: MOT2_X</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass2 for body frame X axis</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass2&#39;s x-axis values to compensate for motor interference (Offset per Amp or at Full Throttle)</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// @Units: mGauss/A</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// @Param: MOT2_Y</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass2 for body frame Y axis</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass2&#39;s y-axis values to compensate for motor interference (Offset per Amp or at Full Throttle)</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// @Units: mGauss/A</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// @Param: MOT2_Z</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass2 for body frame Z axis</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass2&#39;s z-axis values to compensate for motor interference (Offset per Amp or at Full Throttle)</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// @Units: mGauss/A</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;MOT2&quot;</span>,    11, <a class="code" href="classCompass.html">Compass</a>, _state[1].motor_compensation, 0),</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// @Param: PRIMARY</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// @DisplayName: Choose primary compass</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// @Description: If more than one compass is available, this selects which compass is the primary. When external compasses are connected, they will be ordered first. NOTE: If no external compass is attached, this parameter is ignored.</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// @Values: 0:FirstCompass,1:SecondCompass,2:ThirdCompass</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;PRIMARY&quot;</span>, 12, <a class="code" href="classCompass.html">Compass</a>, _primary, 0),</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// @Param: OFS3_X</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// @DisplayName: Compass3 offsets in milligauss on the X axis</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// @Description: Offset to be added to compass3&#39;s x-axis values to compensate for metal in the frame</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">// @Range: -400 400</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// @Units: mGauss</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="comment">// @Param: OFS3_Y</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// @DisplayName: Compass3 offsets in milligauss on the Y axis</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// @Description: Offset to be added to compass3&#39;s y-axis values to compensate for metal in the frame</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// @Range: -400 400</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// @Units: mGauss</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// @Param: OFS3_Z</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// @DisplayName: Compass3 offsets in milligauss on the Z axis</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// @Description: Offset to be added to compass3&#39;s z-axis values to compensate for metal in the frame</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// @Range: -400 400</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// @Units: mGauss</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;OFS3&quot;</span>,    13, <a class="code" href="classCompass.html">Compass</a>, _state[2].offset, 0),</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">// @Param: MOT3_X</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass3 for body frame X axis</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass3&#39;s x-axis values to compensate for motor interference (Offset per Amp or at Full Throttle)</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// @Units: mGauss/A</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// @Param: MOT3_Y</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass3 for body frame Y axis</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass3&#39;s y-axis values to compensate for motor interference (Offset per Amp or at Full Throttle)</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// @Units: mGauss/A</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="comment">// @Param: MOT3_Z</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// @DisplayName: Motor interference compensation to compass3 for body frame Z axis</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// @Description: Multiplied by the current throttle and added to compass3&#39;s z-axis values to compensate for motor interference (Offset per Amp or at Full Throttle)</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// @Range: -1000 1000</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="comment">// @Units: mGauss/A</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;MOT3&quot;</span>,    14, <a class="code" href="classCompass.html">Compass</a>, _state[2].motor_compensation, 0),</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// @Param: DEV_ID</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// @DisplayName: Compass device id</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// @Description: Compass device id.  Automatically detected, do not set manually</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// @ReadOnly: True</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DEV_ID&quot;</span>,  15, <a class="code" href="classCompass.html">Compass</a>, _state[0].dev_id, 0),</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// @Param: DEV_ID2</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="comment">// @DisplayName: Compass2 device id</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// @Description: Second compass&#39;s device id.  Automatically detected, do not set manually</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// @ReadOnly: True</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DEV_ID2&quot;</span>, 16, <a class="code" href="classCompass.html">Compass</a>, _state[1].dev_id, 0),</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// @Param: DEV_ID3</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// @DisplayName: Compass3 device id</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// @Description: Third compass&#39;s device id.  Automatically detected, do not set manually</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// @ReadOnly: True</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DEV_ID3&quot;</span>, 17, <a class="code" href="classCompass.html">Compass</a>, _state[2].dev_id, 0),</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// @Param: USE2</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// @DisplayName: Compass2 used for yaw</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// @Description: Enable or disable the second compass for determining heading.</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USE2&quot;</span>,    18, <a class="code" href="classCompass.html">Compass</a>, _state[1].use_for_yaw, 1),</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// @Param: ORIENT2</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// @DisplayName: Compass2 orientation</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// @Description: The orientation of a second external compass relative to the vehicle frame. This value will be ignored unless this compass is set as an external compass. When set correctly in the northern hemisphere, pointing the nose and right side down should increase the MagX and MagY values respectively. Rolling the vehicle upside down should decrease the MagZ value. For southern hemisphere, switch increase and decrease. NOTE: For internal compasses, AHRS_ORIENT is used.</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// @Values: 0:None,1:Yaw45,2:Yaw90,3:Yaw135,4:Yaw180,5:Yaw225,6:Yaw270,7:Yaw315,8:Roll180,9:Roll180Yaw45,10:Roll180Yaw90,11:Roll180Yaw135,12:Pitch180,13:Roll180Yaw225,14:Roll180Yaw270,15:Roll180Yaw315,16:Roll90,17:Roll90Yaw45,18:Roll90Yaw90,19:Roll90Yaw135,20:Roll270,21:Roll270Yaw45,22:Roll270Yaw90,23:Roll270Yaw135,24:Pitch90,25:Pitch270,26:Pitch180Yaw90,27:Pitch180Yaw270,28:Roll90Pitch90,29:Roll180Pitch90,30:Roll270Pitch90,31:Roll90Pitch180,32:Roll270Pitch180,33:Roll90Pitch270,34:Roll180Pitch270,35:Roll270Pitch270,36:Roll90Pitch180Yaw90,37:Roll90Yaw270,38:Yaw293Pitch68Roll180,39:Pitch315,40:Roll90Pitch315</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ORIENT2&quot;</span>, 19, <a class="code" href="classCompass.html">Compass</a>, _state[1].orientation, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>),</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// @Param: EXTERN2</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="comment">// @DisplayName: Compass2 is attached via an external cable</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">// @Description: Configure second compass so it is attached externally. This is auto-detected on PX4 and Pixhawk. If set to 0 or 1 then auto-detection by bus connection can override the value. If set to 2 then auto-detection will be disabled.</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="comment">// @Values: 0:Internal,1:External,2:ForcedExternal</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EXTERN2&quot;</span>,20, <a class="code" href="classCompass.html">Compass</a>, _state[1].external, 0),</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// @Param: USE3</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="comment">// @DisplayName: Compass3 used for yaw</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// @Description: Enable or disable the third compass for determining heading.</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;USE3&quot;</span>,    21, <a class="code" href="classCompass.html">Compass</a>, _state[2].use_for_yaw, 1),</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// @Param: ORIENT3</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// @DisplayName: Compass3 orientation</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// @Description: The orientation of a third external compass relative to the vehicle frame. This value will be ignored unless this compass is set as an external compass. When set correctly in the northern hemisphere, pointing the nose and right side down should increase the MagX and MagY values respectively. Rolling the vehicle upside down should decrease the MagZ value. For southern hemisphere, switch increase and decrease. NOTE: For internal compasses, AHRS_ORIENT is used.</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// @Values: 0:None,1:Yaw45,2:Yaw90,3:Yaw135,4:Yaw180,5:Yaw225,6:Yaw270,7:Yaw315,8:Roll180,9:Roll180Yaw45,10:Roll180Yaw90,11:Roll180Yaw135,12:Pitch180,13:Roll180Yaw225,14:Roll180Yaw270,15:Roll180Yaw315,16:Roll90,17:Roll90Yaw45,18:Roll90Yaw90,19:Roll90Yaw135,20:Roll270,21:Roll270Yaw45,22:Roll270Yaw90,23:Roll270Yaw135,24:Pitch90,25:Pitch270,26:Pitch180Yaw90,27:Pitch180Yaw270,28:Roll90Pitch90,29:Roll180Pitch90,30:Roll270Pitch90,31:Roll90Pitch180,32:Roll270Pitch180,33:Roll90Pitch270,34:Roll180Pitch270,35:Roll270Pitch270,36:Roll90Pitch180Yaw90,37:Roll90Yaw270,38:Yaw293Pitch68Roll180,39:Pitch315,40:Roll90Pitch315</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ORIENT3&quot;</span>, 22, <a class="code" href="classCompass.html">Compass</a>, _state[2].orientation, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>),</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="comment">// @Param: EXTERN3</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="comment">// @DisplayName: Compass3 is attached via an external cable</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// @Description: Configure third compass so it is attached externally. This is auto-detected on PX4 and Pixhawk. If set to 0 or 1 then auto-detection by bus connection can override the value. If set to 2 then auto-detection will be disabled.</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// @Values: 0:Internal,1:External,2:ForcedExternal</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EXTERN3&quot;</span>,23, <a class="code" href="classCompass.html">Compass</a>, _state[2].external, 0),</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// @Param: DIA_X</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// @DisplayName: Compass soft-iron diagonal X component</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// @Description: DIA_X in the compass soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// @Param: DIA_Y</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// @DisplayName: Compass soft-iron diagonal Y component</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">// @Description: DIA_Y in the compass soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// @Param: DIA_Z</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="comment">// @DisplayName: Compass soft-iron diagonal Z component</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// @Description: DIA_Z in the compass soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DIA&quot;</span>,    24, <a class="code" href="classCompass.html">Compass</a>, _state[0].diagonals, 0),</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// @Param: ODI_X</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// @DisplayName: Compass soft-iron off-diagonal X component</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// @Description: ODI_X in the compass soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// @Param: ODI_Y</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// @DisplayName: Compass soft-iron off-diagonal Y component</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// @Description: ODI_Y in the compass soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="comment">// @Param: ODI_Z</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">// @DisplayName: Compass soft-iron off-diagonal Z component</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="comment">// @Description: ODI_Z in the compass soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ODI&quot;</span>,    25, <a class="code" href="classCompass.html">Compass</a>, _state[0].offdiagonals, 0),</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="comment">// @Param: DIA2_X</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">// @DisplayName: Compass2 soft-iron diagonal X component</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// @Description: DIA_X in the compass2 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">// @Param: DIA2_Y</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="comment">// @DisplayName: Compass2 soft-iron diagonal Y component</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="comment">// @Description: DIA_Y in the compass2 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// @Param: DIA2_Z</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// @DisplayName: Compass2 soft-iron diagonal Z component</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// @Description: DIA_Z in the compass2 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DIA2&quot;</span>,    26, <a class="code" href="classCompass.html">Compass</a>, _state[1].diagonals, 0),</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">// @Param: ODI2_X</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">// @DisplayName: Compass2 soft-iron off-diagonal X component</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">// @Description: ODI_X in the compass2 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// @Param: ODI2_Y</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">// @DisplayName: Compass2 soft-iron off-diagonal Y component</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="comment">// @Description: ODI_Y in the compass2 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// @Param: ODI2_Z</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// @DisplayName: Compass2 soft-iron off-diagonal Z component</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    <span class="comment">// @Description: ODI_Z in the compass2 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ODI2&quot;</span>,    27, <a class="code" href="classCompass.html">Compass</a>, _state[1].offdiagonals, 0),</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// @Param: DIA3_X</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// @DisplayName: Compass3 soft-iron diagonal X component</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// @Description: DIA_X in the compass3 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">// @Param: DIA3_Y</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// @DisplayName: Compass3 soft-iron diagonal Y component</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">// @Description: DIA_Y in the compass3 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">// @Param: DIA3_Z</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// @DisplayName: Compass3 soft-iron diagonal Z component</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">// @Description: DIA_Z in the compass3 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DIA3&quot;</span>,    28, <a class="code" href="classCompass.html">Compass</a>, _state[2].diagonals, 0),</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// @Param: ODI3_X</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// @DisplayName: Compass3 soft-iron off-diagonal X component</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// @Description: ODI_X in the compass3 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// @Param: ODI3_Y</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// @DisplayName: Compass3 soft-iron off-diagonal Y component</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// @Description: ODI_Y in the compass3 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="comment">// @Param: ODI3_Z</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="comment">// @DisplayName: Compass3 soft-iron off-diagonal Z component</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// @Description: ODI_Z in the compass3 soft-iron calibration matrix: [[DIA_X, ODI_X, ODI_Y], [ODI_X, DIA_Y, ODI_Z], [ODI_Y, ODI_Z, DIA_Z]]</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ODI3&quot;</span>,    29, <a class="code" href="classCompass.html">Compass</a>, _state[2].offdiagonals, 0),</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// @Param: CAL_FIT</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// @DisplayName: Compass calibration fitness</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// @Description: This controls the fitness level required for a successful compass calibration. A lower value makes for a stricter fit (less likely to pass). This is the value used for the primary magnetometer. Other magnetometers get double the value.</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// @Range: 4 32</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">// @Values: 4:Very Strict,8:Strict,16:Default,32:Relaxed</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// @Increment: 0.1</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;CAL_FIT&quot;</span>, 30, <a class="code" href="classCompass.html">Compass</a>, _calibration_threshold, <a class="code" href="AP__Compass_8h.html#af4b14d20a1ad32e0d381181e1d92a7ca">AP_COMPASS_CALIBRATION_FITNESS_DEFAULT</a>),</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// @Param: OFFS_MAX</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// @DisplayName: Compass maximum offset</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="comment">// @Description: This sets the maximum allowed compass offset in calibration and arming checks</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">// @Range: 500 3000</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;OFFS_MAX&quot;</span>, 31, <a class="code" href="classCompass.html">Compass</a>, _offset_max, <a class="code" href="AP__Compass_8cpp.html#a6db3df6d28073ae8f6bb62bd31c7ca54">AP_COMPASS_OFFSETS_MAX_DEFAULT</a>),</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">// @Group: PMOT</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">// @Path: Compass_PerMotor.cpp</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="AP__Param_8h.html#a16c360358c5d6a08d34f60921fd916a9">AP_SUBGROUPINFO</a>(_per_motor, <span class="stringliteral">&quot;PMOT&quot;</span>, 32, <a class="code" href="classCompass.html">Compass</a>, <a class="code" href="classCompass__PerMotor.html">Compass_PerMotor</a>),</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">// @Param: TYPEMASK</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// @DisplayName: Compass disable driver type mask</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// @Description: This is a bitmask of driver types to disable. If a driver type is set in this mask then that driver will not try to find a sensor at startup</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// @Bitmask: 0:HMC5883,1:LSM303D,2:AK8963,3:BMM150,4:LSM9DS1,5:LIS3MDL,6:AK09916,7:IST8310,8:ICM20948,9:MMC3416,11:UAVCAN,12:QMC5883,14:MAG3110,15:IST8308</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;TYPEMASK&quot;</span>, 33, <a class="code" href="classCompass.html">Compass</a>, _driver_type_mask, 0),</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">// @Param: FLTR_RNG</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// @DisplayName: Range in which sample is accepted</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// @Description: This sets the range around the average value that new samples must be within to be accepted. This can help reduce the impact of noise on sensors that are on long I2C cables. The value is a percentage from the average value. A value of zero disables this filter.</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// @Units: %</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">// @Range: 0 100</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">// @Increment: 1</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;FLTR_RNG&quot;</span>, 34, <a class="code" href="classCompass.html">Compass</a>, _filter_range, <a class="code" href="AP__Compass_8cpp.html#aced1819bbf63ee14663aa60cca76fa80">HAL_COMPASS_FILTER_DEFAULT</a>),</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">// @Param: AUTO_ROT</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">// @DisplayName: Automatically check orientation</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// @Description: When enabled this will automatically check the orientation of compasses on successful completion of compass calibration. If set to 2 then external compasses will have their orientation automatically corrected.</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:CheckOnly,2:CheckAndFix</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;AUTO_ROT&quot;</span>, 35, <a class="code" href="classCompass.html">Compass</a>, _rotate_auto, <a class="code" href="AP__Compass_8cpp.html#abd241224760f1a380278880c2908a112">HAL_COMPASS_AUTO_ROT_DEFAULT</a>),</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// @Param: EXP_DID</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// @DisplayName: Compass device id expected</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">// @Description: The expected value of COMPASS_DEV_ID, used by arming checks. Setting this to -1 means &quot;don&#39;t care.&quot;</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EXP_DID&quot;</span>,  36, <a class="code" href="classCompass.html">Compass</a>, _state[0].expected_dev_id, -1),</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// @Param: EXP_DID2</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">// @DisplayName: Compass2 device id expected</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">// @Description: The expected value of COMPASS_DEV_ID2, used by arming checks. Setting this to -1 means &quot;don&#39;t care.&quot;</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EXP_DID2&quot;</span>, 37, <a class="code" href="classCompass.html">Compass</a>, _state[1].expected_dev_id, -1),</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">// @Param: EXP_DID3</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">// @DisplayName: Compass3 device id expected</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// @Description: The expected value of COMPASS_DEV_ID3, used by arming checks. Setting this to -1 means &quot;don&#39;t care.&quot;</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;EXP_DID3&quot;</span>, 38, <a class="code" href="classCompass.html">Compass</a>, _state[2].expected_dev_id, -1),</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">// @Param: ENABLE</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">// @DisplayName: Enable Compass</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">// @Description: Setting this to Enabled(1) will enable the compass. Setting this to Disabled(0) will disable the compass. Note that this is separate from COMPASS_USE. This will enable the low level senor, and will enable logging of magnetometer data. To use the compass for navigation you must also set COMPASS_USE to 1.</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">// @User: Standard</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// @Values: 0:Disabled,1:Enabled</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;ENABLE&quot;</span>, 39, <a class="code" href="classCompass.html">Compass</a>, _enabled, 1),</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;};</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">// Default constructor.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">// Note that the Vector/Matrix constructors already implicitly zero</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">// their values.</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00495"></a><span class="lineno"><a class="line" href="classCompass.html#a68bd2a073cc0d461b2b46529aae04765">  495</a></span>&#160;<a class="code" href="classCompass.html#a68bd2a073cc0d461b2b46529aae04765">Compass::Compass</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;{</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#aa3e1ccaef661d5ff5d2e51cd7742c6ba">_singleton</a> != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">#if CONFIG_HAL_BOARD == HAL_BOARD_SITL</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <a class="code" href="namespaceAP__HAL.html#a71832f03d849a0c088f04fc98d3c8143">AP_HAL::panic</a>(<span class="stringliteral">&quot;Compass must be singleton&quot;</span>);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    }</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="classCompass.html#aa3e1ccaef661d5ff5d2e51cd7742c6ba">_singleton</a> = <span class="keyword">this</span>;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a>(<span class="keyword">this</span>, <a class="code" href="classCompass.html#a93d4187acb991b33c5c25f9e16b3b0ce">var_info</a>);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;}</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">// Default init method</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00509"></a><span class="lineno"><a class="line" href="classCompass.html#a79db6bfd3fe309c6258d783f126326c6">  509</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#a79db6bfd3fe309c6258d783f126326c6">Compass::init</a>()</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;{</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="namespaceAP.html#ab9d0bcbec954b6c20abd8e13e6de7356">AP::compass</a>().<a class="code" href="classCompass.html#a2e8b43d6582576f5a032998f3db0448f">enabled</a>()) {</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    }</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a> == 0) {</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="comment">// detect available backends. Only called once</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="classCompass.html#a1c48170d8c8966b22fb150b1634443ec">_detect_backends</a>();</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a> != 0) {</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="comment">// get initial health status</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#ab3175e2e6223ccfe82f957e41cc12b26">delay</a>(100);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <a class="code" href="classCompass.html#a2593e947a6c8a4937dccd2d367158b74">read</a>();</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    }</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// set the dev_id to 0 for undetected compasses, to make it easier</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// for users to see how many compasses are detected. We don&#39;t do a</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// set_and_save() as the user may have temporarily removed the</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// compass, and we don&#39;t want to force a re-cal if they plug it</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// back in again</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">for</span> (uint8_t i=<a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a>; i&lt;<a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; i++) {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#afe6deabcf507751cd66c36639bb9dde0">dev_id</a>.set(0);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    <span class="comment">// check that we are actually working before passing the compass</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// through to ARHS to use.</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classCompass.html#a2593e947a6c8a4937dccd2d367158b74">read</a>()) {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="classCompass.html#ab315b6dc2d05ea4649d5cf8f1a2b511a">_enabled</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a92168462febe0f5ab9556dc9ea4ddb7a">console</a>-&gt;<a class="code" href="classAP__HAL_1_1BetterStream.html#a8534aa004599bb81ad60f3e762791032">printf</a>(<span class="stringliteral">&quot;Compass initialisation failed\n&quot;</span>);</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <a class="code" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().<a class="code" href="classAP__Logger.html#a5f47086952bb5e841d979491e6dd562f">Write_Error</a>(<a class="code" href="AP__Logger_8h.html#a88b4cdb83aeee0d38a55b8194381057fab513c44a4d8c00922c7155d8a90dfde5">LogErrorSubsystem::COMPASS</a>, <a class="code" href="AP__Logger_8h.html#a90bd604ad2616a0bd3da3a8c055d33c9a7f8e5befc5f6252522b93b1d0cd9f101">LogErrorCode::FAILED_TO_INITIALISE</a>);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <a class="code" href="namespaceAP.html#a99432cfdb696952c9b7146f155a815aa">AP::ahrs</a>().<a class="code" href="classAP__AHRS.html#a6902570304ec8a9d38c57e5b053e6d0a">set_compass</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;}</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">//  Register a new compass instance</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00547"></a><span class="lineno"><a class="line" href="classCompass.html#af1b5ea3ff42b02e04526d4be361a1ca1">  547</a></span>&#160;uint8_t <a class="code" href="classCompass.html#af1b5ea3ff42b02e04526d4be361a1ca1">Compass::register_compass</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;{</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a> == <a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>) {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="namespaceAP__HAL.html#a71832f03d849a0c088f04fc98d3c8143">AP_HAL::panic</a>(<span class="stringliteral">&quot;Too many compass instances&quot;</span>);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    }</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a>++;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno"><a class="line" href="classCompass.html#a23dca9254efb3dedb9dcd565c829d707">  555</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classCompass.html#a23dca9254efb3dedb9dcd565c829d707">Compass::_add_backend</a>(<a class="code" href="classAP__Compass__Backend.html">AP_Compass_Backend</a> *backend)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;{</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keywordflow">if</span> (!backend) {</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a> == <a class="code" href="AP__Compass_8h.html#a5ae256887a80a65f39d06f1cb2cbfacb">COMPASS_MAX_BACKEND</a>) {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <a class="code" href="namespaceAP__HAL.html#a71832f03d849a0c088f04fc98d3c8143">AP_HAL::panic</a>(<span class="stringliteral">&quot;Too many compass backends&quot;</span>);</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="classCompass.html#af46d67cb8eb4bc4c51bb12be6813cfdd">_backends</a>[<a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a>++] = backend;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;}</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">  return true if a driver type is enabled</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00573"></a><span class="lineno"><a class="line" href="classCompass.html#a678ad037acc44e46598012b7ad17b2a6">  573</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classCompass.html#a678ad037acc44e46598012b7ad17b2a6">Compass::_driver_enabled</a>(<span class="keyword">enum</span> <a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19">DriverType</a> driver_type)</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;{</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    uint32_t mask = (1U&lt;&lt;uint8_t(driver_type));</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">return</span> (mask &amp; uint32_t(<a class="code" href="classCompass.html#aa2db70e5e7eb6b25d70550322849b862">_driver_type_mask</a>.get())) == 0;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;}</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">  wrapper around hal.i2c_mgr-&gt;get_device() that prevents duplicate devices being opened</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="classCompass.html#a32fb8b55b7ee1c439e7c42ce2c02f5eb">  582</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classCompass.html#a32fb8b55b7ee1c439e7c42ce2c02f5eb">Compass::_have_i2c_driver</a>(uint8_t bus, uint8_t address)<span class="keyword"> const</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a>; i++) {</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__HAL_1_1Device.html#a368ef415e1e4efed7c05a48456a0ae83">AP_HAL::Device::make_bus_id</a>(<a class="code" href="classAP__HAL_1_1Device.html#abdd5c39f57e7022979565e92b6578ba1a3cba5573df48b0d7c5c9e7e307f09da9">AP_HAL::Device::BUS_TYPE_I2C</a>, bus, address, 0) ==</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <a class="code" href="classAP__HAL_1_1Device.html#a663eff6026e905d17cbfa61853f8b032">AP_HAL::Device::change_bus_id</a>(uint32_t(<a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].dev_id.get()), 0)) {</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="comment">// we are already using this device</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;}</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">  macro to add a backend with check for too many backends or compass</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">  instances. We don&#39;t try to start more than the maximum allowed</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">  598</a></span>&#160;<span class="preprocessor">#define ADD_BACKEND(driver_type, backend)   \</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">    do { if (_driver_enabled(driver_type)) { _add_backend(backend); } \</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor">       if (_backend_count == COMPASS_MAX_BACKEND || \</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="preprocessor">           _compass_count == COMPASS_MAX_INSTANCES) { \</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="preprocessor">          return; \</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="preprocessor">        } \</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="preprocessor">    } while (0)</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno"><a class="line" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">  606</a></span>&#160;<span class="preprocessor">#define GET_I2C_DEVICE(bus, address) _have_i2c_driver(bus, address)?nullptr:hal.i2c_mgr-&gt;get_device(bus, address)</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">  look for compasses on external i2c buses</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00611"></a><span class="lineno"><a class="line" href="classCompass.html#a766d77e1b78dc08be50ba76994c8b4ab">  611</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#a766d77e1b78dc08be50ba76994c8b4ab">Compass::_probe_external_i2c_compasses</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;{</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordtype">bool</span> all_external = (<a class="code" href="classAP__BoardConfig.html#a8a3185c191ab40fd95ceeadd8a5b0cf9">AP_BoardConfig::get_board_type</a>() == <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ad387380811280b3f995f8387ab50264e">AP_BoardConfig::PX4_BOARD_PIXHAWK2</a>);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">// external i2c bus</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <a class="code" href="I2CDevice_8h.html#a09f11b4bf995e11cb0b54264fa1b831c">FOREACH_I2C_EXTERNAL</a>(i) {</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>),</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                                                              <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681aeb81d9199def1f929a5e5798d37c49c5">ROTATION_ROLL_180</a>));</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__BoardConfig.html#a8a3185c191ab40fd95ceeadd8a5b0cf9">AP_BoardConfig::get_board_type</a>() != <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a6aaf12ce90b5b9586d350af949ab84a0">AP_BoardConfig::PX4_BOARD_MINDPXV2</a> &amp;&amp;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <a class="code" href="classAP__BoardConfig.html#a8a3185c191ab40fd95ceeadd8a5b0cf9">AP_BoardConfig::get_board_type</a>() != <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a97426996f59ed4a7534cfd7bb6a3174a">AP_BoardConfig::PX4_BOARD_AEROFC</a>) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="comment">// internal i2c bus</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <a class="code" href="I2CDevice_8h.html#ad421e4346d33acf4c95a34a807dc531b">FOREACH_I2C_INTERNAL</a>(i) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>),</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                                                  all_external, all_external?<a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681aeb81d9199def1f929a5e5798d37c49c5">ROTATION_ROLL_180</a>:<a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a5d8b9c520b551d026df8d4aea2801294">ROTATION_YAW_270</a>));</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        }</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    }</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">//external i2c bus</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="I2CDevice_8h.html#a09f11b4bf995e11cb0b54264fa1b831c">FOREACH_I2C_EXTERNAL</a>(i) {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a8fe2c5923dcfbef2601751ddfa48f2fc">DRIVER_QMC5883</a>, <a class="code" href="classAP__Compass__QMC5883L.html#abd73fb24d1b79b0e669393eec4335731">AP_Compass_QMC5883L::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__QMC5883L_8h.html#a3f1e879cd41b64877257c513fbf11467">HAL_COMPASS_QMC5883L_I2C_ADDR</a>),</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                                               <span class="keyword">true</span>, <a class="code" href="AP__Compass__QMC5883L_8h.html#a53ec2f60b031c276dc75bb835a27ba5a">HAL_COMPASS_QMC5883L_ORIENTATION_EXTERNAL</a>));</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="comment">//internal i2c bus</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    <a class="code" href="I2CDevice_8h.html#ad421e4346d33acf4c95a34a807dc531b">FOREACH_I2C_INTERNAL</a>(i) {</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a8fe2c5923dcfbef2601751ddfa48f2fc">DRIVER_QMC5883</a>, <a class="code" href="classAP__Compass__QMC5883L.html#abd73fb24d1b79b0e669393eec4335731">AP_Compass_QMC5883L::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__QMC5883L_8h.html#a3f1e879cd41b64877257c513fbf11467">HAL_COMPASS_QMC5883L_I2C_ADDR</a>),</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                                                               all_external,</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                                               all_external?<a class="code" href="AP__Compass__QMC5883L_8h.html#a53ec2f60b031c276dc75bb835a27ba5a">HAL_COMPASS_QMC5883L_ORIENTATION_EXTERNAL</a>:<a class="code" href="AP__Compass__QMC5883L_8h.html#a620cedda01ad03d53443edb4a0131d88">HAL_COMPASS_QMC5883L_ORIENTATION_INTERNAL</a>));</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    }</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    </div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="preprocessor">#if !HAL_MINIMIZE_FEATURES</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="comment">// AK09916 on ICM20948</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="I2CDevice_8h.html#a09f11b4bf995e11cb0b54264fa1b831c">FOREACH_I2C_EXTERNAL</a>(i) {</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a51912f7ed58536a787c5b7f165dc61e9">DRIVER_ICM20948</a>, <a class="code" href="classAP__Compass__AK09916.html#a3dc547853733f3261ff83a6051a4684b">AP_Compass_AK09916::probe_ICM20948</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__AK09916_8h.html#a6848bf4867620c224db61628e399feec">HAL_COMPASS_AK09916_I2C_ADDR</a>),</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                                                                        <a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__AK09916_8h.html#abfe14523e6aac1631ce4430716b927db">HAL_COMPASS_ICM20948_I2C_ADDR</a>),</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                                                        <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a869e0e4a85746c9248e03bb2f1ad0229">ROTATION_PITCH_180_YAW_90</a>));</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <a class="code" href="I2CDevice_8h.html#ad421e4346d33acf4c95a34a807dc531b">FOREACH_I2C_INTERNAL</a>(i) {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a51912f7ed58536a787c5b7f165dc61e9">DRIVER_ICM20948</a>, <a class="code" href="classAP__Compass__AK09916.html#a3dc547853733f3261ff83a6051a4684b">AP_Compass_AK09916::probe_ICM20948</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__AK09916_8h.html#a6848bf4867620c224db61628e399feec">HAL_COMPASS_AK09916_I2C_ADDR</a>),</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                                                        <a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__AK09916_8h.html#abfe14523e6aac1631ce4430716b927db">HAL_COMPASS_ICM20948_I2C_ADDR</a>),</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                                                        all_external, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a869e0e4a85746c9248e03bb2f1ad0229">ROTATION_PITCH_180_YAW_90</a>));</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    }</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// lis3mdl on bus 0 with default address</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="I2CDevice_8h.html#ad421e4346d33acf4c95a34a807dc531b">FOREACH_I2C_INTERNAL</a>(i) {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03a77be7424a941a21861931eed0dded">DRIVER_LIS3MDL</a>, <a class="code" href="classAP__Compass__LIS3MDL.html#a6f16f4f86c045eaf84ac3b48ef94d9a3">AP_Compass_LIS3MDL::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__LIS3MDL_8h.html#ac10cbbe8e0464aff5b30a33809111cef">HAL_COMPASS_LIS3MDL_I2C_ADDR</a>),</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                                              all_external, all_external?<a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681afae5b963b8902f5e5846a8929b9b74ba">ROTATION_YAW_90</a>:<a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>));</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    }</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    </div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">// lis3mdl on bus 0 with alternate address</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <a class="code" href="I2CDevice_8h.html#ad421e4346d33acf4c95a34a807dc531b">FOREACH_I2C_INTERNAL</a>(i) {</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03a77be7424a941a21861931eed0dded">DRIVER_LIS3MDL</a>, <a class="code" href="classAP__Compass__LIS3MDL.html#a6f16f4f86c045eaf84ac3b48ef94d9a3">AP_Compass_LIS3MDL::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__LIS3MDL_8h.html#a094c5397594967479d9a2af852999e9a">HAL_COMPASS_LIS3MDL_I2C_ADDR2</a>),</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                                                              all_external, all_external?<a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681afae5b963b8902f5e5846a8929b9b74ba">ROTATION_YAW_90</a>:<a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>));</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    }</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    </div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="comment">// external lis3mdl on bus 1 with default address</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <a class="code" href="I2CDevice_8h.html#a09f11b4bf995e11cb0b54264fa1b831c">FOREACH_I2C_EXTERNAL</a>(i) {</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03a77be7424a941a21861931eed0dded">DRIVER_LIS3MDL</a>, <a class="code" href="classAP__Compass__LIS3MDL.html#a6f16f4f86c045eaf84ac3b48ef94d9a3">AP_Compass_LIS3MDL::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__LIS3MDL_8h.html#ac10cbbe8e0464aff5b30a33809111cef">HAL_COMPASS_LIS3MDL_I2C_ADDR</a>),</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                                                              <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681afae5b963b8902f5e5846a8929b9b74ba">ROTATION_YAW_90</a>));</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    </div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="comment">// external lis3mdl on bus 1 with alternate address</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="I2CDevice_8h.html#a09f11b4bf995e11cb0b54264fa1b831c">FOREACH_I2C_EXTERNAL</a>(i) {</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03a77be7424a941a21861931eed0dded">DRIVER_LIS3MDL</a>, <a class="code" href="classAP__Compass__LIS3MDL.html#a6f16f4f86c045eaf84ac3b48ef94d9a3">AP_Compass_LIS3MDL::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__LIS3MDL_8h.html#a094c5397594967479d9a2af852999e9a">HAL_COMPASS_LIS3MDL_I2C_ADDR2</a>),</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                                                              <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681afae5b963b8902f5e5846a8929b9b74ba">ROTATION_YAW_90</a>));</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    }</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="comment">// AK09916. This can be found twice, due to the ICM20948 i2c bus pass-thru, so we need to be careful to avoid that</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <a class="code" href="I2CDevice_8h.html#a09f11b4bf995e11cb0b54264fa1b831c">FOREACH_I2C_EXTERNAL</a>(i) {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19afd40b80be9d564b799206268c73199c4">DRIVER_AK09916</a>, <a class="code" href="classAP__Compass__AK09916.html#ae805952411e6ebe3d2d0908e4f3ae0ac">AP_Compass_AK09916::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__AK09916_8h.html#a6848bf4867620c224db61628e399feec">HAL_COMPASS_AK09916_I2C_ADDR</a>),</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                                              <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a5d8b9c520b551d026df8d4aea2801294">ROTATION_YAW_270</a>));</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    }</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="I2CDevice_8h.html#ad421e4346d33acf4c95a34a807dc531b">FOREACH_I2C_INTERNAL</a>(i) {</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19afd40b80be9d564b799206268c73199c4">DRIVER_AK09916</a>, <a class="code" href="classAP__Compass__AK09916.html#ae805952411e6ebe3d2d0908e4f3ae0ac">AP_Compass_AK09916::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__AK09916_8h.html#a6848bf4867620c224db61628e399feec">HAL_COMPASS_AK09916_I2C_ADDR</a>),</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                                                              all_external, all_external?<a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a5d8b9c520b551d026df8d4aea2801294">ROTATION_YAW_270</a>:<a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>));</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="comment">// IST8310 on external and internal bus</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__BoardConfig.html#a8a3185c191ab40fd95ceeadd8a5b0cf9">AP_BoardConfig::get_board_type</a>() != <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a6f39405e261af307e647f079d8a6ec56">AP_BoardConfig::PX4_BOARD_FMUV5</a> &amp;&amp;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <a class="code" href="classAP__BoardConfig.html#a8a3185c191ab40fd95ceeadd8a5b0cf9">AP_BoardConfig::get_board_type</a>() != <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ae3bc20831e04c6038b9ad40680003eda">AP_BoardConfig::PX4_BOARD_FMUV6</a>) {</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="keyword">enum</span> <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681">Rotation</a> default_rotation;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__BoardConfig.html#a8a3185c191ab40fd95ceeadd8a5b0cf9">AP_BoardConfig::get_board_type</a>() == <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a97426996f59ed4a7534cfd7bb6a3174a">AP_BoardConfig::PX4_BOARD_AEROFC</a>) {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            default_rotation = <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a869e0e4a85746c9248e03bb2f1ad0229">ROTATION_PITCH_180_YAW_90</a>;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            default_rotation = <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a16e7696bfbca8f804e76718d5cfa5bef">ROTATION_PITCH_180</a>;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        }</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <a class="code" href="I2CDevice_8h.html#a09f11b4bf995e11cb0b54264fa1b831c">FOREACH_I2C_EXTERNAL</a>(i) {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19acc5d43bb11e0e4733807bc8fbc37bd76">DRIVER_IST8310</a>, <a class="code" href="classAP__Compass__IST8310.html#a6f6f86e57c602b84d7cef10c814f77e5">AP_Compass_IST8310::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__IST8310_8h.html#a008c10b66a4077acc3a610c41291773b">HAL_COMPASS_IST8310_I2C_ADDR</a>),</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                                                  <span class="keyword">true</span>, default_rotation));</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        </div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <a class="code" href="I2CDevice_8h.html#ad421e4346d33acf4c95a34a807dc531b">FOREACH_I2C_INTERNAL</a>(i) {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;            <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19acc5d43bb11e0e4733807bc8fbc37bd76">DRIVER_IST8310</a>, <a class="code" href="classAP__Compass__IST8310.html#a6f6f86e57c602b84d7cef10c814f77e5">AP_Compass_IST8310::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__IST8310_8h.html#a008c10b66a4077acc3a610c41291773b">HAL_COMPASS_IST8310_I2C_ADDR</a>),</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                                                  all_external, default_rotation));</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    }</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">// external i2c bus</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <a class="code" href="I2CDevice_8h.html#a09f11b4bf995e11cb0b54264fa1b831c">FOREACH_I2C_EXTERNAL</a>(i) {</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19aefd4c56c784bb6ccfcaea5a6f8cbcda1">DRIVER_IST8308</a>, <a class="code" href="classAP__Compass__IST8308.html#a363d0b94f0293a29a51baa34245d0d32">AP_Compass_IST8308::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__IST8308_8h.html#a3ceac9a4a67efd3aa707dce7a6d55281">HAL_COMPASS_IST8308_I2C_ADDR</a>),</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                                              <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>));</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">#endif // HAL_MINIMIZE_FEATURES</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;}</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment">  detect available backends for this board</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00723"></a><span class="lineno"><a class="line" href="classCompass.html#a1c48170d8c8966b22fb150b1634443ec">  723</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#a1c48170d8c8966b22fb150b1634443ec">Compass::_detect_backends</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;{</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#a26a6c969c9e588fb680b04e99edbe811">_hil_mode</a>) {</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <a class="code" href="classCompass.html#a23dca9254efb3dedb9dcd565c829d707">_add_backend</a>(<a class="code" href="classAP__Compass__HIL.html#af9fccad707f6720c8e26de4d358938d7">AP_Compass_HIL::detect</a>());</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    }</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="preprocessor">#if AP_FEATURE_BOARD_DETECT</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__BoardConfig.html#a8a3185c191ab40fd95ceeadd8a5b0cf9">AP_BoardConfig::get_board_type</a>() == <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ad387380811280b3f995f8387ab50264e">AP_BoardConfig::PX4_BOARD_PIXHAWK2</a>) {</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="comment">// default to disabling LIS3MDL on pixhawk2 due to hardware issue</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <a class="code" href="classCompass.html#aa2db70e5e7eb6b25d70550322849b862">_driver_type_mask</a>.set_default(1U&lt;&lt;<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03a77be7424a941a21861931eed0dded">DRIVER_LIS3MDL</a>);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    }</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    </div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="preprocessor">#if CONFIG_HAL_BOARD == HAL_BOARD_SITL</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19abcf97e88fc61f03836406f3920d4f2ff">DRIVER_SITL</a>, <span class="keyword">new</span> <a class="code" href="classAP__Compass__SITL.html">AP_Compass_SITL</a>());</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="preprocessor">#ifdef HAL_PROBE_EXTERNAL_I2C_COMPASSES</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    <span class="comment">// allow boards to ask for external probing of all i2c compass types in hwdef.dat</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    <a class="code" href="classCompass.html#a766d77e1b78dc08be50ba76994c8b4ab">_probe_external_i2c_compasses</a>();</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a> == <a class="code" href="AP__Compass_8h.html#a5ae256887a80a65f39d06f1cb2cbfacb">COMPASS_MAX_BACKEND</a> ||</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        <a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a> == <a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>) {</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    }</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="preprocessor">#if defined(HAL_MAG_PROBE_LIST)</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="comment">// driver probes defined by COMPASS lines in hwdef.dat</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    HAL_MAG_PROBE_LIST;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_HIL</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19abcf97e88fc61f03836406f3920d4f2ff">DRIVER_SITL</a>, <a class="code" href="classAP__Compass__HIL.html#af9fccad707f6720c8e26de4d358938d7">AP_Compass_HIL::detect</a>());</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">#elif AP_FEATURE_BOARD_DETECT</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classAP__BoardConfig.html#a8a3185c191ab40fd95ceeadd8a5b0cf9">AP_BoardConfig::get_board_type</a>()) {</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983acf567833f77e46ce320a961f68611bff">AP_BoardConfig::PX4_BOARD_PX4V1</a>:</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983aa765b43df6cbdb15f9720f993d79ceb3">AP_BoardConfig::PX4_BOARD_PIXHAWK</a>:</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983aa4b366ff17e0c44076231ae8c51edd42">AP_BoardConfig::PX4_BOARD_PHMINI</a>:</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a922eeb71ccd9862923f68246f86bb667">AP_BoardConfig::PX4_BOARD_AUAV21</a>:</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a78f917fc079eb5acb3e9623f0bbe0ff9">AP_BoardConfig::PX4_BOARD_PH2SLIM</a>:</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ad387380811280b3f995f8387ab50264e">AP_BoardConfig::PX4_BOARD_PIXHAWK2</a>:</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a6aaf12ce90b5b9586d350af949ab84a0">AP_BoardConfig::PX4_BOARD_MINDPXV2</a>:</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a6f39405e261af307e647f079d8a6ec56">AP_BoardConfig::PX4_BOARD_FMUV5</a>:</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ae3bc20831e04c6038b9ad40680003eda">AP_BoardConfig::PX4_BOARD_FMUV6</a>:</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a05ec778f42256d22fbdf58c458707b38">AP_BoardConfig::PX4_BOARD_PIXHAWK_PRO</a>:</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a97426996f59ed4a7534cfd7bb6a3174a">AP_BoardConfig::PX4_BOARD_AEROFC</a>:</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <a class="code" href="classCompass.html#a766d77e1b78dc08be50ba76994c8b4ab">_probe_external_i2c_compasses</a>();</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a> == <a class="code" href="AP__Compass_8h.html#a5ae256887a80a65f39d06f1cb2cbfacb">COMPASS_MAX_BACKEND</a> ||</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a> == <a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>) {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="keywordflow">return</span>;</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ac37e0c90b91e19c9b6945baa8b05b278">AP_BoardConfig::PX4_BOARD_PCNC1</a>:</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19ad0a33febf127c0dccbe03f0709f94122">DRIVER_BMM150</a>,</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                    <a class="code" href="classAP__Compass__BMM150.html#a4c7a517bac53993bc2e9ae970d6657e8">AP_Compass_BMM150::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(0, 0x10)));</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a3c5386db31b5c706894441bb6279eefc">AP_BoardConfig::VRX_BOARD_BRAIN54</a>: {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="comment">// external i2c bus</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(1, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>),</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                                                              <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681aeb81d9199def1f929a5e5798d37c49c5">ROTATION_ROLL_180</a>));</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        }</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="comment">// internal i2c bus</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(0, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>),</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                                                              <span class="keyword">false</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a5d8b9c520b551d026df8d4aea2801294">ROTATION_YAW_270</a>));</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a212c2ff8c6c4ada3668b927ac6728a87">AP_BoardConfig::VRX_BOARD_BRAIN51</a>:</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a939e3484a227aa39019088ac96a9cfd3">AP_BoardConfig::VRX_BOARD_BRAIN52</a>:</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983aedbfaade4bc5663cfd73a8652235bb30">AP_BoardConfig::VRX_BOARD_BRAIN52E</a>:</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a2f0a5b6527161d6a622728dfe8fd4023">AP_BoardConfig::VRX_BOARD_CORE10</a>:</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a53e500f8c050e0ae471194b0fca121cb">AP_BoardConfig::VRX_BOARD_UBRAIN51</a>:</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a122ab74c52fd603b79d0b2c0b5651ed5">AP_BoardConfig::VRX_BOARD_UBRAIN52</a>: {</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="comment">// external i2c bus</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(1, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>),</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                                              <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681aeb81d9199def1f929a5e5798d37c49c5">ROTATION_ROLL_180</a>));</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        }</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    }</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classAP__BoardConfig.html#a8a3185c191ab40fd95ceeadd8a5b0cf9">AP_BoardConfig::get_board_type</a>()) {</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983aa765b43df6cbdb15f9720f993d79ceb3">AP_BoardConfig::PX4_BOARD_PIXHAWK</a>:</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#af8c602bce948527aa20ec7a32562010d">spi</a>-&gt;<a class="code" href="classAP__HAL_1_1SPIDeviceManager.html#a84c4a9ff2ae0cdaa9a0bc8a3f0939893">get_device</a>(<a class="code" href="chibios_8h.html#a4a4d9b4dac87e452c5ee78083fbe7949">HAL_COMPASS_HMC5843_NAME</a>),</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                                                              <span class="keyword">false</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a16e7696bfbca8f804e76718d5cfa5bef">ROTATION_PITCH_180</a>));</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19ad69cd8acf903e732a7c58992df756cd7">DRIVER_LSM303D</a>, <a class="code" href="classAP__Compass__LSM303D.html#a1633f14eb14b05dd82600ce9cc7827ec">AP_Compass_LSM303D::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#af8c602bce948527aa20ec7a32562010d">spi</a>-&gt;<a class="code" href="classAP__HAL_1_1SPIDeviceManager.html#a84c4a9ff2ae0cdaa9a0bc8a3f0939893">get_device</a>(<a class="code" href="chibios_8h.html#a2c59d23ab6be2e59b18f06e2431e5dbb">HAL_INS_LSM9DS0_A_NAME</a>)));</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ad387380811280b3f995f8387ab50264e">AP_BoardConfig::PX4_BOARD_PIXHAWK2</a>:</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19ad69cd8acf903e732a7c58992df756cd7">DRIVER_LSM303D</a>, <a class="code" href="classAP__Compass__LSM303D.html#a1633f14eb14b05dd82600ce9cc7827ec">AP_Compass_LSM303D::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#af8c602bce948527aa20ec7a32562010d">spi</a>-&gt;<a class="code" href="classAP__HAL_1_1SPIDeviceManager.html#a84c4a9ff2ae0cdaa9a0bc8a3f0939893">get_device</a>(<a class="code" href="chibios_8h.html#ae30b37f1f4cd685cec0014ac3a5e00ad">HAL_INS_LSM9DS0_EXT_A_NAME</a>), <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a5d8b9c520b551d026df8d4aea2801294">ROTATION_YAW_270</a>));</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="comment">// we run the AK8963 only on the 2nd MPU9250, which leaves the</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <span class="comment">// first MPU9250 to run without disturbance at high rate</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(1, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a5d8b9c520b551d026df8d4aea2801294">ROTATION_YAW_270</a>));</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19afd40b80be9d564b799206268c73199c4">DRIVER_AK09916</a>, <a class="code" href="classAP__Compass__AK09916.html#a3dc547853733f3261ff83a6051a4684b">AP_Compass_AK09916::probe_ICM20948</a>(0, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3eaa4f433c1b87308e89d9c7bedd7076">ROTATION_ROLL_180_YAW_90</a>));</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a6f39405e261af307e647f079d8a6ec56">AP_BoardConfig::PX4_BOARD_FMUV5</a>:</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ae3bc20831e04c6038b9ad40680003eda">AP_BoardConfig::PX4_BOARD_FMUV6</a>:</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <a class="code" href="I2CDevice_8h.html#a09f11b4bf995e11cb0b54264fa1b831c">FOREACH_I2C_EXTERNAL</a>(i) {</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19acc5d43bb11e0e4733807bc8fbc37bd76">DRIVER_IST8310</a>, <a class="code" href="classAP__Compass__IST8310.html#a6f6f86e57c602b84d7cef10c814f77e5">AP_Compass_IST8310::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__IST8310_8h.html#a008c10b66a4077acc3a610c41291773b">HAL_COMPASS_IST8310_I2C_ADDR</a>),</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                                                                  <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3eaa4f433c1b87308e89d9c7bedd7076">ROTATION_ROLL_180_YAW_90</a>));</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        }</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        <a class="code" href="I2CDevice_8h.html#ad421e4346d33acf4c95a34a807dc531b">FOREACH_I2C_INTERNAL</a>(i) {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19acc5d43bb11e0e4733807bc8fbc37bd76">DRIVER_IST8310</a>, <a class="code" href="classAP__Compass__IST8310.html#a6f6f86e57c602b84d7cef10c814f77e5">AP_Compass_IST8310::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(i, <a class="code" href="AP__Compass__IST8310_8h.html#a008c10b66a4077acc3a610c41291773b">HAL_COMPASS_IST8310_I2C_ADDR</a>),</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                                                  <span class="keyword">false</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3eaa4f433c1b87308e89d9c7bedd7076">ROTATION_ROLL_180_YAW_90</a>));</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a2548b608826699e872a2de7f4e1ff877">AP_BoardConfig::PX4_BOARD_SP01</a>:</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(1, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>));</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        </div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a05ec778f42256d22fbdf58c458707b38">AP_BoardConfig::PX4_BOARD_PIXHAWK_PRO</a>:</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3eaa4f433c1b87308e89d9c7bedd7076">ROTATION_ROLL_180_YAW_90</a>));</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03a77be7424a941a21861931eed0dded">DRIVER_LIS3MDL</a>, <a class="code" href="classAP__Compass__LIS3MDL.html#a6f16f4f86c045eaf84ac3b48ef94d9a3">AP_Compass_LIS3MDL::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#af8c602bce948527aa20ec7a32562010d">spi</a>-&gt;<a class="code" href="classAP__HAL_1_1SPIDeviceManager.html#a84c4a9ff2ae0cdaa9a0bc8a3f0939893">get_device</a>(<a class="code" href="chibios_8h.html#af93f1bddafc9785287d1f3e638125dbc">HAL_COMPASS_LIS3MDL_NAME</a>),</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                                              <span class="keyword">false</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>));</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983aa4b366ff17e0c44076231ae8c51edd42">AP_BoardConfig::PX4_BOARD_PHMINI</a>:</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681aeb81d9199def1f929a5e5798d37c49c5">ROTATION_ROLL_180</a>));</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a922eeb71ccd9862923f68246f86bb667">AP_BoardConfig::PX4_BOARD_AUAV21</a>:</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3eaa4f433c1b87308e89d9c7bedd7076">ROTATION_ROLL_180_YAW_90</a>));</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        </div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a78f917fc079eb5acb3e9623f0bbe0ff9">AP_BoardConfig::PX4_BOARD_PH2SLIM</a>:</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a5d8b9c520b551d026df8d4aea2801294">ROTATION_YAW_270</a>));</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a6aaf12ce90b5b9586d350af949ab84a0">AP_BoardConfig::PX4_BOARD_MINDPXV2</a>:</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(0, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>),</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                                                              <span class="keyword">false</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681afae5b963b8902f5e5846a8929b9b74ba">ROTATION_YAW_90</a>));</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19ad69cd8acf903e732a7c58992df756cd7">DRIVER_LSM303D</a>, <a class="code" href="classAP__Compass__LSM303D.html#a1633f14eb14b05dd82600ce9cc7827ec">AP_Compass_LSM303D::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#af8c602bce948527aa20ec7a32562010d">spi</a>-&gt;<a class="code" href="classAP__HAL_1_1SPIDeviceManager.html#a84c4a9ff2ae0cdaa9a0bc8a3f0939893">get_device</a>(<a class="code" href="chibios_8h.html#a2c59d23ab6be2e59b18f06e2431e5dbb">HAL_INS_LSM9DS0_A_NAME</a>), <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a90f75701d0b21bcb9d12826ac8cb4ef6">ROTATION_PITCH_180_YAW_270</a>));</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        </div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_BH</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>)));</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0));</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_BBBMINI</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>), <span class="keyword">true</span>));</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0));</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(1));</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_NAVIO2</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03d5a05b7c001ea2ba800ec7c90ebc4b">DRIVER_LSM9DS1</a>, <a class="code" href="classAP__Compass__LSM9DS1.html#ac01f0980025641d338f9cfbf09b08ed9">AP_Compass_LSM9DS1::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#af8c602bce948527aa20ec7a32562010d">spi</a>-&gt;<a class="code" href="classAP__HAL_1_1SPIDeviceManager.html#a84c4a9ff2ae0cdaa9a0bc8a3f0939893">get_device</a>(<span class="stringliteral">&quot;lsm9ds1_m&quot;</span>), <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681aeb81d9199def1f929a5e5798d37c49c5">ROTATION_ROLL_180</a>));</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0));</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>), <span class="keyword">true</span>));</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_NAVIO</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0));</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>), <span class="keyword">true</span>));</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_OCPOC_ZYNQ</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>)));</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>,<a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0));</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_EDGE</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>), <span class="keyword">true</span>));</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="preprocessor">#elif CONFIG_HAL_BOARD_SUBTYPE == HAL_BOARD_SUBTYPE_LINUX_PXF || \</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="preprocessor">      CONFIG_HAL_BOARD_SUBTYPE == HAL_BOARD_SUBTYPE_LINUX_ERLEBRAIN2 || \</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="preprocessor">      CONFIG_HAL_BOARD_SUBTYPE == HAL_BOARD_SUBTYPE_LINUX_PXFMINI</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0));</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>), <span class="keyword">true</span>));</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="preprocessor">#elif CONFIG_HAL_BOARD_SUBTYPE == HAL_BOARD_SUBTYPE_LINUX_BLUE</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_AK8963_I2C_BUS, HAL_COMPASS_AK8963_I2C_ADDR)));</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>), <span class="keyword">true</span>));</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="preprocessor">#elif CONFIG_HAL_BOARD_SUBTYPE == HAL_BOARD_SUBTYPE_LINUX_POCKET</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0));</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>), <span class="keyword">true</span>));</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_AK8963_MPU9250</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="preprocessor">#ifndef HAL_COMPASS_AK8963_MPU9250_ROTATION</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="preprocessor">#define HAL_COMPASS_AK8963_MPU9250_ROTATION ROTATION_NONE</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0, HAL_COMPASS_AK8963_MPU9250_ROTATION));</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_HMC5843</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="preprocessor">#ifndef HAL_COMPASS_HMC5843_ROTATION</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="preprocessor"># define HAL_COMPASS_HMC5843_ROTATION ROTATION_NONE</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>),</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                                          <span class="keyword">false</span>, HAL_COMPASS_HMC5843_ROTATION));</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_HMC5843_MPU6000</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#ae81cef752ef1784f4f811c1b4cc57a4b">AP_Compass_HMC5843::probe_mpu6000</a>());</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="preprocessor">#elif  HAL_COMPASS_DEFAULT == HAL_COMPASS_AK8963_I2C</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#afcde08c622086b5faec26b55304e8457">AP_Compass_AK8963::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_AK8963_I2C_BUS, HAL_COMPASS_AK8963_I2C_ADDR)));</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_AK8963_MPU9250_I2C</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_AK8963_I2C_BUS, HAL_COMPASS_AK8963_I2C_ADDR)));</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_AERO</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19ad0a33febf127c0dccbe03f0709f94122">DRIVER_BMM150</a>, <a class="code" href="classAP__Compass__BMM150.html#a4c7a517bac53993bc2e9ae970d6657e8">AP_Compass_BMM150::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_BMM150_I2C_BUS, HAL_COMPASS_BMM150_I2C_ADDR)));</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>), <span class="keyword">true</span>));</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19acc5d43bb11e0e4733807bc8fbc37bd76">DRIVER_IST8310</a>, <a class="code" href="classAP__Compass__IST8310.html#a6f6f86e57c602b84d7cef10c814f77e5">AP_Compass_IST8310::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_IST8310_I2C_BUS, <a class="code" href="AP__Compass__IST8310_8h.html#a008c10b66a4077acc3a610c41291773b">HAL_COMPASS_IST8310_I2C_ADDR</a>),</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                                                          <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a869e0e4a85746c9248e03bb2f1ad0229">ROTATION_PITCH_180_YAW_90</a>));</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_LIS3MDL</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03a77be7424a941a21861931eed0dded">DRIVER_LIS3MDL</a>, <a class="code" href="classAP__Compass__LIS3MDL.html#a6f16f4f86c045eaf84ac3b48ef94d9a3">AP_Compass_LIS3MDL::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#af8c602bce948527aa20ec7a32562010d">spi</a>-&gt;<a class="code" href="classAP__HAL_1_1SPIDeviceManager.html#a84c4a9ff2ae0cdaa9a0bc8a3f0939893">get_device</a>(<a class="code" href="chibios_8h.html#af93f1bddafc9785287d1f3e638125dbc">HAL_COMPASS_LIS3MDL_NAME</a>), <span class="keyword">false</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3eaa4f433c1b87308e89d9c7bedd7076">ROTATION_ROLL_180_YAW_90</a>));</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_MAG3110                </span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19abef69f23181c6c5a6b3357c4d25a3e66">DRIVER_MAG3110</a>, <a class="code" href="classAP__Compass__MAG3110.html#a7504db53af052847097508f4885d2697">AP_Compass_MAG3110::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_MAG3110_I2C_BUS, <a class="code" href="AP__Compass__MAG3110_8h.html#abd616c9bd301c82c4f11f551a86a81d6">HAL_MAG3110_I2C_ADDR</a>), <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a>));</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_IST8310</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19acc5d43bb11e0e4733807bc8fbc37bd76">DRIVER_IST8310</a>, <a class="code" href="classAP__Compass__IST8310.html#a6f6f86e57c602b84d7cef10c814f77e5">AP_Compass_IST8310::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_IST8310_I2C_BUS, <a class="code" href="AP__Compass__IST8310_8h.html#a008c10b66a4077acc3a610c41291773b">HAL_COMPASS_IST8310_I2C_ADDR</a>),</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                                                           <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a869e0e4a85746c9248e03bb2f1ad0229">ROTATION_PITCH_180_YAW_90</a>));</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_QMC5883L</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a8fe2c5923dcfbef2601751ddfa48f2fc">DRIVER_QMC5883</a>, <a class="code" href="classAP__Compass__QMC5883L.html#abd73fb24d1b79b0e669393eec4335731">AP_Compass_QMC5883L::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(1, <a class="code" href="AP__Compass__QMC5883L_8h.html#a3f1e879cd41b64877257c513fbf11467">HAL_COMPASS_QMC5883L_I2C_ADDR</a>),</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                                                           <span class="keyword">true</span>, <a class="code" href="AP__Compass__QMC5883L_8h.html#a53ec2f60b031c276dc75bb835a27ba5a">HAL_COMPASS_QMC5883L_ORIENTATION_EXTERNAL</a>));</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a8fe2c5923dcfbef2601751ddfa48f2fc">DRIVER_QMC5883</a>, <a class="code" href="classAP__Compass__QMC5883L.html#abd73fb24d1b79b0e669393eec4335731">AP_Compass_QMC5883L::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(0, <a class="code" href="AP__Compass__QMC5883L_8h.html#a3f1e879cd41b64877257c513fbf11467">HAL_COMPASS_QMC5883L_I2C_ADDR</a>),</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                                                           <span class="keyword">false</span>, <a class="code" href="AP__Compass__QMC5883L_8h.html#a620cedda01ad03d53443edb4a0131d88">HAL_COMPASS_QMC5883L_ORIENTATION_INTERNAL</a>));</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="preprocessor">#elif CONFIG_HAL_BOARD == HAL_BOARD_LINUX &amp;&amp; CONFIG_HAL_BOARD_SUBTYPE != HAL_BOARD_SUBTYPE_LINUX_NONE</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>)));</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">DRIVER_AK8963</a>, <a class="code" href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a>(0));</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03d5a05b7c001ea2ba800ec7c90ebc4b">DRIVER_LSM9DS1</a>, <a class="code" href="classAP__Compass__LSM9DS1.html#ac01f0980025641d338f9cfbf09b08ed9">AP_Compass_LSM9DS1::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#af8c602bce948527aa20ec7a32562010d">spi</a>-&gt;<a class="code" href="classAP__HAL_1_1SPIDeviceManager.html#a84c4a9ff2ae0cdaa9a0bc8a3f0939893">get_device</a>(<span class="stringliteral">&quot;lsm9ds1_m&quot;</span>)));</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_BMM150_I2C</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19ad0a33febf127c0dccbe03f0709f94122">DRIVER_BMM150</a>, <a class="code" href="classAP__Compass__BMM150.html#a4c7a517bac53993bc2e9ae970d6657e8">AP_Compass_BMM150::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_COMPASS_BMM150_I2C_BUS, HAL_COMPASS_BMM150_I2C_ADDR)));</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="preprocessor">#elif HAL_COMPASS_DEFAULT == HAL_COMPASS_NONE</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="comment">// no compass</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="preprocessor">    #error Unrecognised HAL_COMPASS_TYPE setting</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="comment">/* for chibios external board coniguration */</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="preprocessor">#ifdef HAL_EXT_COMPASS_HMC5843_I2C_BUS</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">DRIVER_HMC5843</a>, <a class="code" href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a>(<a class="code" href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a>(HAL_EXT_COMPASS_HMC5843_I2C_BUS, <a class="code" href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a>),</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                                                          <span class="keyword">true</span>, <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681aeb81d9199def1f929a5e5798d37c49c5">ROTATION_ROLL_180</a>));</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="preprocessor">#if HAL_WITH_UAVCAN</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; <a class="code" href="AP__Compass_8h.html#a5ae256887a80a65f39d06f1cb2cbfacb">COMPASS_MAX_BACKEND</a>; i++) {</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a>(<a class="code" href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a2fd5c3e06d96ca5143069b84b46d4010">DRIVER_UAVCAN</a>, <a class="code" href="classAP__Compass__UAVCAN.html#ac5dca21c8e6aa6a910b17cb5705410e2">AP_Compass_UAVCAN::probe</a>());</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a> == 0 ||</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <a class="code" href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">_compass_count</a> == 0) {</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <a class="code" href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a92168462febe0f5ab9556dc9ea4ddb7a">console</a>-&gt;<a class="code" href="classAP__HAL_1_1BetterStream.html#a8534aa004599bb81ad60f3e762791032">printf</a>(<span class="stringliteral">&quot;No Compass backends available\n&quot;</span>);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    }</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;}</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l00960"></a><span class="lineno"><a class="line" href="classCompass.html#a2593e947a6c8a4937dccd2d367158b74">  960</a></span>&#160;<a class="code" href="classCompass.html#a2593e947a6c8a4937dccd2d367158b74">Compass::read</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;{</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">for</span> (uint8_t i=0; i&lt; <a class="code" href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">_backend_count</a>; i++) {</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="comment">// call read on each of the backend. This call updates field[i]</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        <a class="code" href="classCompass.html#af46d67cb8eb4bc4c51bb12be6813cfdd">_backends</a>[i]-&gt;<a class="code" href="classAP__Compass__Backend.html#a4ad0e616103be3703829b829ab590a53">read</a>();</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    }</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    uint32_t time = <a class="code" href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a>();</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordflow">for</span> (uint8_t i=0; i &lt; <a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; i++) {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#ad12e4054ec35030309b98a799e9f0df4">healthy</a> = (time - <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#a37a5242ab675b8bdf0ce4246e03c5729">last_update_ms</a> &lt; 500);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#a9a5653285eb6768ddfe8b7529ba12c03">_learn</a> == <a class="code" href="classCompass.html#a5ed931ce45b6449a63d57bb01fe5a0c9ac67e46a1613956b81acf80a37742c288">LEARN_INFLIGHT</a> &amp;&amp; !<a class="code" href="classCompass.html#a75aaff7b480627c038a0810862606bf9">learn_allocated</a>) {</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <a class="code" href="classCompass.html#a75aaff7b480627c038a0810862606bf9">learn_allocated</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <a class="code" href="classCompass.html#a5a838bd25f13f41d428c10a8c44e965a">learn</a> = <span class="keyword">new</span> <a class="code" href="classCompass.html#a80e369bd0d6a5d30b78d933b219d327e">CompassLearn</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    }</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#a9a5653285eb6768ddfe8b7529ba12c03">_learn</a> == <a class="code" href="classCompass.html#a5ed931ce45b6449a63d57bb01fe5a0c9ac67e46a1613956b81acf80a37742c288">LEARN_INFLIGHT</a> &amp;&amp; <a class="code" href="classCompass.html#a5a838bd25f13f41d428c10a8c44e965a">learn</a> != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <a class="code" href="classCompass.html#a5a838bd25f13f41d428c10a8c44e965a">learn</a>-&gt;<a class="code" href="classCompassLearn.html#ac8ff1a868c253b5ae8bd434be2bc7e3d">update</a>();</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    }</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordtype">bool</span> ret = <a class="code" href="classCompass.html#a76b5ecbd5bd613d28b1172834d3a8db9">healthy</a>();</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">if</span> (ret &amp;&amp; <a class="code" href="classCompass.html#a068308f9242c606086b60416142e437b">_log_bit</a> != (uint32_t)-1 &amp;&amp; <a class="code" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().should_log(<a class="code" href="classCompass.html#a068308f9242c606086b60416142e437b">_log_bit</a>) &amp;&amp; !<a class="code" href="namespaceAP.html#a99432cfdb696952c9b7146f155a815aa">AP::ahrs</a>().have_ekf_logging()) {</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <a class="code" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().<a class="code" href="classAP__Logger.html#a3f48d1fc5f79a0c77ab1b7c36c661eb2">Write_Compass</a>();</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    }</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;}</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;uint8_t</div><div class="line"><a name="l00985"></a><span class="lineno"><a class="line" href="classCompass.html#a049567dd39f99577797beb087e41f13a">  985</a></span>&#160;<a class="code" href="classCompass.html#a049567dd39f99577797beb087e41f13a">Compass::get_healthy_mask</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    uint8_t healthy_mask = 0;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">for</span>(uint8_t i=0; i&lt;<a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; i++) {</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="classCompass.html#a76b5ecbd5bd613d28b1172834d3a8db9">healthy</a>(i)) {</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            healthy_mask |= 1 &lt;&lt; i;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        }</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">return</span> healthy_mask;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;}</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l00997"></a><span class="lineno"><a class="line" href="classCompass.html#a18ec405430e055e4a01912a8ca73cbc3">  997</a></span>&#160;<a class="code" href="classCompass.html#a18ec405430e055e4a01912a8ca73cbc3">Compass::set_offsets</a>(uint8_t i, <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;offsets)</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;{</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">// sanity check compass instance provided</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span> (i &lt; <a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>) {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#a3e2ff88eb37ae470b4c1b4b3c232305e">offset</a>.set(offsets);</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    }</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;}</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01006"></a><span class="lineno"><a class="line" href="classCompass.html#afeac6bcfad2650762cccda72dbce3e69"> 1006</a></span>&#160;<a class="code" href="classCompass.html#afeac6bcfad2650762cccda72dbce3e69">Compass::set_and_save_offsets</a>(uint8_t i, <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;offsets)</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;{</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="comment">// sanity check compass instance provided</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordflow">if</span> (i &lt; <a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>) {</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#a3e2ff88eb37ae470b4c1b4b3c232305e">offset</a>.set(offsets);</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <a class="code" href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">save_offsets</a>(i);</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    }</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01016"></a><span class="lineno"><a class="line" href="classCompass.html#ae581710aa79ddf7abce3b3893bb08ea5"> 1016</a></span>&#160;<a class="code" href="classCompass.html#ae581710aa79ddf7abce3b3893bb08ea5">Compass::set_and_save_diagonals</a>(uint8_t i, <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;diagonals)</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;{</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">// sanity check compass instance provided</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">if</span> (i &lt; <a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>) {</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#a50dc445d1c9b8ed874a7a7d7054737d2">diagonals</a>.set_and_save(diagonals);</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    }</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;}</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01025"></a><span class="lineno"><a class="line" href="classCompass.html#a6728a7129a64d973461b9d5eb95dc81a"> 1025</a></span>&#160;<a class="code" href="classCompass.html#a6728a7129a64d973461b9d5eb95dc81a">Compass::set_and_save_offdiagonals</a>(uint8_t i, <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;offdiagonals)</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;{</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="comment">// sanity check compass instance provided</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">if</span> (i &lt; <a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>) {</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#a4ac6e96bb0e028b4bad4faba7ecdb8c1">offdiagonals</a>.set_and_save(offdiagonals);</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    }</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;}</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01034"></a><span class="lineno"><a class="line" href="classCompass.html#a95f3b4686f214914703c321c9c8e9df2"> 1034</a></span>&#160;<a class="code" href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">Compass::save_offsets</a>(uint8_t i)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;{</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#a3e2ff88eb37ae470b4c1b4b3c232305e">offset</a>.save();  <span class="comment">// save offsets</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#afe6deabcf507751cd66c36639bb9dde0">dev_id</a>.set_and_save(<a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].detected_dev_id);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;}</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01041"></a><span class="lineno"><a class="line" href="classCompass.html#abfc394b43272d5a6e97001232e201b7f"> 1041</a></span>&#160;<a class="code" href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">Compass::save_offsets</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;{</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; i++) {</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        <a class="code" href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">save_offsets</a>(i);</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    }</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;}</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01049"></a><span class="lineno"><a class="line" href="classCompass.html#a307ba851d14fd2ac3b655227812f6b4d"> 1049</a></span>&#160;<a class="code" href="classCompass.html#a307ba851d14fd2ac3b655227812f6b4d">Compass::set_motor_compensation</a>(uint8_t i, <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;motor_comp_factor)</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;{</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#a90887b7c30ed529dc3fecfb36729f9d7">motor_compensation</a>.set(motor_comp_factor);</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;}</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01055"></a><span class="lineno"><a class="line" href="classCompass.html#adeefda110ce0a02edfb3d344d632777a"> 1055</a></span>&#160;<a class="code" href="classCompass.html#adeefda110ce0a02edfb3d344d632777a">Compass::save_motor_compensation</a>()</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;{</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <a class="code" href="classCompass.html#a53de8105fdd000b28afe20ced1b85d5a">_motor_comp_type</a>.save();</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">for</span> (uint8_t k=0; k&lt;<a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; k++) {</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[k].<a class="code" href="structCompass_1_1mag__state.html#a90887b7c30ed529dc3fecfb36729f9d7">motor_compensation</a>.save();</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;}</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01064"></a><span class="lineno"><a class="line" href="classCompass.html#a95d49517b12183412d9d0ed481b785bf"> 1064</a></span>&#160;<a class="code" href="classCompass.html#a95d49517b12183412d9d0ed481b785bf">Compass::set_initial_location</a>(int32_t latitude, int32_t longitude)</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;{</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">// if automatic declination is configured, then compute</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="comment">// the declination based on the initial GPS fix</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#a92a1e23d7ff2ade9024f2145e4e8d0a2">_auto_declination</a>) {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        <span class="comment">// Set the declination based on the lat/lng from GPS</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>.set(<a class="code" href="AP__Math_8h.html#a37d7c62a8231d9d22826261297b99da4">radians</a>(</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                <a class="code" href="classAP__Declination.html#ae3c4783226b79c64dc2c2be9180f9d6e">AP_Declination::get_declination</a>(</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                    (<span class="keywordtype">float</span>)latitude / 10000000,</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                    (<span class="keywordtype">float</span>)longitude / 10000000)));</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    }</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;}</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l01079"></a><span class="lineno"><a class="line" href="classCompass.html#a099bc37c6d1b03238c2efe39ea3b14d3"> 1079</a></span>&#160;<a class="code" href="classCompass.html#a099bc37c6d1b03238c2efe39ea3b14d3">Compass::use_for_yaw</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    uint8_t prim = <a class="code" href="classCompass.html#a514bab09cfbac818a417d2f989467ce6">get_primary</a>();</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#a76b5ecbd5bd613d28b1172834d3a8db9">healthy</a>(prim) &amp;&amp; <a class="code" href="classCompass.html#a099bc37c6d1b03238c2efe39ea3b14d3">use_for_yaw</a>(prim);</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;}</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l01087"></a><span class="lineno"><a class="line" href="classCompass.html#af5c3da7e49f681c1d7a0354b91eba7ba"> 1087</a></span>&#160;<a class="code" href="classCompass.html#a099bc37c6d1b03238c2efe39ea3b14d3">Compass::use_for_yaw</a>(uint8_t i)<span class="keyword"> const</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <span class="comment">// when we are doing in-flight compass learning the state</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="comment">// estimator must not use the compass. The learning code turns off</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="comment">// inflight learning when it has converged</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#a49545b0efc480dbab4a518321a708dc1">use_for_yaw</a> &amp;&amp; <a class="code" href="classCompass.html#a9a5653285eb6768ddfe8b7529ba12c03">_learn</a>.get() != <a class="code" href="classCompass.html#a5ed931ce45b6449a63d57bb01fe5a0c9ac67e46a1613956b81acf80a37742c288">LEARN_INFLIGHT</a>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;}</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01096"></a><span class="lineno"><a class="line" href="classCompass.html#ac3584d30eca4e60567613c1b09785505"> 1096</a></span>&#160;<a class="code" href="classCompass.html#ac3584d30eca4e60567613c1b09785505">Compass::set_declination</a>(<span class="keywordtype">float</span> <a class="code" href="AP__Math_8h.html#a37d7c62a8231d9d22826261297b99da4">radians</a>, <span class="keywordtype">bool</span> save_to_eeprom)</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;{</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="keywordflow">if</span> (save_to_eeprom) {</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>.set_and_save(<a class="code" href="AP__Math_8h.html#a37d7c62a8231d9d22826261297b99da4">radians</a>);</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>.set(<a class="code" href="AP__Math_8h.html#a37d7c62a8231d9d22826261297b99da4">radians</a>);</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    }</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;}</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="keywordtype">float</span></div><div class="line"><a name="l01106"></a><span class="lineno"><a class="line" href="classCompass.html#a4519009b6dc2e68c498903eb314c2a60"> 1106</a></span>&#160;<a class="code" href="classCompass.html#a4519009b6dc2e68c498903eb314c2a60">Compass::get_declination</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>.get();</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;}</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">  calculate a compass heading given the attitude from DCM and the mag vector</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="keywordtype">float</span></div><div class="line"><a name="l01115"></a><span class="lineno"><a class="line" href="classCompass.html#ad627397f365948397dd403ae14542b6f"> 1115</a></span>&#160;<a class="code" href="classCompass.html#a0005716f188963f3ac6494c2a5ce2e2c">Compass::calculate_heading</a>(<span class="keyword">const</span> <a class="code" href="classMatrix3.html">Matrix3f</a> &amp;dcm_matrix, uint8_t i)<span class="keyword"> const</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="keywordtype">float</span> cos_pitch_sq = 1.0f-(dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.x*dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.x);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="comment">// Tilt compensated magnetic field Y component:</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;    <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;<a class="code" href="classCompass.html#a0a8d322a3774f60f4c1577dad3ab016a">field</a> = <a class="code" href="classCompass.html#a0c912ceffee8c65420fe9e39841fb4ba">get_field</a>(i);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    <span class="keywordtype">float</span> headY = <a class="code" href="classCompass.html#a0a8d322a3774f60f4c1577dad3ab016a">field</a>.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> * dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.z - <a class="code" href="classCompass.html#a0a8d322a3774f60f4c1577dad3ab016a">field</a>.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> * dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.y;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="comment">// Tilt compensated magnetic field X component:</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <span class="keywordtype">float</span> headX = <a class="code" href="classCompass.html#a0a8d322a3774f60f4c1577dad3ab016a">field</a>.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a> * cos_pitch_sq - dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.x * (<a class="code" href="classCompass.html#a0a8d322a3774f60f4c1577dad3ab016a">field</a>.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a> * dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.y + <a class="code" href="classCompass.html#a0a8d322a3774f60f4c1577dad3ab016a">field</a>.<a class="code" href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">z</a> * dcm_matrix.<a class="code" href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">c</a>.z);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">// magnetic heading</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="comment">// 6/4/11 - added constrain to keep bad values from ruining DCM Yaw - Jason S.</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    <span class="keywordtype">float</span> heading = <a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(atan2f(-headY,headX), -3.15<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>, 3.15<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="comment">// Declination correction (if supplied)</span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="keywordflow">if</span>( fabsf(<a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>) &gt; 0.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a> )</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    {</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        heading = heading + <a class="code" href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">_declination</a>;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="keywordflow">if</span> (heading &gt; <a class="code" href="definitions_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>)    <span class="comment">// Angle normalization (-180 deg, 180 deg)</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            heading -= (2.0f * <a class="code" href="definitions_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (heading &lt; -<a class="code" href="definitions_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>)</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            heading += (2.0f * <a class="code" href="definitions_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    }</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordflow">return</span> heading;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;}</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"><a class="line" href="classCompass.html#a59622e8195dc29485f24d7c27a9cf7f0"> 1148</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classCompass.html#a1479c75532bc97308b1c698b67cf9bcc">Compass::configured</a>(uint8_t i)</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;{</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">// exit immediately if instance is beyond the number of compasses we have available</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span> (i &gt; <a class="code" href="classCompass.html#aab02220a8209d664f89f2be9050cf283">get_count</a>()) {</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    }</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="comment">// exit immediately if all offsets are zero</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a>(<a class="code" href="classCompass.html#ad53097ca1e4da92a4315ccfaa76f88f0">get_offsets</a>(i).length())) {</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    }</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// exit immediately if dev_id hasn&#39;t been detected</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].detected_dev_id == 0) {</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    }</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="comment">// back up cached value of dev_id</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    int32_t dev_id_cache_value = <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#afe6deabcf507751cd66c36639bb9dde0">dev_id</a>;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="comment">// load dev_id from eeprom</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#afe6deabcf507751cd66c36639bb9dde0">dev_id</a>.load();</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="comment">// if dev_id loaded from eeprom is different from detected dev id or dev_id loaded from eeprom is different from cached dev_id, compass is unconfigured</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].dev_id != <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].detected_dev_id || <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].dev_id != dev_id_cache_value) {</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        <span class="comment">// restore cached value</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;        <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].<a class="code" href="structCompass_1_1mag__state.html#afe6deabcf507751cd66c36639bb9dde0">dev_id</a> = dev_id_cache_value;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="comment">// return failure</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    }</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="comment">// if expected_dev_id is configured and the detected dev_id is different, return false</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].expected_dev_id != -1 &amp;&amp; <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].expected_dev_id != <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[i].dev_id) {</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="comment">// if we got here then it must be configured</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;}</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;</div><div class="line"><a name="l01188"></a><span class="lineno"><a class="line" href="classCompass.html#a1479c75532bc97308b1c698b67cf9bcc"> 1188</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classCompass.html#a1479c75532bc97308b1c698b67cf9bcc">Compass::configured</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;{</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordtype">bool</span> all_configured = <span class="keyword">true</span>;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <span class="keywordflow">for</span>(uint8_t i=0; i&lt;<a class="code" href="classCompass.html#aab02220a8209d664f89f2be9050cf283">get_count</a>(); i++) {</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        all_configured = all_configured &amp;&amp; (!<a class="code" href="classCompass.html#a099bc37c6d1b03238c2efe39ea3b14d3">use_for_yaw</a>(i) || <a class="code" href="classCompass.html#a1479c75532bc97308b1c698b67cf9bcc">configured</a>(i));</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    }</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">return</span> all_configured;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;}</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="comment">// Update raw magnetometer values from HIL data</span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01199"></a><span class="lineno"><a class="line" href="classCompass.html#a30a8fa22b1e7ee8eec8143732d40716d"> 1199</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#a30a8fa22b1e7ee8eec8143732d40716d">Compass::setHIL</a>(uint8_t <a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keywordtype">float</span> roll, <span class="keywordtype">float</span> pitch, <span class="keywordtype">float</span> yaw)</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;{</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <a class="code" href="classMatrix3.html">Matrix3f</a> R;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="comment">// create a rotation matrix for the given attitude</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    R.<a class="code" href="classMatrix3.html#a62587bd216436f09f06b9e1330f84bc0">from_euler</a>(roll, pitch, yaw);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="AP__Math_8cpp.html#accbd9f8bbc0adacd51efa66fad490c24">is_equal</a>(<a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.last_declination,<a class="code" href="classCompass.html#a4519009b6dc2e68c498903eb314c2a60">get_declination</a>())) {</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <a class="code" href="classCompass.html#a0bc30e897c2c0c412120e1b1337bd1cb">_setup_earth_field</a>();</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.last_declination = <a class="code" href="classCompass.html#a4519009b6dc2e68c498903eb314c2a60">get_declination</a>();</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    }</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="comment">// convert the earth frame magnetic vector to body frame, and</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">// apply the offsets</span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.field[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] = R.<a class="code" href="classMatrix3.html#a212a94e2a9c26def827fa766f4d0ae3e">mul_transpose</a>(<a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.Bearth);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="comment">// apply default board orientation for this compass type. This is</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">// a noop on most boards</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.field[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].rotate(MAG_BOARD_ORIENTATION);</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">// add user selectable orientation</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.field[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].rotate((<span class="keyword">enum</span> <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681">Rotation</a>)<a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[0].orientation.get());</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[0].external) {</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="comment">// and add in AHRS_ORIENTATION setting if not an external compass</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#a1d376552464c5c5792326561d063ef7e">_board_orientation</a> == <a class="code" href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a621932380092e03bd929b22f6a1945ed">ROTATION_CUSTOM</a> &amp;&amp; <a class="code" href="classCompass.html#a6160258284468dbb348c158f1863f960">_custom_rotation</a>) {</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.field[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] = *<a class="code" href="classCompass.html#a6160258284468dbb348c158f1863f960">_custom_rotation</a> * <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.field[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>];</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;            <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.field[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].rotate(<a class="code" href="classCompass.html#a1d376552464c5c5792326561d063ef7e">_board_orientation</a>);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;    }</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.healthy[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] = <span class="keyword">true</span>;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;}</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="comment">// Update raw magnetometer values from HIL mag vector</span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l01235"></a><span class="lineno"><a class="line" href="classCompass.html#a0355bade37307056e2463a695a83302a"> 1235</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#a30a8fa22b1e7ee8eec8143732d40716d">Compass::setHIL</a>(uint8_t <a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>, <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;mag, uint32_t update_usec)</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;{</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.field[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] = mag;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.healthy[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>] = <span class="keyword">true</span>;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <a class="code" href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">_state</a>[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>].<a class="code" href="structCompass_1_1mag__state.html#a20f1d85ff86dee5b9bf492b51013e31b">last_update_usec</a> = update_usec;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;}</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;</div><div class="line"><a name="l01242"></a><span class="lineno"><a class="line" href="classCompass.html#a4e9a565e5c381153bf6e5f3468d787e1"> 1242</a></span>&#160;<span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a>&amp; <a class="code" href="classCompass.html#a4e9a565e5c381153bf6e5f3468d787e1">Compass::getHIL</a>(uint8_t <a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>)<span class="keyword"> const</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.field[<a class="code" href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a>];</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;}</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">// setup _Bearth</span></div><div class="line"><a name="l01248"></a><span class="lineno"><a class="line" href="classCompass.html#a0bc30e897c2c0c412120e1b1337bd1cb"> 1248</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#a0bc30e897c2c0c412120e1b1337bd1cb">Compass::_setup_earth_field</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;{</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    <span class="comment">// assume a earth field strength of 400</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.Bearth(400, 0, 0);</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    <span class="comment">// rotate _Bearth for inclination and declination. -66 degrees</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <span class="comment">// is the inclination in Canberra, Australia</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <a class="code" href="classMatrix3.html">Matrix3f</a> R;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    R.<a class="code" href="classMatrix3.html#a62587bd216436f09f06b9e1330f84bc0">from_euler</a>(0, <a class="code" href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a>(66), <a class="code" href="classCompass.html#a4519009b6dc2e68c498903eb314c2a60">get_declination</a>());</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.Bearth = R * <a class="code" href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">_hil</a>.Bearth;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;}</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">  set the type of motor compensation to use</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01263"></a><span class="lineno"><a class="line" href="classCompass.html#ad897fd4be9dd67a65343465614629568"> 1263</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCompass.html#ad897fd4be9dd67a65343465614629568">Compass::motor_compensation_type</a>(<span class="keyword">const</span> uint8_t comp_type)</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;{</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCompass.html#a53de8105fdd000b28afe20ced1b85d5a">_motor_comp_type</a> &lt;= <a class="code" href="AP__Compass_8h.html#aa22be79a45fb28cb3160eacdf5ad4432">AP_COMPASS_MOT_COMP_CURRENT</a> &amp;&amp; <a class="code" href="classCompass.html#a53de8105fdd000b28afe20ced1b85d5a">_motor_comp_type</a> != (int8_t)comp_type) {</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        <a class="code" href="classCompass.html#a53de8105fdd000b28afe20ced1b85d5a">_motor_comp_type</a> = (int8_t)comp_type;</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        <a class="code" href="classCompass.html#a27440d8cc0751bd27d9dfd4ba9f17957">_thr</a> = 0; <span class="comment">// set current  throttle to zero</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code" href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a>; i++) {</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            <a class="code" href="classCompass.html#a307ba851d14fd2ac3b655227812f6b4d">set_motor_compensation</a>(i, <a class="code" href="vector3_8h.html#af345ad77ba5e240c7ab72b4b2077e754">Vector3f</a>(0,0,0)); <span class="comment">// clear out invalid compensation vectors</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        }</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    }</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;}</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;</div><div class="line"><a name="l01274"></a><span class="lineno"><a class="line" href="classCompass.html#af8d0469972b7da6464a0d91e20715082"> 1274</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classCompass.html#af8d0469972b7da6464a0d91e20715082">Compass::consistent</a>()<span class="keyword"> const</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;    <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> &amp;primary_mag_field = <a class="code" href="classCompass.html#a0c912ceffee8c65420fe9e39841fb4ba">get_field</a>();</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="keyword">const</span> <a class="code" href="structVector2.html">Vector2f</a> primary_mag_field_xy = <a class="code" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(primary_mag_field.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>,primary_mag_field.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;    <span class="keywordflow">if</span> (primary_mag_field_xy.<a class="code" href="structVector2.html#a5b404e32377ce01e7ef2039151faaf08">is_zero</a>()) {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    }</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keyword">const</span> <a class="code" href="classVector3.html">Vector3f</a> primary_mag_field_norm = primary_mag_field.<a class="code" href="classVector3.html#ac41bad1b2f43442abc3b7d4c6909f2a9">normalized</a>();</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keyword">const</span> <a class="code" href="structVector2.html">Vector2f</a> primary_mag_field_xy_norm = primary_mag_field_xy.<a class="code" href="structVector2.html#aa78ff4778f55bf9c1ba9a10830fc0b89">normalized</a>();</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code" href="classCompass.html#aab02220a8209d664f89f2be9050cf283">get_count</a>(); i++) {</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classCompass.html#a099bc37c6d1b03238c2efe39ea3b14d3">use_for_yaw</a>(i)) {</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            <span class="comment">// configured not-to-be-used</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        }</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <a class="code" href="classVector3.html">Vector3f</a> mag_field = <a class="code" href="classCompass.html#a0c912ceffee8c65420fe9e39841fb4ba">get_field</a>(i);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <a class="code" href="structVector2.html">Vector2f</a> mag_field_xy = <a class="code" href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a>(mag_field.<a class="code" href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">x</a>,mag_field.<a class="code" href="classVector3.html#a561df88b28e106e337a25bb86554a569">y</a>);</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">if</span> (mag_field_xy.<a class="code" href="structVector2.html#a5b404e32377ce01e7ef2039151faaf08">is_zero</a>()) {</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;        }</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> xy_len_diff  = (primary_mag_field_xy-mag_field_xy).length();</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        mag_field.<a class="code" href="classVector3.html#a9b147a862a1b86ed2e5b735d19da3da1">normalize</a>();</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        mag_field_xy.<a class="code" href="structVector2.html#ace2a626eaa79412e2946216e9c3e63c6">normalize</a>();</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> xyz_ang_diff = acosf(<a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(mag_field*primary_mag_field_norm,-1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>,1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>));</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">float</span> xy_ang_diff  = acosf(<a class="code" href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a>(mag_field_xy*primary_mag_field_xy_norm,-1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>,1.0<a class="code" href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a>));</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="comment">// check for gross misalignment on all axes</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        <span class="keywordflow">if</span> (xyz_ang_diff &gt; <a class="code" href="AP__Compass_8h.html#a55cc3f7c59fe257f8926d02f8462aa20">AP_COMPASS_MAX_XYZ_ANG_DIFF</a>) {</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        }</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="comment">// check for an unacceptable angle difference on the xy plane</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">if</span> (xy_ang_diff &gt; <a class="code" href="AP__Compass_8h.html#a8bc3b9dad383e949bb7a78683f027132">AP_COMPASS_MAX_XY_ANG_DIFF</a>) {</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <span class="comment">// check for an unacceptable length difference on the xy plane</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="keywordflow">if</span> (xy_len_diff &gt; <a class="code" href="AP__Compass_8h.html#a062f390a5503097ca313e53f277d1f64">AP_COMPASS_MAX_XY_LENGTH_DIFF</a>) {</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        }</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    }</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;}</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment">// singleton instance</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<a class="code" href="classCompass.html">Compass</a> *<a class="code" href="classCompass.html#aa3e1ccaef661d5ff5d2e51cd7742c6ba">Compass::_singleton</a>;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceAP.html">AP</a> {</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"><a class="line" href="namespaceAP.html#ab9d0bcbec954b6c20abd8e13e6de7356"> 1331</a></span>&#160;<a class="code" href="classCompass.html">Compass</a> &amp;<a class="code" href="namespaceAP.html#ab9d0bcbec954b6c20abd8e13e6de7356">compass</a>()</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;{</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="keywordflow">return</span> *<a class="code" href="classCompass.html#af51dbdeb1147a5a8b5533bae6bd64e7a">Compass::get_singleton</a>();</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;}</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;}</div><div class="ttc" id="classAP__HAL_1_1Device_html_a368ef415e1e4efed7c05a48456a0ae83"><div class="ttname"><a href="classAP__HAL_1_1Device.html#a368ef415e1e4efed7c05a48456a0ae83">AP_HAL::Device::make_bus_id</a></div><div class="ttdeci">static uint32_t make_bus_id(enum BusType bus_type, uint8_t bus, uint8_t address, uint8_t devtype)</div><div class="ttdef"><b>Definition:</b> <a href="Device_8h_source.html#l00233">Device.h:233</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19ad69cd8acf903e732a7c58992df756cd7"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19ad69cd8acf903e732a7c58992df756cd7">Compass::DRIVER_LSM303D</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00361">AP_Compass.h:361</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_ad12e4054ec35030309b98a799e9f0df4"><div class="ttname"><a href="structCompass_1_1mag__state.html#ad12e4054ec35030309b98a799e9f0df4">Compass::mag_state::healthy</a></div><div class="ttdeci">bool healthy</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00427">AP_Compass.h:427</a></div></div>
<div class="ttc" id="classCompass_html_af1b5ea3ff42b02e04526d4be361a1ca1"><div class="ttname"><a href="classCompass.html#af1b5ea3ff42b02e04526d4be361a1ca1">Compass::register_compass</a></div><div class="ttdeci">uint8_t register_compass(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00547">AP_Compass.cpp:547</a></div></div>
<div class="ttc" id="classCompass_html_a92a1e23d7ff2ade9024f2145e4e8d0a2"><div class="ttname"><a href="classCompass.html#a92a1e23d7ff2ade9024f2145e4e8d0a2">Compass::_auto_declination</a></div><div class="ttdeci">AP_Int8 _auto_declination</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00404">AP_Compass.h:404</a></div></div>
<div class="ttc" id="classCompass_html_a32fb8b55b7ee1c439e7c42ce2c02f5eb"><div class="ttname"><a href="classCompass.html#a32fb8b55b7ee1c439e7c42ce2c02f5eb">Compass::_have_i2c_driver</a></div><div class="ttdeci">bool _have_i2c_driver(uint8_t bus_num, uint8_t address) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00582">AP_Compass.cpp:582</a></div></div>
<div class="ttc" id="classCompass_html_a2e8b43d6582576f5a032998f3db0448f"><div class="ttname"><a href="classCompass.html#a2e8b43d6582576f5a032998f3db0448f">Compass::enabled</a></div><div class="ttdeci">bool enabled() const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00078">AP_Compass.h:78</a></div></div>
<div class="ttc" id="AP__Compass__IST8308_8h_html_a3ceac9a4a67efd3aa707dce7a6d55281"><div class="ttname"><a href="AP__Compass__IST8308_8h.html#a3ceac9a4a67efd3aa707dce7a6d55281">HAL_COMPASS_IST8308_I2C_ADDR</a></div><div class="ttdeci">#define HAL_COMPASS_IST8308_I2C_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__IST8308_8h_source.html#l00028">AP_Compass_IST8308.h:28</a></div></div>
<div class="ttc" id="AP__Compass__HMC5843_8h_html"><div class="ttname"><a href="AP__Compass__HMC5843_8h.html">AP_Compass_HMC5843.h</a></div></div>
<div class="ttc" id="namespaceAP_html_ab9d0bcbec954b6c20abd8e13e6de7356"><div class="ttname"><a href="namespaceAP.html#ab9d0bcbec954b6c20abd8e13e6de7356">AP::compass</a></div><div class="ttdeci">Compass &amp; compass()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01331">AP_Compass.cpp:1331</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983aa765b43df6cbdb15f9720f993d79ceb3"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983aa765b43df6cbdb15f9720f993d79ceb3">AP_BoardConfig::PX4_BOARD_PIXHAWK</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00068">AP_BoardConfig.h:68</a></div></div>
<div class="ttc" id="AP__Compass__AK09916_8h_html_abfe14523e6aac1631ce4430716b927db"><div class="ttname"><a href="AP__Compass__AK09916_8h.html#abfe14523e6aac1631ce4430716b927db">HAL_COMPASS_ICM20948_I2C_ADDR</a></div><div class="ttdeci">#define HAL_COMPASS_ICM20948_I2C_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__AK09916_8h_source.html#l00031">AP_Compass_AK09916.h:31</a></div></div>
<div class="ttc" id="AP__Compass__IST8310_8h_html_a008c10b66a4077acc3a610c41291773b"><div class="ttname"><a href="AP__Compass__IST8310_8h.html#a008c10b66a4077acc3a610c41291773b">HAL_COMPASS_IST8310_I2C_ADDR</a></div><div class="ttdeci">#define HAL_COMPASS_IST8310_I2C_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__IST8310_8h_source.html#l00028">AP_Compass_IST8310.h:28</a></div></div>
<div class="ttc" id="vector2_8h_html_a9f3739462b0605dcb64299fa289b6afe"><div class="ttname"><a href="vector2_8h.html#a9f3739462b0605dcb64299fa289b6afe">Vector2f</a></div><div class="ttdeci">Vector2&lt; float &gt; Vector2f</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8h_source.html#l00260">vector2.h:260</a></div></div>
<div class="ttc" id="AP__Compass_8cpp_html_abbd00be969534e4587e3479da3759384"><div class="ttname"><a href="AP__Compass_8cpp.html#abbd00be969534e4587e3479da3759384">COMPASS_LEARN_DEFAULT</a></div><div class="ttdeci">#define COMPASS_LEARN_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00036">AP_Compass.cpp:36</a></div></div>
<div class="ttc" id="classCompass_html_a68bd2a073cc0d461b2b46529aae04765"><div class="ttname"><a href="classCompass.html#a68bd2a073cc0d461b2b46529aae04765">Compass::Compass</a></div><div class="ttdeci">Compass()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00495">AP_Compass.cpp:495</a></div></div>
<div class="ttc" id="AP__Compass_8cpp_html_a603431ff967752376822ef02ccd506a4"><div class="ttname"><a href="AP__Compass_8cpp.html#a603431ff967752376822ef02ccd506a4">hal</a></div><div class="ttdeci">AP_HAL::HAL &amp; hal</div><div class="ttdef"><b>Definition:</b> <a href="AC__PID__test_8cpp_source.html#l00021">AC_PID_test.cpp:21</a></div></div>
<div class="ttc" id="AP__Compass__QMC5883L_8h_html_a53ec2f60b031c276dc75bb835a27ba5a"><div class="ttname"><a href="AP__Compass__QMC5883L_8h.html#a53ec2f60b031c276dc75bb835a27ba5a">HAL_COMPASS_QMC5883L_ORIENTATION_EXTERNAL</a></div><div class="ttdeci">#define HAL_COMPASS_QMC5883L_ORIENTATION_EXTERNAL</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__QMC5883L_8h_source.html#l00035">AP_Compass_QMC5883L.h:35</a></div></div>
<div class="ttc" id="classAP__AHRS_html_a6902570304ec8a9d38c57e5b053e6d0a"><div class="ttname"><a href="classAP__AHRS.html#a6902570304ec8a9d38c57e5b053e6d0a">AP_AHRS::set_compass</a></div><div class="ttdeci">void set_compass(Compass *compass)</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8h_source.html#l00143">AP_AHRS.h:143</a></div></div>
<div class="ttc" id="classCompass_html_a766d77e1b78dc08be50ba76994c8b4ab"><div class="ttname"><a href="classCompass.html#a766d77e1b78dc08be50ba76994c8b4ab">Compass::_probe_external_i2c_compasses</a></div><div class="ttdeci">void _probe_external_i2c_compasses(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00611">AP_Compass.cpp:611</a></div></div>
<div class="ttc" id="AP__Logger_8h_html_a88b4cdb83aeee0d38a55b8194381057fab513c44a4d8c00922c7155d8a90dfde5"><div class="ttname"><a href="AP__Logger_8h.html#a88b4cdb83aeee0d38a55b8194381057fab513c44a4d8c00922c7155d8a90dfde5">LogErrorSubsystem::COMPASS</a></div></div>
<div class="ttc" id="AP__Compass_8h_html_a55cc3f7c59fe257f8926d02f8462aa20"><div class="ttname"><a href="AP__Compass_8h.html#a55cc3f7c59fe257f8926d02f8462aa20">AP_COMPASS_MAX_XYZ_ANG_DIFF</a></div><div class="ttdeci">#define AP_COMPASS_MAX_XYZ_ANG_DIFF</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00037">AP_Compass.h:37</a></div></div>
<div class="ttc" id="vector3_8h_html_af345ad77ba5e240c7ab72b4b2077e754"><div class="ttname"><a href="vector3_8h.html#af345ad77ba5e240c7ab72b4b2077e754">Vector3f</a></div><div class="ttdeci">Vector3&lt; float &gt; Vector3f</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00252">vector3.h:252</a></div></div>
<div class="ttc" id="AP__Compass__QMC5883L_8h_html_a620cedda01ad03d53443edb4a0131d88"><div class="ttname"><a href="AP__Compass__QMC5883L_8h.html#a620cedda01ad03d53443edb4a0131d88">HAL_COMPASS_QMC5883L_ORIENTATION_INTERNAL</a></div><div class="ttdeci">#define HAL_COMPASS_QMC5883L_ORIENTATION_INTERNAL</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__QMC5883L_8h_source.html#l00039">AP_Compass_QMC5883L.h:39</a></div></div>
<div class="ttc" id="AP__Compass_8h_html_aea476312c9a32f19ab3a0d62f4027869"><div class="ttname"><a href="AP__Compass_8h.html#aea476312c9a32f19ab3a0d62f4027869">AP_COMPASS_MOT_COMP_DISABLED</a></div><div class="ttdeci">#define AP_COMPASS_MOT_COMP_DISABLED</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00017">AP_Compass.h:17</a></div></div>
<div class="ttc" id="classAP__Compass__AK09916_html_a3dc547853733f3261ff83a6051a4684b"><div class="ttname"><a href="classAP__Compass__AK09916.html#a3dc547853733f3261ff83a6051a4684b">AP_Compass_AK09916::probe_ICM20948</a></div><div class="ttdeci">static AP_Compass_Backend * probe_ICM20948(AP_HAL::OwnPtr&lt; AP_HAL::I2CDevice &gt; dev, AP_HAL::OwnPtr&lt; AP_HAL::I2CDevice &gt; dev_icm, bool force_external, enum Rotation rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__AK09916_8cpp_source.html#l00096">AP_Compass_AK09916.cpp:96</a></div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681aeb81d9199def1f929a5e5798d37c49c5"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681aeb81d9199def1f929a5e5798d37c49c5">ROTATION_ROLL_180</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00036">rotations.h:36</a></div></div>
<div class="ttc" id="I2CDevice_8h_html_ad421e4346d33acf4c95a34a807dc531b"><div class="ttname"><a href="I2CDevice_8h.html#ad421e4346d33acf4c95a34a807dc531b">FOREACH_I2C_INTERNAL</a></div><div class="ttdeci">#define FOREACH_I2C_INTERNAL(i)</div><div class="ttdef"><b>Definition:</b> <a href="I2CDevice_8h_source.html#l00114">I2CDevice.h:114</a></div></div>
<div class="ttc" id="AP__Compass__MMC3416_8h_html"><div class="ttname"><a href="AP__Compass__MMC3416_8h.html">AP_Compass_MMC3416.h</a></div></div>
<div class="ttc" id="AP__Compass__BMM150_8h_html"><div class="ttname"><a href="AP__Compass__BMM150_8h.html">AP_Compass_BMM150.h</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Device_html_a663eff6026e905d17cbfa61853f8b032"><div class="ttname"><a href="classAP__HAL_1_1Device.html#a663eff6026e905d17cbfa61853f8b032">AP_HAL::Device::change_bus_id</a></div><div class="ttdeci">static uint32_t change_bus_id(uint32_t old_id, uint8_t devtype)</div><div class="ttdef"><b>Definition:</b> <a href="Device_8h_source.html#l00246">Device.h:246</a></div></div>
<div class="ttc" id="classAP__Compass__LSM303D_html_a1633f14eb14b05dd82600ce9cc7827ec"><div class="ttname"><a href="classAP__Compass__LSM303D.html#a1633f14eb14b05dd82600ce9cc7827ec">AP_Compass_LSM303D::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::Device &gt; dev, enum Rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__LSM303D_8cpp_source.html#l00158">AP_Compass_LSM303D.cpp:158</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a8a3185c191ab40fd95ceeadd8a5b0cf9"><div class="ttname"><a href="classAP__BoardConfig.html#a8a3185c191ab40fd95ceeadd8a5b0cf9">AP_BoardConfig::get_board_type</a></div><div class="ttdeci">static enum px4_board_type get_board_type(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00094">AP_BoardConfig.h:94</a></div></div>
<div class="ttc" id="classCompass_html_a4519009b6dc2e68c498903eb314c2a60"><div class="ttname"><a href="classCompass.html#a4519009b6dc2e68c498903eb314c2a60">Compass::get_declination</a></div><div class="ttdeci">float get_declination() const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01106">AP_Compass.cpp:1106</a></div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681a869e0e4a85746c9248e03bb2f1ad0229"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a869e0e4a85746c9248e03bb2f1ad0229">ROTATION_PITCH_180_YAW_90</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00054">rotations.h:54</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a20f1d85ff86dee5b9bf492b51013e31b"><div class="ttname"><a href="structCompass_1_1mag__state.html#a20f1d85ff86dee5b9bf492b51013e31b">Compass::mag_state::last_update_usec</a></div><div class="ttdeci">uint32_t last_update_usec</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00456">AP_Compass.h:456</a></div></div>
<div class="ttc" id="classCompass_html_aa2db70e5e7eb6b25d70550322849b862"><div class="ttname"><a href="classCompass.html#aa2db70e5e7eb6b25d70550322849b862">Compass::_driver_type_mask</a></div><div class="ttdeci">AP_Int32 _driver_type_mask</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00479">AP_Compass.h:479</a></div></div>
<div class="ttc" id="classCompass_html_af51dbdeb1147a5a8b5533bae6bd64e7a"><div class="ttname"><a href="classCompass.html#af51dbdeb1147a5a8b5533bae6bd64e7a">Compass::get_singleton</a></div><div class="ttdeci">static Compass * get_singleton()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00061">AP_Compass.h:61</a></div></div>
<div class="ttc" id="AP__Compass__LIS3MDL_8h_html"><div class="ttname"><a href="AP__Compass__LIS3MDL_8h.html">AP_Compass_LIS3MDL.h</a></div></div>
<div class="ttc" id="classVector3_html_ac41bad1b2f43442abc3b7d4c6909f2a9"><div class="ttname"><a href="classVector3.html#ac41bad1b2f43442abc3b7d4c6909f2a9">Vector3::normalized</a></div><div class="ttdeci">Vector3&lt; T &gt; normalized() const</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00194">vector3.h:194</a></div></div>
<div class="ttc" id="classCompass_html_a9a5653285eb6768ddfe8b7529ba12c03"><div class="ttname"><a href="classCompass.html#a9a5653285eb6768ddfe8b7529ba12c03">Compass::_learn</a></div><div class="ttdeci">AP_Int8 _learn</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00391">AP_Compass.h:391</a></div></div>
<div class="ttc" id="AP__HAL_8h_html"><div class="ttname"><a href="AP__HAL_8h.html">AP_HAL.h</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a92168462febe0f5ab9556dc9ea4ddb7a"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a92168462febe0f5ab9556dc9ea4ddb7a">AP_HAL::HAL::console</a></div><div class="ttdeci">AP_HAL::UARTDriver * console</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00110">HAL.h:110</a></div></div>
<div class="ttc" id="classCompass_html_a678ad037acc44e46598012b7ad17b2a6"><div class="ttname"><a href="classCompass.html#a678ad037acc44e46598012b7ad17b2a6">Compass::_driver_enabled</a></div><div class="ttdeci">bool _driver_enabled(enum DriverType driver_type)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00573">AP_Compass.cpp:573</a></div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3c485d0686ff0555d4db0c22959f9dec">ROTATION_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00028">rotations.h:28</a></div></div>
<div class="ttc" id="classAP__Compass__Backend_html"><div class="ttname"><a href="classAP__Compass__Backend.html">AP_Compass_Backend</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__Backend_8h_source.html#l00025">AP_Compass_Backend.h:25</a></div></div>
<div class="ttc" id="classCompass_html_a6728a7129a64d973461b9d5eb95dc81a"><div class="ttname"><a href="classCompass.html#a6728a7129a64d973461b9d5eb95dc81a">Compass::set_and_save_offdiagonals</a></div><div class="ttdeci">void set_and_save_offdiagonals(uint8_t i, const Vector3f &amp;diagonals)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01025">AP_Compass.cpp:1025</a></div></div>
<div class="ttc" id="classAP__Compass__LSM9DS1_html_ac01f0980025641d338f9cfbf09b08ed9"><div class="ttname"><a href="classAP__Compass__LSM9DS1.html#ac01f0980025641d338f9cfbf09b08ed9">AP_Compass_LSM9DS1::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::Device &gt; dev, enum Rotation rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__LSM9DS1_8cpp_source.html#l00067">AP_Compass_LSM9DS1.cpp:67</a></div></div>
<div class="ttc" id="AP__HAL__Boards_8h_html_a51869742d3196f59f9e5e323f9d6c11b"><div class="ttname"><a href="AP__HAL__Boards_8h.html#a51869742d3196f59f9e5e323f9d6c11b">HAL_COMPASS_HMC5843_I2C_ADDR</a></div><div class="ttdeci">#define HAL_COMPASS_HMC5843_I2C_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="AP__HAL__Boards_8h_source.html#l00192">AP_HAL_Boards.h:192</a></div></div>
<div class="ttc" id="classCompass_html_ad53097ca1e4da92a4315ccfaa76f88f0"><div class="ttname"><a href="classCompass.html#ad53097ca1e4da92a4315ccfaa76f88f0">Compass::get_offsets</a></div><div class="ttdeci">const Vector3f &amp; get_offsets(void) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00169">AP_Compass.h:169</a></div></div>
<div class="ttc" id="classCompass_html_a80e369bd0d6a5d30b78d933b219d327e"><div class="ttname"><a href="classCompass.html#a80e369bd0d6a5d30b78d933b219d327e">Compass::CompassLearn</a></div><div class="ttdeci">friend class CompassLearn</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00065">AP_Compass.h:65</a></div></div>
<div class="ttc" id="AP__Common_8h_html_a728f9499baea61e7df3ae70a374f2512"><div class="ttname"><a href="AP__Common_8h.html#a728f9499baea61e7df3ae70a374f2512">ToRad</a></div><div class="ttdeci">#define ToRad(x)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Common_8h_source.html#l00063">AP_Common.h:63</a></div></div>
<div class="ttc" id="I2CDevice_8h_html_a09f11b4bf995e11cb0b54264fa1b831c"><div class="ttname"><a href="I2CDevice_8h.html#a09f11b4bf995e11cb0b54264fa1b831c">FOREACH_I2C_EXTERNAL</a></div><div class="ttdeci">#define FOREACH_I2C_EXTERNAL(i)</div><div class="ttdef"><b>Definition:</b> <a href="I2CDevice_8h_source.html#l00113">I2CDevice.h:113</a></div></div>
<div class="ttc" id="classCompass_html_a30a8fa22b1e7ee8eec8143732d40716d"><div class="ttname"><a href="classCompass.html#a30a8fa22b1e7ee8eec8143732d40716d">Compass::setHIL</a></div><div class="ttdeci">void setHIL(uint8_t instance, float roll, float pitch, float yaw)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01199">AP_Compass.cpp:1199</a></div></div>
<div class="ttc" id="AP__Compass__QMC5883L_8h_html"><div class="ttname"><a href="AP__Compass__QMC5883L_8h.html">AP_Compass_QMC5883L.h</a></div></div>
<div class="ttc" id="chibios_8h_html_a2c59d23ab6be2e59b18f06e2431e5dbb"><div class="ttname"><a href="chibios_8h.html#a2c59d23ab6be2e59b18f06e2431e5dbb">HAL_INS_LSM9DS0_A_NAME</a></div><div class="ttdeci">#define HAL_INS_LSM9DS0_A_NAME</div><div class="ttdef"><b>Definition:</b> <a href="chibios_8h_source.html#l00064">chibios.h:64</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983aa4b366ff17e0c44076231ae8c51edd42"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983aa4b366ff17e0c44076231ae8c51edd42">AP_BoardConfig::PX4_BOARD_PHMINI</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00071">AP_BoardConfig.h:71</a></div></div>
<div class="ttc" id="classCompass_html_a27440d8cc0751bd27d9dfd4ba9f17957"><div class="ttname"><a href="classCompass.html#a27440d8cc0751bd27d9dfd4ba9f17957">Compass::_thr</a></div><div class="ttdeci">float _thr</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00423">AP_Compass.h:423</a></div></div>
<div class="ttc" id="AP__Compass__IST8310_8h_html"><div class="ttname"><a href="AP__Compass__IST8310_8h.html">AP_Compass_IST8310.h</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19abcf97e88fc61f03836406f3920d4f2ff"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19abcf97e88fc61f03836406f3920d4f2ff">Compass::DRIVER_SITL</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00372">AP_Compass.h:372</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19aefd4c56c784bb6ccfcaea5a6f8cbcda1"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19aefd4c56c784bb6ccfcaea5a6f8cbcda1">Compass::DRIVER_IST8308</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00374">AP_Compass.h:374</a></div></div>
<div class="ttc" id="AP__Compass_8cpp_html_abd241224760f1a380278880c2908a112"><div class="ttname"><a href="AP__Compass_8cpp.html#abd241224760f1a380278880c2908a112">HAL_COMPASS_AUTO_ROT_DEFAULT</a></div><div class="ttdeci">#define HAL_COMPASS_AUTO_ROT_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00048">AP_Compass.cpp:48</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19a8fe2c5923dcfbef2601751ddfa48f2fc"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a8fe2c5923dcfbef2601751ddfa48f2fc">Compass::DRIVER_QMC5883</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00371">AP_Compass.h:371</a></div></div>
<div class="ttc" id="AP__Compass_8cpp_html_a6db3df6d28073ae8f6bb62bd31c7ca54"><div class="ttname"><a href="AP__Compass_8cpp.html#a6db3df6d28073ae8f6bb62bd31c7ca54">AP_COMPASS_OFFSETS_MAX_DEFAULT</a></div><div class="ttdeci">#define AP_COMPASS_OFFSETS_MAX_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00040">AP_Compass.cpp:40</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a78a408c84f2a1bafde256ac650142e4d"><div class="ttname"><a href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, clazz, element, def)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00100">AP_Param.h:100</a></div></div>
<div class="ttc" id="classAP__Compass__IST8308_html_a363d0b94f0293a29a51baa34245d0d32"><div class="ttname"><a href="classAP__Compass__IST8308.html#a363d0b94f0293a29a51baa34245d0d32">AP_Compass_IST8308::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::I2CDevice &gt; dev, bool force_external=false, enum Rotation rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__IST8308_8cpp_source.html#l00082">AP_Compass_IST8308.cpp:82</a></div></div>
<div class="ttc" id="AP__Compass__LIS3MDL_8h_html_ac10cbbe8e0464aff5b30a33809111cef"><div class="ttname"><a href="AP__Compass__LIS3MDL_8h.html#ac10cbbe8e0464aff5b30a33809111cef">HAL_COMPASS_LIS3MDL_I2C_ADDR</a></div><div class="ttdeci">#define HAL_COMPASS_LIS3MDL_I2C_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__LIS3MDL_8h_source.html#l00026">AP_Compass_LIS3MDL.h:26</a></div></div>
<div class="ttc" id="classCompass_html_a068308f9242c606086b60416142e437b"><div class="ttname"><a href="classCompass.html#a068308f9242c606086b60416142e437b">Compass::_log_bit</a></div><div class="ttdeci">uint32_t _log_bit</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00410">AP_Compass.h:410</a></div></div>
<div class="ttc" id="classCompass_html_afeac6bcfad2650762cccda72dbce3e69"><div class="ttname"><a href="classCompass.html#afeac6bcfad2650762cccda72dbce3e69">Compass::set_and_save_offsets</a></div><div class="ttdeci">void set_and_save_offsets(uint8_t i, const Vector3f &amp;offsets)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01006">AP_Compass.cpp:1006</a></div></div>
<div class="ttc" id="AP__Compass_8cpp_html_a1d1ca2e01f4d02fdb3e3e66c46739c02"><div class="ttname"><a href="AP__Compass_8cpp.html#a1d1ca2e01f4d02fdb3e3e66c46739c02">GET_I2C_DEVICE</a></div><div class="ttdeci">#define GET_I2C_DEVICE(bus, address)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00606">AP_Compass.cpp:606</a></div></div>
<div class="ttc" id="AP__Logger_8h_html"><div class="ttname"><a href="AP__Logger_8h.html">AP_Logger.h</a></div></div>
<div class="ttc" id="Linux_2I2CDevice_8h_html"><div class="ttname"><a href="Linux_2I2CDevice_8h.html">I2CDevice.h</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a78f917fc079eb5acb3e9623f0bbe0ff9"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a78f917fc079eb5acb3e9623f0bbe0ff9">AP_BoardConfig::PX4_BOARD_PH2SLIM</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00072">AP_BoardConfig.h:72</a></div></div>
<div class="ttc" id="classMatrix3_html"><div class="ttname"><a href="classMatrix3.html">Matrix3</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8h_source.html#l00045">matrix3.h:45</a></div></div>
<div class="ttc" id="classMatrix3_html_a62587bd216436f09f06b9e1330f84bc0"><div class="ttname"><a href="classMatrix3.html#a62587bd216436f09f06b9e1330f84bc0">Matrix3::from_euler</a></div><div class="ttdeci">void from_euler(float roll, float pitch, float yaw)</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8cpp_source.html#l00026">matrix3.cpp:26</a></div></div>
<div class="ttc" id="classAP__Logger_html_a5f47086952bb5e841d979491e6dd562f"><div class="ttname"><a href="classAP__Logger.html#a5f47086952bb5e841d979491e6dd562f">AP_Logger::Write_Error</a></div><div class="ttdeci">void Write_Error(LogErrorSubsystem sub_system, LogErrorCode error_code)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Logger_8cpp_source.html#l01139">AP_Logger.cpp:1139</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a3c5386db31b5c706894441bb6279eefc"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a3c5386db31b5c706894441bb6279eefc">AP_BoardConfig::VRX_BOARD_BRAIN54</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00086">AP_BoardConfig.h:86</a></div></div>
<div class="ttc" id="classCompass_html_a2593e947a6c8a4937dccd2d367158b74"><div class="ttname"><a href="classCompass.html#a2593e947a6c8a4937dccd2d367158b74">Compass::read</a></div><div class="ttdeci">bool read()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00960">AP_Compass.cpp:960</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983ac37e0c90b91e19c9b6945baa8b05b278"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ac37e0c90b91e19c9b6945baa8b05b278">AP_BoardConfig::PX4_BOARD_PCNC1</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00076">AP_BoardConfig.h:76</a></div></div>
<div class="ttc" id="AP__Logger_8h_html_a90bd604ad2616a0bd3da3a8c055d33c9a7f8e5befc5f6252522b93b1d0cd9f101"><div class="ttname"><a href="AP__Logger_8h.html#a90bd604ad2616a0bd3da3a8c055d33c9a7f8e5befc5f6252522b93b1d0cd9f101">LogErrorCode::FAILED_TO_INITIALISE</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a212c2ff8c6c4ada3668b927ac6728a87"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a212c2ff8c6c4ada3668b927ac6728a87">AP_BoardConfig::VRX_BOARD_BRAIN51</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00080">AP_BoardConfig.h:80</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983aedbfaade4bc5663cfd73a8652235bb30"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983aedbfaade4bc5663cfd73a8652235bb30">AP_BoardConfig::VRX_BOARD_BRAIN52E</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00082">AP_BoardConfig.h:82</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19">Compass::DriverType</a></div><div class="ttdeci">DriverType</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00359">AP_Compass.h:359</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983ad387380811280b3f995f8387ab50264e"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ad387380811280b3f995f8387ab50264e">AP_BoardConfig::PX4_BOARD_PIXHAWK2</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00069">AP_BoardConfig.h:69</a></div></div>
<div class="ttc" id="classCompass_html_a424b78025887b128dd21833cb6e31d0b"><div class="ttname"><a href="classCompass.html#a424b78025887b128dd21833cb6e31d0b">Compass::_declination</a></div><div class="ttdeci">AP_Float _declination</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00401">AP_Compass.h:401</a></div></div>
<div class="ttc" id="structVector2_html_aa78ff4778f55bf9c1ba9a10830fc0b89"><div class="ttname"><a href="structVector2.html#aa78ff4778f55bf9c1ba9a10830fc0b89">Vector2::normalized</a></div><div class="ttdeci">Vector2&lt; T &gt; normalized() const</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8cpp_source.html#l00260">vector2.cpp:260</a></div></div>
<div class="ttc" id="classCompass_html_a75aaff7b480627c038a0810862606bf9"><div class="ttname"><a href="classCompass.html#a75aaff7b480627c038a0810862606bf9">Compass::learn_allocated</a></div><div class="ttdeci">bool learn_allocated</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00484">AP_Compass.h:484</a></div></div>
<div class="ttc" id="classCompass_html_a18ec405430e055e4a01912a8ca73cbc3"><div class="ttname"><a href="classCompass.html#a18ec405430e055e4a01912a8ca73cbc3">Compass::set_offsets</a></div><div class="ttdeci">void set_offsets(uint8_t i, const Vector3f &amp;offsets)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00997">AP_Compass.cpp:997</a></div></div>
<div class="ttc" id="AP__Compass__UAVCAN_8h_html"><div class="ttname"><a href="AP__Compass__UAVCAN_8h.html">AP_Compass_UAVCAN.h</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a50dc445d1c9b8ed874a7a7d7054737d2"><div class="ttname"><a href="structCompass_1_1mag__state.html#a50dc445d1c9b8ed874a7a7d7054737d2">Compass::mag_state::diagonals</a></div><div class="ttdeci">AP_Vector3f diagonals</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00430">AP_Compass.h:430</a></div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681">Rotation</a></div><div class="ttdeci">Rotation</div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00027">rotations.h:27</a></div></div>
<div class="ttc" id="classCompass_html_a307ba851d14fd2ac3b655227812f6b4d"><div class="ttname"><a href="classCompass.html#a307ba851d14fd2ac3b655227812f6b4d">Compass::set_motor_compensation</a></div><div class="ttdeci">void set_motor_compensation(uint8_t i, const Vector3f &amp;motor_comp_factor)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01049">AP_Compass.cpp:1049</a></div></div>
<div class="ttc" id="classAP__Compass__HMC5843_html_ae81cef752ef1784f4f811c1b4cc57a4b"><div class="ttname"><a href="classAP__Compass__HMC5843.html#ae81cef752ef1784f4f811c1b4cc57a4b">AP_Compass_HMC5843::probe_mpu6000</a></div><div class="ttdeci">static AP_Compass_Backend * probe_mpu6000(enum Rotation rotation=ROTATION_NONE)</div></div>
<div class="ttc" id="classCompass_html_a23dca9254efb3dedb9dcd565c829d707"><div class="ttname"><a href="classCompass.html#a23dca9254efb3dedb9dcd565c829d707">Compass::_add_backend</a></div><div class="ttdeci">bool _add_backend(AP_Compass_Backend *backend)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00555">AP_Compass.cpp:555</a></div></div>
<div class="ttc" id="AP__InternalError_8cpp_html_a02ad7a50d04e0dbf28c6c90a183a0579"><div class="ttname"><a href="AP__InternalError_8cpp.html#a02ad7a50d04e0dbf28c6c90a183a0579">instance</a></div><div class="ttdeci">static AP_InternalError instance</div><div class="ttdef"><b>Definition:</b> <a href="AP__InternalError_8cpp_source.html#l00008">AP_InternalError.cpp:8</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a102db3d1e1b2b4fe5c8fffd7de522664">Compass::DRIVER_AK8963</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00362">AP_Compass.h:362</a></div></div>
<div class="ttc" id="classCompass_html_a049567dd39f99577797beb087e41f13a"><div class="ttname"><a href="classCompass.html#a049567dd39f99577797beb087e41f13a">Compass::get_healthy_mask</a></div><div class="ttdeci">uint8_t get_healthy_mask() const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00985">AP_Compass.cpp:985</a></div></div>
<div class="ttc" id="classCompass_html_a0bc30e897c2c0c412120e1b1337bd1cb"><div class="ttname"><a href="classCompass.html#a0bc30e897c2c0c412120e1b1337bd1cb">Compass::_setup_earth_field</a></div><div class="ttdeci">void _setup_earth_field()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01248">AP_Compass.cpp:1248</a></div></div>
<div class="ttc" id="classAP__Compass__QMC5883L_html_abd73fb24d1b79b0e669393eec4335731"><div class="ttname"><a href="classAP__Compass__QMC5883L.html#abd73fb24d1b79b0e669393eec4335731">AP_Compass_QMC5883L::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::I2CDevice &gt; dev, bool force_external, enum Rotation rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__QMC5883L_8cpp_source.html#l00060">AP_Compass_QMC5883L.cpp:60</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a4ac6e96bb0e028b4bad4faba7ecdb8c1"><div class="ttname"><a href="structCompass_1_1mag__state.html#a4ac6e96bb0e028b4bad4faba7ecdb8c1">Compass::mag_state::offdiagonals</a></div><div class="ttdeci">AP_Vector3f offdiagonals</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00431">AP_Compass.h:431</a></div></div>
<div class="ttc" id="classCompass_html_a514bab09cfbac818a417d2f989467ce6"><div class="ttname"><a href="classCompass.html#a514bab09cfbac818a417d2f989467ce6">Compass::get_primary</a></div><div class="ttdeci">uint8_t get_primary(void) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00268">AP_Compass.h:268</a></div></div>
<div class="ttc" id="AP__Compass_8h_html_a062f390a5503097ca313e53f277d1f64"><div class="ttname"><a href="AP__Compass_8h.html#a062f390a5503097ca313e53f277d1f64">AP_COMPASS_MAX_XY_LENGTH_DIFF</a></div><div class="ttdeci">#define AP_COMPASS_MAX_XY_LENGTH_DIFF</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00039">AP_Compass.h:39</a></div></div>
<div class="ttc" id="classCompass_html_a0005716f188963f3ac6494c2a5ce2e2c"><div class="ttname"><a href="classCompass.html#a0005716f188963f3ac6494c2a5ce2e2c">Compass::calculate_heading</a></div><div class="ttdeci">float calculate_heading(const Matrix3f &amp;dcm_matrix) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00086">AP_Compass.h:86</a></div></div>
<div class="ttc" id="namespaceAP_html_aa35bfac1ea2da16f110e8e72db7b3b20"><div class="ttname"><a href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a></div><div class="ttdeci">AP_Logger &amp; logger()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Logger_8cpp_source.html#l01182">AP_Logger.cpp:1182</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_ab3175e2e6223ccfe82f957e41cc12b26"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#ab3175e2e6223ccfe82f957e41cc12b26">AP_HAL::Scheduler::delay</a></div><div class="ttdeci">virtual void delay(uint16_t ms)=0</div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681a621932380092e03bd929b22f6a1945ed"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a621932380092e03bd929b22f6a1945ed">ROTATION_CUSTOM</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00077">rotations.h:77</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19a03a77be7424a941a21861931eed0dded"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03a77be7424a941a21861931eed0dded">Compass::DRIVER_LIS3MDL</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00365">AP_Compass.h:365</a></div></div>
<div class="ttc" id="classCompass_html_ae581710aa79ddf7abce3b3893bb08ea5"><div class="ttname"><a href="classCompass.html#ae581710aa79ddf7abce3b3893bb08ea5">Compass::set_and_save_diagonals</a></div><div class="ttdeci">void set_and_save_diagonals(uint8_t i, const Vector3f &amp;diagonals)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01016">AP_Compass.cpp:1016</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983ae3bc20831e04c6038b9ad40680003eda"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983ae3bc20831e04c6038b9ad40680003eda">AP_BoardConfig::PX4_BOARD_FMUV6</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00088">AP_BoardConfig.h:88</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a05ec778f42256d22fbdf58c458707b38"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a05ec778f42256d22fbdf58c458707b38">AP_BoardConfig::PX4_BOARD_PIXHAWK_PRO</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00074">AP_BoardConfig.h:74</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a53e500f8c050e0ae471194b0fca121cb"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a53e500f8c050e0ae471194b0fca121cb">AP_BoardConfig::VRX_BOARD_UBRAIN51</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00083">AP_BoardConfig.h:83</a></div></div>
<div class="ttc" id="Compass__learn_8h_html"><div class="ttname"><a href="Compass__learn_8h.html">Compass_learn.h</a></div></div>
<div class="ttc" id="classAP__HAL_1_1BetterStream_html_a8534aa004599bb81ad60f3e762791032"><div class="ttname"><a href="classAP__HAL_1_1BetterStream.html#a8534aa004599bb81ad60f3e762791032">AP_HAL::BetterStream::printf</a></div><div class="ttdeci">virtual void printf(const char *,...) FMT_PRINTF(2</div><div class="ttdef"><b>Definition:</b> <a href="BetterStream_8cpp_source.html#l00005">BetterStream.cpp:5</a></div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681a3eaa4f433c1b87308e89d9c7bedd7076"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a3eaa4f433c1b87308e89d9c7bedd7076">ROTATION_ROLL_180_YAW_90</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00038">rotations.h:38</a></div></div>
<div class="ttc" id="classAP__HAL_1_1SPIDeviceManager_html_a84c4a9ff2ae0cdaa9a0bc8a3f0939893"><div class="ttname"><a href="classAP__HAL_1_1SPIDeviceManager.html#a84c4a9ff2ae0cdaa9a0bc8a3f0939893">AP_HAL::SPIDeviceManager::get_device</a></div><div class="ttdeci">virtual OwnPtr&lt; SPIDevice &gt; get_device(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="SPIDevice_8h_source.html#l00071">SPIDevice.h:71</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00021">HAL.h:21</a></div></div>
<div class="ttc" id="namespaceAP_html"><div class="ttname"><a href="namespaceAP.html">AP</a></div><div class="ttdef"><b>Definition:</b> <a href="AC__Avoid_8cpp_source.html#l00655">AC_Avoid.cpp:655</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19a2fd5c3e06d96ca5143069b84b46d4010"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a2fd5c3e06d96ca5143069b84b46d4010">Compass::DRIVER_UAVCAN</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00370">AP_Compass.h:370</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a97426996f59ed4a7534cfd7bb6a3174a"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a97426996f59ed4a7534cfd7bb6a3174a">AP_BoardConfig::PX4_BOARD_AEROFC</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00073">AP_BoardConfig.h:73</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a122ab74c52fd603b79d0b2c0b5651ed5"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a122ab74c52fd603b79d0b2c0b5651ed5">AP_BoardConfig::VRX_BOARD_UBRAIN52</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00084">AP_BoardConfig.h:84</a></div></div>
<div class="ttc" id="AP__Compass__AK09916_8h_html"><div class="ttname"><a href="AP__Compass__AK09916_8h.html">AP_Compass_AK09916.h</a></div></div>
<div class="ttc" id="AP__Math_8h_html_a2a12cce483e9b870da70d30406d82c60"><div class="ttname"><a href="AP__Math_8h.html#a2a12cce483e9b870da70d30406d82c60">is_zero</a></div><div class="ttdeci">bool is_zero(const T fVal1)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00040">AP_Math.h:40</a></div></div>
<div class="ttc" id="DerivativeFilter_8cpp_html_a357394e0f6f88c8a57bd893ab28dc8f8"><div class="ttname"><a href="DerivativeFilter_8cpp.html#a357394e0f6f88c8a57bd893ab28dc8f8">f</a></div><div class="ttdeci">#define f(i)</div></div>
<div class="ttc" id="classCompass_html"><div class="ttname"><a href="classCompass.html">Compass</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00050">AP_Compass.h:50</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a939e3484a227aa39019088ac96a9cfd3"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a939e3484a227aa39019088ac96a9cfd3">AP_BoardConfig::VRX_BOARD_BRAIN52</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00081">AP_BoardConfig.h:81</a></div></div>
<div class="ttc" id="classAP__Compass__UAVCAN_html_ac5dca21c8e6aa6a910b17cb5705410e2"><div class="ttname"><a href="classAP__Compass__UAVCAN.html#ac5dca21c8e6aa6a910b17cb5705410e2">AP_Compass_UAVCAN::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe()</div></div>
<div class="ttc" id="structVector2_html"><div class="ttname"><a href="structVector2.html">Vector2&lt; float &gt;</a></div></div>
<div class="ttc" id="classAP__Compass__BMM150_html_a4c7a517bac53993bc2e9ae970d6657e8"><div class="ttname"><a href="classAP__Compass__BMM150.html#a4c7a517bac53993bc2e9ae970d6657e8">AP_Compass_BMM150::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::I2CDevice &gt; dev)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__BMM150_8cpp_source.html#l00066">AP_Compass_BMM150.cpp:66</a></div></div>
<div class="ttc" id="classVector3_html_a561df88b28e106e337a25bb86554a569"><div class="ttname"><a href="classVector3.html#a561df88b28e106e337a25bb86554a569">Vector3::y</a></div><div class="ttdeci">T y</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00067">vector3.h:67</a></div></div>
<div class="ttc" id="AP__BoardConfig_8h_html"><div class="ttname"><a href="AP__BoardConfig_8h.html">AP_BoardConfig.h</a></div></div>
<div class="ttc" id="classMatrix3_html_a7efa0e7bd4c621a7fe76cd9168960b94"><div class="ttname"><a href="classMatrix3.html#a7efa0e7bd4c621a7fe76cd9168960b94">Matrix3::c</a></div><div class="ttdeci">Vector3&lt; T &gt; c</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8h_source.html#l00049">matrix3.h:49</a></div></div>
<div class="ttc" id="AP__Compass__MAG3110_8h_html_abd616c9bd301c82c4f11f551a86a81d6"><div class="ttname"><a href="AP__Compass__MAG3110_8h.html#abd616c9bd301c82c4f11f551a86a81d6">HAL_MAG3110_I2C_ADDR</a></div><div class="ttdeci">#define HAL_MAG3110_I2C_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__MAG3110_8h_source.html#l00013">AP_Compass_MAG3110.h:13</a></div></div>
<div class="ttc" id="namespaceAP__HAL_html_a77dffbb18891996280308e21316ec186"><div class="ttname"><a href="namespaceAP__HAL.html#a77dffbb18891996280308e21316ec186">AP_HAL::millis</a></div><div class="ttdeci">uint32_t millis()</div><div class="ttdef"><b>Definition:</b> <a href="ChibiOS_2system_8cpp_source.html#l00157">system.cpp:157</a></div></div>
<div class="ttc" id="AP__Compass_8cpp_html_aced1819bbf63ee14663aa60cca76fa80"><div class="ttname"><a href="AP__Compass_8cpp.html#aced1819bbf63ee14663aa60cca76fa80">HAL_COMPASS_FILTER_DEFAULT</a></div><div class="ttdeci">#define HAL_COMPASS_FILTER_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00044">AP_Compass.cpp:44</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a3e2ff88eb37ae470b4c1b4b3c232305e"><div class="ttname"><a href="structCompass_1_1mag__state.html#a3e2ff88eb37ae470b4c1b4b3c232305e">Compass::mag_state::offset</a></div><div class="ttdeci">AP_Vector3f offset</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00429">AP_Compass.h:429</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19a03d5a05b7c001ea2ba800ec7c90ebc4b"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a03d5a05b7c001ea2ba800ec7c90ebc4b">Compass::DRIVER_LSM9DS1</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00364">AP_Compass.h:364</a></div></div>
<div class="ttc" id="classCompass_html_ab315b6dc2d05ea4649d5cf8f1a2b511a"><div class="ttname"><a href="classCompass.html#ab315b6dc2d05ea4649d5cf8f1a2b511a">Compass::_enabled</a></div><div class="ttdeci">AP_Int8 _enabled</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00385">AP_Compass.h:385</a></div></div>
<div class="ttc" id="classVector3_html_ab3e7f5401dd6e951978bfa746809f74f"><div class="ttname"><a href="classVector3.html#ab3e7f5401dd6e951978bfa746809f74f">Vector3::z</a></div><div class="ttdeci">T z</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00067">vector3.h:67</a></div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681afae5b963b8902f5e5846a8929b9b74ba"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681afae5b963b8902f5e5846a8929b9b74ba">ROTATION_YAW_90</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00030">rotations.h:30</a></div></div>
<div class="ttc" id="structAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00142">AP_Param.h:142</a></div></div>
<div class="ttc" id="classCompass_html_af46d67cb8eb4bc4c51bb12be6813cfdd"><div class="ttname"><a href="classCompass.html#af46d67cb8eb4bc4c51bb12be6813cfdd">Compass::_backends</a></div><div class="ttdeci">AP_Compass_Backend * _backends[COMPASS_MAX_BACKEND]</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00381">AP_Compass.h:381</a></div></div>
<div class="ttc" id="AP__Compass_8h_html_a8bc3b9dad383e949bb7a78683f027132"><div class="ttname"><a href="AP__Compass_8h.html#a8bc3b9dad383e949bb7a78683f027132">AP_COMPASS_MAX_XY_ANG_DIFF</a></div><div class="ttdeci">#define AP_COMPASS_MAX_XY_ANG_DIFF</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00038">AP_Compass.h:38</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a49545b0efc480dbab4a518321a708dc1"><div class="ttname"><a href="structCompass_1_1mag__state.html#a49545b0efc480dbab4a518321a708dc1">Compass::mag_state::use_for_yaw</a></div><div class="ttdeci">AP_Int8 use_for_yaw</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00440">AP_Compass.h:440</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a2548b608826699e872a2de7f4e1ff877"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a2548b608826699e872a2de7f4e1ff877">AP_BoardConfig::PX4_BOARD_SP01</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00078">AP_BoardConfig.h:78</a></div></div>
<div class="ttc" id="AP__Compass_8h_html_af4b14d20a1ad32e0d381181e1d92a7ca"><div class="ttname"><a href="AP__Compass_8h.html#af4b14d20a1ad32e0d381181e1d92a7ca">AP_COMPASS_CALIBRATION_FITNESS_DEFAULT</a></div><div class="ttdeci">#define AP_COMPASS_CALIBRATION_FITNESS_DEFAULT</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00036">AP_Compass.h:36</a></div></div>
<div class="ttc" id="classAP__Compass__AK8963_html_a0e8c9e0c82de409e0225fc81ed4ed6db"><div class="ttname"><a href="classAP__Compass__AK8963.html#a0e8c9e0c82de409e0225fc81ed4ed6db">AP_Compass_AK8963::probe_mpu9250</a></div><div class="ttdeci">static AP_Compass_Backend * probe_mpu9250(AP_HAL::OwnPtr&lt; AP_HAL::I2CDevice &gt; dev, enum Rotation rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__AK8963_8cpp_source.html#l00087">AP_Compass_AK8963.cpp:87</a></div></div>
<div class="ttc" id="chibios_8h_html_ae30b37f1f4cd685cec0014ac3a5e00ad"><div class="ttname"><a href="chibios_8h.html#ae30b37f1f4cd685cec0014ac3a5e00ad">HAL_INS_LSM9DS0_EXT_A_NAME</a></div><div class="ttdeci">#define HAL_INS_LSM9DS0_EXT_A_NAME</div><div class="ttdef"><b>Definition:</b> <a href="chibios_8h_source.html#l00067">chibios.h:67</a></div></div>
<div class="ttc" id="classCompass_html_a0a8d322a3774f60f4c1577dad3ab016a"><div class="ttname"><a href="classCompass.html#a0a8d322a3774f60f4c1577dad3ab016a">Compass::field</a></div><div class="ttdeci">Vector3f field[COMPASS_MAX_INSTANCES]</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00293">AP_Compass.h:293</a></div></div>
<div class="ttc" id="AP__Compass__MAG3110_8h_html"><div class="ttname"><a href="AP__Compass__MAG3110_8h.html">AP_Compass_MAG3110.h</a></div></div>
<div class="ttc" id="AP__Compass__LIS3MDL_8h_html_a094c5397594967479d9a2af852999e9a"><div class="ttname"><a href="AP__Compass__LIS3MDL_8h.html#a094c5397594967479d9a2af852999e9a">HAL_COMPASS_LIS3MDL_I2C_ADDR2</a></div><div class="ttdeci">#define HAL_COMPASS_LIS3MDL_I2C_ADDR2</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__LIS3MDL_8h_source.html#l00030">AP_Compass_LIS3MDL.h:30</a></div></div>
<div class="ttc" id="classAP__Compass__IST8310_html_a6f6f86e57c602b84d7cef10c814f77e5"><div class="ttname"><a href="classAP__Compass__IST8310.html#a6f6f86e57c602b84d7cef10c814f77e5">AP_Compass_IST8310::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::I2CDevice &gt; dev, bool force_external=false, enum Rotation rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__IST8310_8cpp_source.html#l00078">AP_Compass_IST8310.cpp:78</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a6aaf12ce90b5b9586d350af949ab84a0"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a6aaf12ce90b5b9586d350af949ab84a0">AP_BoardConfig::PX4_BOARD_MINDPXV2</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00077">AP_BoardConfig.h:77</a></div></div>
<div class="ttc" id="classCompass_html_a76b5ecbd5bd613d28b1172834d3a8db9"><div class="ttname"><a href="classCompass.html#a76b5ecbd5bd613d28b1172834d3a8db9">Compass::healthy</a></div><div class="ttdeci">bool healthy(void) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00161">AP_Compass.h:161</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_afe6deabcf507751cd66c36639bb9dde0"><div class="ttname"><a href="structCompass_1_1mag__state.html#afe6deabcf507751cd66c36639bb9dde0">Compass::mag_state::dev_id</a></div><div class="ttdeci">AP_Int32 dev_id</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00436">AP_Compass.h:436</a></div></div>
<div class="ttc" id="AP__Compass__AK8963_8h_html"><div class="ttname"><a href="AP__Compass__AK8963_8h.html">AP_Compass_AK8963.h</a></div></div>
<div class="ttc" id="AP__Compass__LSM9DS1_8h_html"><div class="ttname"><a href="AP__Compass__LSM9DS1_8h.html">AP_Compass_LSM9DS1.h</a></div></div>
<div class="ttc" id="AP__Compass__IST8308_8h_html"><div class="ttname"><a href="AP__Compass__IST8308_8h.html">AP_Compass_IST8308.h</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983acf567833f77e46ce320a961f68611bff"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983acf567833f77e46ce320a961f68611bff">AP_BoardConfig::PX4_BOARD_PX4V1</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00067">AP_BoardConfig.h:67</a></div></div>
<div class="ttc" id="classCompass_html_af8d0469972b7da6464a0d91e20715082"><div class="ttname"><a href="classCompass.html#af8d0469972b7da6464a0d91e20715082">Compass::consistent</a></div><div class="ttdeci">bool consistent() const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01274">AP_Compass.cpp:1274</a></div></div>
<div class="ttc" id="classCompass_html_a53de8105fdd000b28afe20ced1b85d5a"><div class="ttname"><a href="classCompass.html#a53de8105fdd000b28afe20ced1b85d5a">Compass::_motor_comp_type</a></div><div class="ttdeci">AP_Int8 _motor_comp_type</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00417">AP_Compass.h:417</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_af8c602bce948527aa20ec7a32562010d"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#af8c602bce948527aa20ec7a32562010d">AP_HAL::HAL::spi</a></div><div class="ttdeci">AP_HAL::SPIDeviceManager * spi</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00107">HAL.h:107</a></div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681a90f75701d0b21bcb9d12826ac8cb4ef6"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a90f75701d0b21bcb9d12826ac8cb4ef6">ROTATION_PITCH_180_YAW_270</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00055">rotations.h:55</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Device_html_abdd5c39f57e7022979565e92b6578ba1a3cba5573df48b0d7c5c9e7e307f09da9"><div class="ttname"><a href="classAP__HAL_1_1Device.html#abdd5c39f57e7022979565e92b6578ba1a3cba5573df48b0d7c5c9e7e307f09da9">AP_HAL::Device::BUS_TYPE_I2C</a></div><div class="ttdef"><b>Definition:</b> <a href="Device_8h_source.html#l00031">Device.h:31</a></div></div>
<div class="ttc" id="classCompass_html_a4e9a565e5c381153bf6e5f3468d787e1"><div class="ttname"><a href="classCompass.html#a4e9a565e5c381153bf6e5f3468d787e1">Compass::getHIL</a></div><div class="ttdeci">const Vector3f &amp; getHIL(uint8_t instance) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01242">AP_Compass.cpp:1242</a></div></div>
<div class="ttc" id="classVector3_html_a9b147a862a1b86ed2e5b735d19da3da1"><div class="ttname"><a href="classVector3.html#a9b147a862a1b86ed2e5b735d19da3da1">Vector3::normalize</a></div><div class="ttdeci">void normalize()</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00182">vector3.h:182</a></div></div>
<div class="ttc" id="AP__Compass__AK09916_8h_html_a6848bf4867620c224db61628e399feec"><div class="ttname"><a href="AP__Compass__AK09916_8h.html#a6848bf4867620c224db61628e399feec">HAL_COMPASS_AK09916_I2C_ADDR</a></div><div class="ttdeci">#define HAL_COMPASS_AK09916_I2C_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__AK09916_8h_source.html#l00026">AP_Compass_AK09916.h:26</a></div></div>
<div class="ttc" id="AP__Compass__LSM303D_8h_html"><div class="ttname"><a href="AP__Compass__LSM303D_8h.html">AP_Compass_LSM303D.h</a></div></div>
<div class="ttc" id="classCompass_html_a1c48170d8c8966b22fb150b1634443ec"><div class="ttname"><a href="classCompass.html#a1c48170d8c8966b22fb150b1634443ec">Compass::_detect_backends</a></div><div class="ttdeci">void _detect_backends(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00723">AP_Compass.cpp:723</a></div></div>
<div class="ttc" id="classCompassLearn_html_ac8ff1a868c253b5ae8bd434be2bc7e3d"><div class="ttname"><a href="classCompassLearn.html#ac8ff1a868c253b5ae8bd434be2bc7e3d">CompassLearn::update</a></div><div class="ttdeci">void update(void)</div><div class="ttdef"><b>Definition:</b> <a href="Compass__learn_8cpp_source.html#l00025">Compass_learn.cpp:25</a></div></div>
<div class="ttc" id="classAP__Compass__HMC5843_html_a31c5df5d9cf46cabf2bc5b13201ac80a"><div class="ttname"><a href="classAP__Compass__HMC5843.html#a31c5df5d9cf46cabf2bc5b13201ac80a">AP_Compass_HMC5843::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::Device &gt; dev, bool force_external=false, enum Rotation rotation=ROTATION_NONE)</div></div>
<div class="ttc" id="AP__Compass_8h_html"><div class="ttname"><a href="AP__Compass_8h.html">AP_Compass.h</a></div></div>
<div class="ttc" id="AP__Vehicle_8h_html"><div class="ttname"><a href="AP__Vehicle_8h.html">AP_Vehicle.h</a></div></div>
<div class="ttc" id="classAP__Compass__AK09916_html_ae805952411e6ebe3d2d0908e4f3ae0ac"><div class="ttname"><a href="classAP__Compass__AK09916.html#ae805952411e6ebe3d2d0908e4f3ae0ac">AP_Compass_AK09916::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::I2CDevice &gt; dev, bool force_external, enum Rotation rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__AK09916_8cpp_source.html#l00075">AP_Compass_AK09916.cpp:75</a></div></div>
<div class="ttc" id="classMatrix3_html_a212a94e2a9c26def827fa766f4d0ae3e"><div class="ttname"><a href="classMatrix3.html#a212a94e2a9c26def827fa766f4d0ae3e">Matrix3::mul_transpose</a></div><div class="ttdeci">Vector3&lt; T &gt; mul_transpose(const Vector3&lt; T &gt; &amp;v) const</div><div class="ttdef"><b>Definition:</b> <a href="matrix3_8cpp_source.html#l00158">matrix3.cpp:158</a></div></div>
<div class="ttc" id="classCompass_html_aab02220a8209d664f89f2be9050cf283"><div class="ttname"><a href="classCompass.html#aab02220a8209d664f89f2be9050cf283">Compass::get_count</a></div><div class="ttdeci">uint8_t get_count(void) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00118">AP_Compass.h:118</a></div></div>
<div class="ttc" id="AP__Compass__QMC5883L_8h_html_a3f1e879cd41b64877257c513fbf11467"><div class="ttname"><a href="AP__Compass__QMC5883L_8h.html#a3f1e879cd41b64877257c513fbf11467">HAL_COMPASS_QMC5883L_I2C_ADDR</a></div><div class="ttdeci">#define HAL_COMPASS_QMC5883L_I2C_ADDR</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__QMC5883L_8h_source.html#l00028">AP_Compass_QMC5883L.h:28</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a6f39405e261af307e647f079d8a6ec56"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a6f39405e261af307e647f079d8a6ec56">AP_BoardConfig::PX4_BOARD_FMUV5</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00079">AP_BoardConfig.h:79</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19abef69f23181c6c5a6b3357c4d25a3e66"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19abef69f23181c6c5a6b3357c4d25a3e66">Compass::DRIVER_MAG3110</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00373">AP_Compass.h:373</a></div></div>
<div class="ttc" id="AP__Compass_8cpp_html_abb423de10259a16fffedfcb56781ab4c"><div class="ttname"><a href="AP__Compass_8cpp.html#abb423de10259a16fffedfcb56781ab4c">ADD_BACKEND</a></div><div class="ttdeci">#define ADD_BACKEND(driver_type, backend)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00598">AP_Compass.cpp:598</a></div></div>
<div class="ttc" id="classAP__Declination_html_ae3c4783226b79c64dc2c2be9180f9d6e"><div class="ttname"><a href="classAP__Declination.html#ae3c4783226b79c64dc2c2be9180f9d6e">AP_Declination::get_declination</a></div><div class="ttdeci">static float get_declination(float latitude_deg, float longitude_deg)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Declination_8cpp_source.html#l00121">AP_Declination.cpp:121</a></div></div>
<div class="ttc" id="chibios_8h_html_af93f1bddafc9785287d1f3e638125dbc"><div class="ttname"><a href="chibios_8h.html#af93f1bddafc9785287d1f3e638125dbc">HAL_COMPASS_LIS3MDL_NAME</a></div><div class="ttdeci">#define HAL_COMPASS_LIS3MDL_NAME</div><div class="ttdef"><b>Definition:</b> <a href="chibios_8h_source.html#l00079">chibios.h:79</a></div></div>
<div class="ttc" id="classCompass_html_ac3584d30eca4e60567613c1b09785505"><div class="ttname"><a href="classCompass.html#ac3584d30eca4e60567613c1b09785505">Compass::set_declination</a></div><div class="ttdeci">void set_declination(float radians, bool save_to_eeprom=true)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01096">AP_Compass.cpp:1096</a></div></div>
<div class="ttc" id="AP__Math_8h_html_ad525609d9dba6ffa556a0fbf08a3f9b4"><div class="ttname"><a href="AP__Math_8h.html#ad525609d9dba6ffa556a0fbf08a3f9b4">constrain_float</a></div><div class="ttdeci">float constrain_float(const float amt, const float low, const float high)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00142">AP_Math.h:142</a></div></div>
<div class="ttc" id="AP__Compass_8h_html_a0a6a0f28d3465747ea15e7d9091994de"><div class="ttname"><a href="AP__Compass_8h.html#a0a6a0f28d3465747ea15e7d9091994de">COMPASS_MAX_INSTANCES</a></div><div class="ttdeci">#define COMPASS_MAX_INSTANCES</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00045">AP_Compass.h:45</a></div></div>
<div class="ttc" id="classAP__Compass__HIL_html_af9fccad707f6720c8e26de4d358938d7"><div class="ttname"><a href="classAP__Compass__HIL.html#af9fccad707f6720c8e26de4d358938d7">AP_Compass_HIL::detect</a></div><div class="ttdeci">static AP_Compass_Backend * detect()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__HIL_8cpp_source.html#l00035">AP_Compass_HIL.cpp:35</a></div></div>
<div class="ttc" id="namespaceAP_html_a99432cfdb696952c9b7146f155a815aa"><div class="ttname"><a href="namespaceAP.html#a99432cfdb696952c9b7146f155a815aa">AP::ahrs</a></div><div class="ttdeci">AP_AHRS &amp; ahrs()</div><div class="ttdef"><b>Definition:</b> <a href="AP__AHRS_8cpp_source.html#l00526">AP_AHRS.cpp:526</a></div></div>
<div class="ttc" id="classCompass_html_a26a6c969c9e588fb680b04e99edbe811"><div class="ttname"><a href="classCompass.html#a26a6c969c9e588fb680b04e99edbe811">Compass::_hil_mode</a></div><div class="ttdeci">bool _hil_mode</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00474">AP_Compass.h:474</a></div></div>
<div class="ttc" id="classCompass_html_ad897fd4be9dd67a65343465614629568"><div class="ttname"><a href="classCompass.html#ad897fd4be9dd67a65343465614629568">Compass::motor_compensation_type</a></div><div class="ttdeci">void motor_compensation_type(const uint8_t comp_type)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01263">AP_Compass.cpp:1263</a></div></div>
<div class="ttc" id="AP__Compass__Backend_8h_html"><div class="ttname"><a href="AP__Compass__Backend_8h.html">AP_Compass_Backend.h</a></div></div>
<div class="ttc" id="classCompass_html_a6160258284468dbb348c158f1863f960"><div class="ttname"><a href="classCompass.html#a6160258284468dbb348c158f1863f960">Compass::_custom_rotation</a></div><div class="ttdeci">Matrix3f * _custom_rotation</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00395">AP_Compass.h:395</a></div></div>
<div class="ttc" id="AP__Math_8cpp_html_accbd9f8bbc0adacd51efa66fad490c24"><div class="ttname"><a href="AP__Math_8cpp.html#accbd9f8bbc0adacd51efa66fad490c24">is_equal</a></div><div class="ttdeci">std::enable_if&lt; std::is_integral&lt; typename std::common_type&lt; Arithmetic1, Arithmetic2 &gt;::type &gt;::value,bool &gt;::type is_equal(const Arithmetic1 v_1, const Arithmetic2 v_2)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8cpp_source.html#l00014">AP_Math.cpp:14</a></div></div>
<div class="ttc" id="AP__Math_8h_html_a37d7c62a8231d9d22826261297b99da4"><div class="ttname"><a href="AP__Math_8h.html#a37d7c62a8231d9d22826261297b99da4">radians</a></div><div class="ttdeci">static constexpr float radians(float deg)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Math_8h_source.html#l00163">AP_Math.h:163</a></div></div>
<div class="ttc" id="classAP__Compass__AK8963_html_afcde08c622086b5faec26b55304e8457"><div class="ttname"><a href="classAP__Compass__AK8963.html#afcde08c622086b5faec26b55304e8457">AP_Compass_AK8963::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::I2CDevice &gt; dev, enum Rotation rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__AK8963_8cpp_source.html#l00067">AP_Compass_AK8963.cpp:67</a></div></div>
<div class="ttc" id="structVector2_html_ace2a626eaa79412e2946216e9c3e63c6"><div class="ttname"><a href="structVector2.html#ace2a626eaa79412e2946216e9c3e63c6">Vector2::normalize</a></div><div class="ttdeci">void normalize()</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8cpp_source.html#l00253">vector2.cpp:253</a></div></div>
<div class="ttc" id="classCompass_html_a0c912ceffee8c65420fe9e39841fb4ba"><div class="ttname"><a href="classCompass.html#a0c912ceffee8c65420fe9e39841fb4ba">Compass::get_field</a></div><div class="ttdeci">const Vector3f &amp; get_field(void) const</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00122">AP_Compass.h:122</a></div></div>
<div class="ttc" id="structVector2_html_a5b404e32377ce01e7ef2039151faaf08"><div class="ttname"><a href="structVector2.html#a5b404e32377ce01e7ef2039151faaf08">Vector2::is_zero</a></div><div class="ttdeci">bool is_zero(void) const</div><div class="ttdef"><b>Definition:</b> <a href="vector2_8h_source.html#l00109">vector2.h:109</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a2f0a5b6527161d6a622728dfe8fd4023"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a2f0a5b6527161d6a622728dfe8fd4023">AP_BoardConfig::VRX_BOARD_CORE10</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00085">AP_BoardConfig.h:85</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19a51912f7ed58536a787c5b7f165dc61e9"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a51912f7ed58536a787c5b7f165dc61e9">Compass::DRIVER_ICM20948</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00368">AP_Compass.h:368</a></div></div>
<div class="ttc" id="classCompass_html_aa3e1ccaef661d5ff5d2e51cd7742c6ba"><div class="ttname"><a href="classCompass.html#aa3e1ccaef661d5ff5d2e51cd7742c6ba">Compass::_singleton</a></div><div class="ttdeci">static Compass * _singleton</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00325">AP_Compass.h:325</a></div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681a16e7696bfbca8f804e76718d5cfa5bef"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a16e7696bfbca8f804e76718d5cfa5bef">ROTATION_PITCH_180</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00040">rotations.h:40</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19afd40b80be9d564b799206268c73199c4"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19afd40b80be9d564b799206268c73199c4">Compass::DRIVER_AK09916</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00366">AP_Compass.h:366</a></div></div>
<div class="ttc" id="classCompass_html_a93d4187acb991b33c5c25f9e16b3b0ce"><div class="ttname"><a href="classCompass.html#a93d4187acb991b33c5c25f9e16b3b0ce">Compass::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00286">AP_Compass.h:286</a></div></div>
<div class="ttc" id="classCompass_html_afb034144f9efccbf97c7e9b3bae59e9d"><div class="ttname"><a href="classCompass.html#afb034144f9efccbf97c7e9b3bae59e9d">Compass::_hil</a></div><div class="ttdeci">struct Compass::@18 _hil</div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a37a5242ab675b8bdf0ce4246e03c5729"><div class="ttname"><a href="structCompass_1_1mag__state.html#a37a5242ab675b8bdf0ce4246e03c5729">Compass::mag_state::last_update_ms</a></div><div class="ttdeci">uint32_t last_update_ms</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00455">AP_Compass.h:455</a></div></div>
<div class="ttc" id="classAP__Compass__Backend_html_a4ad0e616103be3703829b829ab590a53"><div class="ttname"><a href="classAP__Compass__Backend.html#a4ad0e616103be3703829b829ab590a53">AP_Compass_Backend::read</a></div><div class="ttdeci">virtual void read(void)=0</div></div>
<div class="ttc" id="classCompass_html_afd52e3b95b4813b56a79742c0d98e6e4"><div class="ttname"><a href="classCompass.html#afd52e3b95b4813b56a79742c0d98e6e4">Compass::_compass_count</a></div><div class="ttdeci">uint8_t _compass_count</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00388">AP_Compass.h:388</a></div></div>
<div class="ttc" id="classVector3_html"><div class="ttname"><a href="classVector3.html">Vector3&lt; float &gt;</a></div></div>
<div class="ttc" id="classCompass__PerMotor_html"><div class="ttname"><a href="classCompass__PerMotor.html">Compass_PerMotor</a></div><div class="ttdef"><b>Definition:</b> <a href="Compass__PerMotor_8h_source.html#l00012">Compass_PerMotor.h:12</a></div></div>
<div class="ttc" id="classAP__Compass__SITL_html"><div class="ttname"><a href="classAP__Compass__SITL.html">AP_Compass_SITL</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__SITL_8h_source.html#l00014">AP_Compass_SITL.h:14</a></div></div>
<div class="ttc" id="definitions_8h_html_ae71449b1cc6e6250b91f539153a7a0d3"><div class="ttname"><a href="definitions_8h.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a></div><div class="ttdeci">#define M_PI</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00010">definitions.h:10</a></div></div>
<div class="ttc" id="namespaceAP__HAL_html_a71832f03d849a0c088f04fc98d3c8143"><div class="ttname"><a href="namespaceAP__HAL.html#a71832f03d849a0c088f04fc98d3c8143">AP_HAL::panic</a></div><div class="ttdeci">void panic(const char *errormsg,...) FMT_PRINTF(1</div><div class="ttdef"><b>Definition:</b> <a href="ChibiOS_2system_8cpp_source.html#l00140">system.cpp:140</a></div></div>
<div class="ttc" id="AP__Compass_8h_html_aa22be79a45fb28cb3160eacdf5ad4432"><div class="ttname"><a href="AP__Compass_8h.html#aa22be79a45fb28cb3160eacdf5ad4432">AP_COMPASS_MOT_COMP_CURRENT</a></div><div class="ttdeci">#define AP_COMPASS_MOT_COMP_CURRENT</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00019">AP_Compass.h:19</a></div></div>
<div class="ttc" id="classAP__Compass__MAG3110_html_a7504db53af052847097508f4885d2697"><div class="ttname"><a href="classAP__Compass__MAG3110.html#a7504db53af052847097508f4885d2697">AP_Compass_MAG3110::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::Device &gt; dev, enum Rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__MAG3110_8cpp_source.html#l00088">AP_Compass_MAG3110.cpp:88</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19a217078085d95a700a86b76f0446e6909">Compass::DRIVER_HMC5843</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00360">AP_Compass.h:360</a></div></div>
<div class="ttc" id="classCompass_html_abfc394b43272d5a6e97001232e201b7f"><div class="ttname"><a href="classCompass.html#abfc394b43272d5a6e97001232e201b7f">Compass::save_offsets</a></div><div class="ttdeci">void save_offsets(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01041">AP_Compass.cpp:1041</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a16c360358c5d6a08d34f60921fd916a9"><div class="ttname"><a href="AP__Param_8h.html#a16c360358c5d6a08d34f60921fd916a9">AP_SUBGROUPINFO</a></div><div class="ttdeci">#define AP_SUBGROUPINFO(element, name, idx, thisclazz, elclazz)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00107">AP_Param.h:107</a></div></div>
<div class="ttc" id="AP__Compass__SITL_8h_html"><div class="ttname"><a href="AP__Compass__SITL_8h.html">AP_Compass_SITL.h</a></div></div>
<div class="ttc" id="classCompass_html_ac3bf8f6ab108927b2ea704b3dcba1355"><div class="ttname"><a href="classCompass.html#ac3bf8f6ab108927b2ea704b3dcba1355">Compass::_backend_count</a></div><div class="ttdeci">uint8_t _backend_count</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00382">AP_Compass.h:382</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19acc5d43bb11e0e4733807bc8fbc37bd76"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19acc5d43bb11e0e4733807bc8fbc37bd76">Compass::DRIVER_IST8310</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00367">AP_Compass.h:367</a></div></div>
<div class="ttc" id="AP__Compass__HIL_8h_html"><div class="ttname"><a href="AP__Compass__HIL_8h.html">AP_Compass_HIL.h</a></div></div>
<div class="ttc" id="classAP__Logger_html_a3f48d1fc5f79a0c77ab1b7c36c661eb2"><div class="ttname"><a href="classAP__Logger.html#a3f48d1fc5f79a0c77ab1b7c36c661eb2">AP_Logger::Write_Compass</a></div><div class="ttdeci">void Write_Compass(uint64_t time_us=0)</div><div class="ttdef"><b>Definition:</b> <a href="LogFile_8cpp_source.html#l00719">LogFile.cpp:719</a></div></div>
<div class="ttc" id="AP__Compass_8h_html_a5ae256887a80a65f39d06f1cb2cbfacb"><div class="ttname"><a href="AP__Compass_8h.html#a5ae256887a80a65f39d06f1cb2cbfacb">COMPASS_MAX_BACKEND</a></div><div class="ttdeci">#define COMPASS_MAX_BACKEND</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00046">AP_Compass.h:46</a></div></div>
<div class="ttc" id="classCompass_html_a099bc37c6d1b03238c2efe39ea3b14d3"><div class="ttname"><a href="classCompass.html#a099bc37c6d1b03238c2efe39ea3b14d3">Compass::use_for_yaw</a></div><div class="ttdeci">bool use_for_yaw(void) const</div><div class="ttdoc">return true if the compass should be used for yaw calculations</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01079">AP_Compass.cpp:1079</a></div></div>
<div class="ttc" id="classAP__BoardConfig_html_a5dc0661313a5b2f45f8428c6d1024983a922eeb71ccd9862923f68246f86bb667"><div class="ttname"><a href="classAP__BoardConfig.html#a5dc0661313a5b2f45f8428c6d1024983a922eeb71ccd9862923f68246f86bb667">AP_BoardConfig::PX4_BOARD_AUAV21</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__BoardConfig_8h_source.html#l00075">AP_BoardConfig.h:75</a></div></div>
<div class="ttc" id="classCompass_html_a1479c75532bc97308b1c698b67cf9bcc"><div class="ttname"><a href="classCompass.html#a1479c75532bc97308b1c698b67cf9bcc">Compass::configured</a></div><div class="ttdeci">bool configured(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01188">AP_Compass.cpp:1188</a></div></div>
<div class="ttc" id="classCompass_html_a5ed931ce45b6449a63d57bb01fe5a0c9ac67e46a1613956b81acf80a37742c288"><div class="ttname"><a href="classCompass.html#a5ed931ce45b6449a63d57bb01fe5a0c9ac67e46a1613956b81acf80a37742c288">Compass::LEARN_INFLIGHT</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00300">AP_Compass.h:300</a></div></div>
<div class="ttc" id="classCompass_html_a79db6bfd3fe309c6258d783f126326c6"><div class="ttname"><a href="classCompass.html#a79db6bfd3fe309c6258d783f126326c6">Compass::init</a></div><div class="ttdeci">void init()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l00509">AP_Compass.cpp:509</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00118">AP_Param.h:118</a></div></div>
<div class="ttc" id="classCompass_html_aa953947e6a3d5acc0504e3f7c1e6b61d"><div class="ttname"><a href="classCompass.html#aa953947e6a3d5acc0504e3f7c1e6b61d">Compass::_state</a></div><div class="ttdeci">struct Compass::mag_state _state[COMPASS_MAX_INSTANCES]</div></div>
<div class="ttc" id="classCompass_html_a95d49517b12183412d9d0ed481b785bf"><div class="ttname"><a href="classCompass.html#a95d49517b12183412d9d0ed481b785bf">Compass::set_initial_location</a></div><div class="ttdeci">void set_initial_location(int32_t latitude, int32_t longitude)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01064">AP_Compass.cpp:1064</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a94ab41309b1ff10b8b862b826e59c882"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">AP_HAL::HAL::scheduler</a></div><div class="ttdeci">AP_HAL::Scheduler * scheduler</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00114">HAL.h:114</a></div></div>
<div class="ttc" id="classCompass_html_a8e98bdea111f293a50e21f15afca1e19ad0a33febf127c0dccbe03f0709f94122"><div class="ttname"><a href="classCompass.html#a8e98bdea111f293a50e21f15afca1e19ad0a33febf127c0dccbe03f0709f94122">Compass::DRIVER_BMM150</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00363">AP_Compass.h:363</a></div></div>
<div class="ttc" id="classAP__Compass__LIS3MDL_html_a6f16f4f86c045eaf84ac3b48ef94d9a3"><div class="ttname"><a href="classAP__Compass__LIS3MDL.html#a6f16f4f86c045eaf84ac3b48ef94d9a3">AP_Compass_LIS3MDL::probe</a></div><div class="ttdeci">static AP_Compass_Backend * probe(AP_HAL::OwnPtr&lt; AP_HAL::Device &gt; dev, bool force_external=false, enum Rotation rotation=ROTATION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass__LIS3MDL_8cpp_source.html#l00051">AP_Compass_LIS3MDL.cpp:51</a></div></div>
<div class="ttc" id="classVector3_html_a1a0f7e168c71ca798099f0ba8a444244"><div class="ttname"><a href="classVector3.html#a1a0f7e168c71ca798099f0ba8a444244">Vector3::x</a></div><div class="ttdeci">T x</div><div class="ttdef"><b>Definition:</b> <a href="vector3_8h_source.html#l00067">vector3.h:67</a></div></div>
<div class="ttc" id="classCompass_html_a1d376552464c5c5792326561d063ef7e"><div class="ttname"><a href="classCompass.html#a1d376552464c5c5792326561d063ef7e">Compass::_board_orientation</a></div><div class="ttdeci">enum Rotation _board_orientation</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00394">AP_Compass.h:394</a></div></div>
<div class="ttc" id="structCompass_1_1mag__state_html_a90887b7c30ed529dc3fecfb36729f9d7"><div class="ttname"><a href="structCompass_1_1mag__state.html#a90887b7c30ed529dc3fecfb36729f9d7">Compass::mag_state::motor_compensation</a></div><div class="ttdeci">AP_Vector3f motor_compensation</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00446">AP_Compass.h:446</a></div></div>
<div class="ttc" id="rotations_8h_html_a67a250c97139a5466814a54c4aa4a681a5d8b9c520b551d026df8d4aea2801294"><div class="ttname"><a href="rotations_8h.html#a67a250c97139a5466814a54c4aa4a681a5d8b9c520b551d026df8d4aea2801294">ROTATION_YAW_270</a></div><div class="ttdef"><b>Definition:</b> <a href="rotations_8h_source.html#l00034">rotations.h:34</a></div></div>
<div class="ttc" id="classAP__Param_html_a5f6dcfce1c0a79cf5bd81283e22f3201"><div class="ttname"><a href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a></div><div class="ttdeci">static void setup_object_defaults(const void *object_pointer, const struct GroupInfo *group_info)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8cpp_source.html#l01265">AP_Param.cpp:1265</a></div></div>
<div class="ttc" id="classCompass_html_a5a838bd25f13f41d428c10a8c44e965a"><div class="ttname"><a href="classCompass.html#a5a838bd25f13f41d428c10a8c44e965a">Compass::learn</a></div><div class="ttdeci">CompassLearn * learn</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8h_source.html#l00483">AP_Compass.h:483</a></div></div>
<div class="ttc" id="AP__Compass__RM3100_8h_html"><div class="ttname"><a href="AP__Compass__RM3100_8h.html">AP_Compass_RM3100.h</a></div></div>
<div class="ttc" id="classCompass_html_adeefda110ce0a02edfb3d344d632777a"><div class="ttname"><a href="classCompass.html#adeefda110ce0a02edfb3d344d632777a">Compass::save_motor_compensation</a></div><div class="ttdeci">void save_motor_compensation()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Compass_8cpp_source.html#l01055">AP_Compass.cpp:1055</a></div></div>
<div class="ttc" id="chibios_8h_html_a4a4d9b4dac87e452c5ee78083fbe7949"><div class="ttname"><a href="chibios_8h.html#a4a4d9b4dac87e452c5ee78083fbe7949">HAL_COMPASS_HMC5843_NAME</a></div><div class="ttdeci">#define HAL_COMPASS_HMC5843_NAME</div><div class="ttdef"><b>Definition:</b> <a href="chibios_8h_source.html#l00078">chibios.h:78</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 11 2019 14:17:26 for APM:Libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
