<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>APM:Libraries: libraries/AP_Scheduler/AP_Scheduler.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">APM:Libraries
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_bc0718b08fb2015b8e59c47b2805f60c.html">libraries</a></li><li class="navelem"><a class="el" href="dir_758bea2d57e44590e8b855eb3ebf4c35.html">AP_Scheduler</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">AP_Scheduler.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AP__Scheduler_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">   This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">   it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">   the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">   (at your option) any later version.</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">   This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">   GNU General Public License for more details.</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">   You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">   along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *  main loop scheduler for APM</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *  Author: Andrew Tridgell, January 2013</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AP__Scheduler_8h.html">AP_Scheduler.h</a>&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__HAL_8h.html">AP_HAL/AP_HAL.h</a>&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__Param_8h.html">AP_Param/AP_Param.h</a>&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__Vehicle_8h.html">AP_Vehicle/AP_Vehicle.h</a>&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__Logger_8h.html">AP_Logger/AP_Logger.h</a>&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__InertialSensor_8h.html">AP_InertialSensor/AP_InertialSensor.h</a>&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="AP__InternalError_8h.html">AP_InternalError/AP_InternalError.h</a>&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="stdio_8h.html">stdio.h</a>&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#if APM_BUILD_TYPE(APM_BUILD_ArduCopter) || APM_BUILD_TYPE(APM_BUILD_ArduSub)</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#define SCHEDULER_DEFAULT_LOOP_RATE 400</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="AP__Scheduler_8cpp.html#a8bed03ebb2c9cf4622eff2c8eadf8e84">   35</a></span>&#160;<span class="preprocessor">#define SCHEDULER_DEFAULT_LOOP_RATE  50</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="AP__Scheduler_8cpp.html#ac4824dfe0c68ba5d23e776016c6c74d1">   38</a></span>&#160;<span class="preprocessor">#define debug(level, fmt, args...)   do { if ((level) &lt;= _debug.get()) { hal.console-&gt;printf(fmt, ##args); }} while (0)</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">extern</span> <span class="keyword">const</span> <a class="code" href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a>&amp; <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">const</span> <a class="code" href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a> <a class="code" href="classAP__Scheduler.html#a17856eb311134db5b97fa62ca2f8d2f9">AP_Scheduler::var_info</a>[] = {</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">// @Param: DEBUG</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">// @DisplayName: Scheduler debug level</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">// @Description: Set to non-zero to enable scheduler debug messages. When set to show &quot;Slips&quot; the scheduler will display a message whenever a scheduled task is delayed due to too much CPU load. When set to ShowOverruns the scheduled will display a message whenever a task takes longer than the limit promised in the task table.</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="comment">// @Values: 0:Disabled,2:ShowSlips,3:ShowOverruns</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;DEBUG&quot;</span>,    0, <a class="code" href="classAP__Scheduler.html">AP_Scheduler</a>, <a class="code" href="sumd_8cpp.html#abea63a461ba805d7c6c2facc133188c9">_debug</a>, 0),</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// @Param: LOOP_RATE</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">// @DisplayName: Scheduling main loop rate</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="comment">// @Description: This controls the rate of the main control loop in Hz. This should only be changed by developers. This only takes effect on restart. Values over 400 are considered highly experimental.</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="comment">// @Values: 50:50Hz,100:100Hz,200:200Hz,250:250Hz,300:300Hz,400:400Hz</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// @RebootRequired: True</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="comment">// @User: Advanced</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a>(<span class="stringliteral">&quot;LOOP_RATE&quot;</span>,  1, <a class="code" href="classAP__Scheduler.html">AP_Scheduler</a>, _loop_rate_hz, <a class="code" href="AP__Scheduler_8cpp.html#a8bed03ebb2c9cf4622eff2c8eadf8e84">SCHEDULER_DEFAULT_LOOP_RATE</a>),</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;};</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// constructor</span></div><div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classAP__Scheduler.html#aac254dae02458baa122c8f61a8de0bb1">   62</a></span>&#160;<a class="code" href="classAP__Scheduler.html#aac254dae02458baa122c8f61a8de0bb1">AP_Scheduler::AP_Scheduler</a>(scheduler_fastloop_fn_t fastloop_fn) :</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    _fastloop_fn(fastloop_fn)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#ad2c5d0cd7fd4e472a47a9b7112d3bcf6">_singleton</a>) {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#if CONFIG_HAL_BOARD == HAL_BOARD_SITL</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <a class="code" href="namespaceAP__HAL.html#a71832f03d849a0c088f04fc98d3c8143">AP_HAL::panic</a>(<span class="stringliteral">&quot;Too many schedulers&quot;</span>);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    }</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="classAP__Scheduler.html#ad2c5d0cd7fd4e472a47a9b7112d3bcf6">_singleton</a> = <span class="keyword">this</span>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a>(<span class="keyword">this</span>, <a class="code" href="classAP__Scheduler.html#a17856eb311134db5b97fa62ca2f8d2f9">var_info</a>);</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">// only allow 50 to 2000 Hz</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#ac997ff75649d6f705ce8798a02bc7ad1">_loop_rate_hz</a> &lt; 50) {</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="classAP__Scheduler.html#ac997ff75649d6f705ce8798a02bc7ad1">_loop_rate_hz</a>.set(50);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#ac997ff75649d6f705ce8798a02bc7ad1">_loop_rate_hz</a> &gt; 2000) {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        <a class="code" href="classAP__Scheduler.html#ac997ff75649d6f705ce8798a02bc7ad1">_loop_rate_hz</a>.set(2000);</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="classAP__Scheduler.html#a9214183e4771dcc7546e0eb91c814150">_last_loop_time_s</a> = 1.0 / <a class="code" href="classAP__Scheduler.html#ac997ff75649d6f705ce8798a02bc7ad1">_loop_rate_hz</a>;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;}</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"> * Get the AP_Scheduler singleton</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<a class="code" href="classAP__Scheduler.html">AP_Scheduler</a> *<a class="code" href="classAP__Scheduler.html#ad2c5d0cd7fd4e472a47a9b7112d3bcf6">AP_Scheduler::_singleton</a>;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classAP__Scheduler.html#a0826068d9555266bdda5efd19c4b891a">   88</a></span>&#160;<a class="code" href="classAP__Scheduler.html">AP_Scheduler</a> *<a class="code" href="classAP__Scheduler.html#a0826068d9555266bdda5efd19c4b891a">AP_Scheduler::get_singleton</a>()</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;{</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classAP__Scheduler.html#ad2c5d0cd7fd4e472a47a9b7112d3bcf6">_singleton</a>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;}</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">// initialise the scheduler</span></div><div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classAP__Scheduler.html#a602e25048ddab792f4654d17d38e1dd0">   94</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__Scheduler.html#a602e25048ddab792f4654d17d38e1dd0">AP_Scheduler::init</a>(<span class="keyword">const</span> <a class="code" href="structAP__Scheduler_1_1Task.html">AP_Scheduler::Task</a> *tasks, uint8_t num_tasks, uint32_t log_performance_bit)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <a class="code" href="classAP__Scheduler.html#a843cd9988490ee4c6c5f590f3537b43c">_tasks</a> = tasks;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <a class="code" href="classAP__Scheduler.html#a557a774600d808afd5dd15b2791aa88e">_num_tasks</a> = num_tasks;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <a class="code" href="classAP__Scheduler.html#afdcc6b11a2e2ee3392a9ebdf07dffb9f">_last_run</a> = <span class="keyword">new</span> uint16_t[<a class="code" href="classAP__Scheduler.html#a557a774600d808afd5dd15b2791aa88e">_num_tasks</a>];</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    memset(<a class="code" href="classAP__Scheduler.html#afdcc6b11a2e2ee3392a9ebdf07dffb9f">_last_run</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="classAP__Scheduler.html#afdcc6b11a2e2ee3392a9ebdf07dffb9f">_last_run</a>[0]) * <a class="code" href="classAP__Scheduler.html#a557a774600d808afd5dd15b2791aa88e">_num_tasks</a>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="classAP__Scheduler.html#acb1a139e45dbe0c449e6f389cb0a5633">_tick_counter</a> = 0;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">// setup initial performance counters</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="classAP__Scheduler.html#a4ec06632df7f98446d76f5090ca8d43b">perf_info</a>.<a class="code" href="classAP_1_1PerfInfo.html#a629b5da9510f930dda772361776c05b4">set_loop_rate</a>(<a class="code" href="classAP__Scheduler.html#a5de68a6345f4b9ce9eb4008ee4a6c161">get_loop_rate_hz</a>());</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <a class="code" href="classAP__Scheduler.html#a4ec06632df7f98446d76f5090ca8d43b">perf_info</a>.<a class="code" href="classAP_1_1PerfInfo.html#a427d86ad9b709fcec98bc21fbc06da30">reset</a>();</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="classAP__Scheduler.html#a8a6f9248d207fe32900fb8d6bcdfabe9">_log_performance_bit</a> = log_performance_bit;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">// one tick has passed</span></div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="classAP__Scheduler.html#aa4acb0c2d9d1da3af6e8491365e2f29a">  110</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__Scheduler.html#aa4acb0c2d9d1da3af6e8491365e2f29a">AP_Scheduler::tick</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classAP__Scheduler.html#acb1a139e45dbe0c449e6f389cb0a5633">_tick_counter</a>++;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">  run one tick</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">  this will run as many scheduler tasks as we can in the specified time</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00119"></a><span class="lineno"><a class="line" href="classAP__Scheduler.html#a16d85af56e1c52ebe422743580f3a90d">  119</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__Scheduler.html#a16d85af56e1c52ebe422743580f3a90d">AP_Scheduler::run</a>(uint32_t time_available)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    uint32_t run_started_usec = <a class="code" href="namespaceAP__HAL.html#a8293355e35887733b1fd151aef08a787">AP_HAL::micros</a>();</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    uint32_t now = run_started_usec;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#a06fe6da5b571c7725fe1c8534323604e">_debug</a> &gt; 1 &amp;&amp; <a class="code" href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">_perf_counters</a> == <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">_perf_counters</a> = <span class="keyword">new</span> <a class="code" href="classAP__HAL_1_1Util.html#a469e322494f23807b0b1b89b941ac2a6">AP_HAL::Util::perf_counter_t</a>[<a class="code" href="classAP__Scheduler.html#a557a774600d808afd5dd15b2791aa88e">_num_tasks</a>];</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">_perf_counters</a> != <span class="keyword">nullptr</span>) {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code" href="classAP__Scheduler.html#a557a774600d808afd5dd15b2791aa88e">_num_tasks</a>; i++) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                <a class="code" href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">_perf_counters</a>[i] = <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a6b7f7ba5272a4a2f7ae352fe35af90e1">perf_alloc</a>(<a class="code" href="classAP__HAL_1_1Util.html#a728035ef0889404b89a7bc05ab53818ea61efbe28519285a31c90582c6a36c6b1">AP_HAL::Util::PC_ELAPSED</a>, <a class="code" href="classAP__Scheduler.html#a843cd9988490ee4c6c5f590f3537b43c">_tasks</a>[i].<a class="code" href="BusTest_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    </div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">for</span> (uint8_t i=0; i&lt;<a class="code" href="classAP__Scheduler.html#a557a774600d808afd5dd15b2791aa88e">_num_tasks</a>; i++) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        uint16_t dt = <a class="code" href="classAP__Scheduler.html#acb1a139e45dbe0c449e6f389cb0a5633">_tick_counter</a> - <a class="code" href="classAP__Scheduler.html#afdcc6b11a2e2ee3392a9ebdf07dffb9f">_last_run</a>[i];</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        uint16_t interval_ticks = <a class="code" href="classAP__Scheduler.html#ac997ff75649d6f705ce8798a02bc7ad1">_loop_rate_hz</a> / <a class="code" href="classAP__Scheduler.html#a843cd9988490ee4c6c5f590f3537b43c">_tasks</a>[i].<a class="code" href="structAP__Scheduler_1_1Task.html#ac36c77bd5732d346601c8ff2e1dbfa88">rate_hz</a>;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">if</span> (interval_ticks &lt; 1) {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            interval_ticks = 1;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">if</span> (dt &lt; interval_ticks) {</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            <span class="comment">// this task is not yet scheduled to run again</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="comment">// this task is due to run. Do we have enough time to run it?</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <a class="code" href="classAP__Scheduler.html#ac20e0a677da03d415b99d0413ce631ae">_task_time_allowed</a> = <a class="code" href="classAP__Scheduler.html#a843cd9988490ee4c6c5f590f3537b43c">_tasks</a>[i].<a class="code" href="structAP__Scheduler_1_1Task.html#ab9fbd24b9c70e16354d8d0947fe69384">max_time_micros</a>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span> (dt &gt;= interval_ticks*2) {</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <span class="comment">// we&#39;ve slipped a whole run of this task!</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;            <a class="code" href="AP__Scheduler_8cpp.html#ac4824dfe0c68ba5d23e776016c6c74d1">debug</a>(2, <span class="stringliteral">&quot;Scheduler slip task[%u-%s] (%u/%u/%u)\n&quot;</span>,</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                  (<span class="keywordtype">unsigned</span>)i,</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                  <a class="code" href="classAP__Scheduler.html#a843cd9988490ee4c6c5f590f3537b43c">_tasks</a>[i].<a class="code" href="BusTest_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                  (<span class="keywordtype">unsigned</span>)dt,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                  (<span class="keywordtype">unsigned</span>)interval_ticks,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                  (<span class="keywordtype">unsigned</span>)<a class="code" href="classAP__Scheduler.html#ac20e0a677da03d415b99d0413ce631ae">_task_time_allowed</a>);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#ac20e0a677da03d415b99d0413ce631ae">_task_time_allowed</a> &gt; time_available) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="comment">// not enough time to run this task.  Continue loop -</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="comment">// maybe another task will fit into time remaining</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="comment">// run it</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <a class="code" href="classAP__Scheduler.html#a141789568619b15a4f5b536f819a95a3">_task_time_started</a> = now;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a64273fdab59825cea305a403054c25bf">persistent_data</a>.<a class="code" href="structAP__HAL_1_1Util_1_1PersistentData.html#aa9f24b2ec5b919e948745878c8d96f59">scheduler_task</a> = i;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#a06fe6da5b571c7725fe1c8534323604e">_debug</a> &gt; 1 &amp;&amp; <a class="code" href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">_perf_counters</a> &amp;&amp; <a class="code" href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">_perf_counters</a>[i]) {</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a8ee016bee7e471240be5a2c648015a1d">perf_begin</a>(<a class="code" href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">_perf_counters</a>[i]);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        }</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="classAP__Scheduler.html#a843cd9988490ee4c6c5f590f3537b43c">_tasks</a>[i].<a class="code" href="structAP__Scheduler_1_1Task.html#ae8b2138ab213591aaa1a639a8101df79">function</a>();</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#a06fe6da5b571c7725fe1c8534323604e">_debug</a> &gt; 1 &amp;&amp; <a class="code" href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">_perf_counters</a> &amp;&amp; <a class="code" href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">_perf_counters</a>[i]) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a831bf144a4d14d413bd1c98b96dc35cb">perf_end</a>(<a class="code" href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">_perf_counters</a>[i]);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a64273fdab59825cea305a403054c25bf">persistent_data</a>.<a class="code" href="structAP__HAL_1_1Util_1_1PersistentData.html#aa9f24b2ec5b919e948745878c8d96f59">scheduler_task</a> = -1;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment">// record the tick counter when we ran. This drives</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// when we next run the event</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <a class="code" href="classAP__Scheduler.html#afdcc6b11a2e2ee3392a9ebdf07dffb9f">_last_run</a>[i] = <a class="code" href="classAP__Scheduler.html#acb1a139e45dbe0c449e6f389cb0a5633">_tick_counter</a>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">// work out how long the event actually took</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        now = <a class="code" href="namespaceAP__HAL.html#a8293355e35887733b1fd151aef08a787">AP_HAL::micros</a>();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        uint32_t time_taken = now - <a class="code" href="classAP__Scheduler.html#a141789568619b15a4f5b536f819a95a3">_task_time_started</a>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">if</span> (time_taken &gt; <a class="code" href="classAP__Scheduler.html#ac20e0a677da03d415b99d0413ce631ae">_task_time_allowed</a>) {</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="comment">// the event overran!</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <a class="code" href="AP__Scheduler_8cpp.html#ac4824dfe0c68ba5d23e776016c6c74d1">debug</a>(3, <span class="stringliteral">&quot;Scheduler overrun task[%u-%s] (%u/%u)\n&quot;</span>,</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                  (<span class="keywordtype">unsigned</span>)i,</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                  <a class="code" href="classAP__Scheduler.html#a843cd9988490ee4c6c5f590f3537b43c">_tasks</a>[i].<a class="code" href="BusTest_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>,</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                  (<span class="keywordtype">unsigned</span>)time_taken,</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                  (<span class="keywordtype">unsigned</span>)<a class="code" href="classAP__Scheduler.html#ac20e0a677da03d415b99d0413ce631ae">_task_time_allowed</a>);</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span> (time_taken &gt;= time_available) {</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            time_available = 0;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        time_available -= time_taken;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// update number of spare microseconds</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="classAP__Scheduler.html#a6b26e7c51345c849165f4d2914b664f1">_spare_micros</a> += time_available;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="classAP__Scheduler.html#aa208b64f15deebbd5e72fe25b2a55f24">_spare_ticks</a>++;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#aa208b64f15deebbd5e72fe25b2a55f24">_spare_ticks</a> == 32) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <a class="code" href="classAP__Scheduler.html#aa208b64f15deebbd5e72fe25b2a55f24">_spare_ticks</a> /= 2;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="classAP__Scheduler.html#a6b26e7c51345c849165f4d2914b664f1">_spare_micros</a> /= 2;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">  return number of micros until the current task reaches its deadline</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00210"></a><span class="lineno"><a class="line" href="classAP__Scheduler.html#a8e7219b4917480f699f9bfcec582fa11">  210</a></span>&#160;uint16_t <a class="code" href="classAP__Scheduler.html#a8e7219b4917480f699f9bfcec582fa11">AP_Scheduler::time_available_usec</a>(<span class="keywordtype">void</span>)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;{</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    uint32_t dt = <a class="code" href="namespaceAP__HAL.html#a8293355e35887733b1fd151aef08a787">AP_HAL::micros</a>() - <a class="code" href="classAP__Scheduler.html#a141789568619b15a4f5b536f819a95a3">_task_time_started</a>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span> (dt &gt; <a class="code" href="classAP__Scheduler.html#ac20e0a677da03d415b99d0413ce631ae">_task_time_allowed</a>) {</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classAP__Scheduler.html#ac20e0a677da03d415b99d0413ce631ae">_task_time_allowed</a> - dt;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;}</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">  calculate load average as a number from 0 to 1</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00222"></a><span class="lineno"><a class="line" href="classAP__Scheduler.html#abda29cac2f54d56ff8bf7791a6667a9c">  222</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classAP__Scheduler.html#abda29cac2f54d56ff8bf7791a6667a9c">AP_Scheduler::load_average</a>()</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#aa208b64f15deebbd5e72fe25b2a55f24">_spare_ticks</a> == 0) {</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keywordflow">return</span> 0.0f;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">const</span> uint32_t loop_us = <a class="code" href="classAP__Scheduler.html#a6ea2df59d699e91c31e1688ded595f1c">get_loop_period_us</a>();</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keyword">const</span> uint32_t used_time = loop_us - (<a class="code" href="classAP__Scheduler.html#a6b26e7c51345c849165f4d2914b664f1">_spare_micros</a>/<a class="code" href="classAP__Scheduler.html#aa208b64f15deebbd5e72fe25b2a55f24">_spare_ticks</a>);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">return</span> used_time / (float)loop_us;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;</div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="classAP__Scheduler.html#a8d5eeba086253d166ac8f195f39868b6">  232</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__Scheduler.html#a8d5eeba086253d166ac8f195f39868b6">AP_Scheduler::loop</a>()</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;{</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// wait for an INS sample</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a64273fdab59825cea305a403054c25bf">persistent_data</a>.<a class="code" href="structAP__HAL_1_1Util_1_1PersistentData.html#aa9f24b2ec5b919e948745878c8d96f59">scheduler_task</a> = -3;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="namespaceAP.html#ac571aa5a2ef71b7f4b4b2bfa09143fb9">AP::ins</a>().<a class="code" href="classAP__InertialSensor.html#aa4faf114689e827390b5da7bc6fd5f20">wait_for_sample</a>();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a64273fdab59825cea305a403054c25bf">persistent_data</a>.<a class="code" href="structAP__HAL_1_1Util_1_1PersistentData.html#aa9f24b2ec5b919e948745878c8d96f59">scheduler_task</a> = -1;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keyword">const</span> uint32_t sample_time_us = <a class="code" href="namespaceAP__HAL.html#a8293355e35887733b1fd151aef08a787">AP_HAL::micros</a>();</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#a0453a692bad08260da3b146ebc3ddafa">_loop_timer_start_us</a> == 0) {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="classAP__Scheduler.html#a0453a692bad08260da3b146ebc3ddafa">_loop_timer_start_us</a> = sample_time_us;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <a class="code" href="classAP__Scheduler.html#a9214183e4771dcc7546e0eb91c814150">_last_loop_time_s</a> = <a class="code" href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">get_loop_period_s</a>();</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <a class="code" href="classAP__Scheduler.html#a9214183e4771dcc7546e0eb91c814150">_last_loop_time_s</a> = (sample_time_us - <a class="code" href="classAP__Scheduler.html#a0453a692bad08260da3b146ebc3ddafa">_loop_timer_start_us</a>) * 1.0e-6;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="comment">// Execute the fast loop</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">// ---------------------</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#ac8372d227a3ce3609bc361a8e0b55c17">_fastloop_fn</a>) {</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a64273fdab59825cea305a403054c25bf">persistent_data</a>.<a class="code" href="structAP__HAL_1_1Util_1_1PersistentData.html#aa9f24b2ec5b919e948745878c8d96f59">scheduler_task</a> = -2;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="code" href="classAP__Scheduler.html#ac8372d227a3ce3609bc361a8e0b55c17">_fastloop_fn</a>();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a64273fdab59825cea305a403054c25bf">persistent_data</a>.<a class="code" href="structAP__HAL_1_1Util_1_1PersistentData.html#aa9f24b2ec5b919e948745878c8d96f59">scheduler_task</a> = -1;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="comment">// tell the scheduler one tick has passed</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <a class="code" href="classAP__Scheduler.html#aa4acb0c2d9d1da3af6e8491365e2f29a">tick</a>();</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// run all the tasks that are due to run. Note that we only</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="comment">// have to call this once per loop, as the tasks are scheduled</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// in multiples of the main loop tick. So if they don&#39;t run on</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// the first call to the scheduler they won&#39;t run on a later</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// call until scheduler.tick() is called again</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">const</span> uint32_t loop_us = <a class="code" href="classAP__Scheduler.html#a6ea2df59d699e91c31e1688ded595f1c">get_loop_period_us</a>();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keyword">const</span> uint32_t time_available = (sample_time_us + loop_us) - <a class="code" href="namespaceAP__HAL.html#a8293355e35887733b1fd151aef08a787">AP_HAL::micros</a>();</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <a class="code" href="classAP__Scheduler.html#a16d85af56e1c52ebe422743580f3a90d">run</a>(time_available &gt; loop_us ? 0u : time_available);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="preprocessor">#if CONFIG_HAL_BOARD == HAL_BOARD_SITL</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// move result of AP_HAL::micros() forward:</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">scheduler</a>-&gt;<a class="code" href="classAP__HAL_1_1Scheduler.html#a78c4f1b1f192ac1c99544b6cc8f099b0">delay_microseconds</a>(1);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="comment">// check loop time</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="classAP__Scheduler.html#a4ec06632df7f98446d76f5090ca8d43b">perf_info</a>.<a class="code" href="classAP_1_1PerfInfo.html#a800eed07b994dcd081eb9b84b0ad50fd">check_loop_time</a>(sample_time_us - <a class="code" href="classAP__Scheduler.html#a0453a692bad08260da3b146ebc3ddafa">_loop_timer_start_us</a>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="classAP__Scheduler.html#a0453a692bad08260da3b146ebc3ddafa">_loop_timer_start_us</a> = sample_time_us;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classAP__Scheduler.html#a463067370e88bd3c15d98b6e61abde41">  279</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__Scheduler.html#a463067370e88bd3c15d98b6e61abde41">AP_Scheduler::update_logging</a>()</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#a755c219d23048f50b580fd0491a36d7f">debug_flags</a>()) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <a class="code" href="classAP__Scheduler.html#a4ec06632df7f98446d76f5090ca8d43b">perf_info</a>.<a class="code" href="classAP_1_1PerfInfo.html#aa206e0cddd2693793323542bbf219739">update_logging</a>();</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAP__Scheduler.html#a8a6f9248d207fe32900fb8d6bcdfabe9">_log_performance_bit</a> != (uint32_t)-1 &amp;&amp;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <a class="code" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().should_log(<a class="code" href="classAP__Scheduler.html#a8a6f9248d207fe32900fb8d6bcdfabe9">_log_performance_bit</a>)) {</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <a class="code" href="classAP__Scheduler.html#ab5ad36aaa0e937f3a3b2ef1a5e45d749">Log_Write_Performance</a>();</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="classAP__Scheduler.html#a4ec06632df7f98446d76f5090ca8d43b">perf_info</a>.<a class="code" href="classAP_1_1PerfInfo.html#a629b5da9510f930dda772361776c05b4">set_loop_rate</a>(<a class="code" href="classAP__Scheduler.html#a5de68a6345f4b9ce9eb4008ee4a6c161">get_loop_rate_hz</a>());</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="classAP__Scheduler.html#a4ec06632df7f98446d76f5090ca8d43b">perf_info</a>.<a class="code" href="classAP_1_1PerfInfo.html#a427d86ad9b709fcec98bc21fbc06da30">reset</a>();</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;}</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">// Write a performance monitoring packet</span></div><div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="classAP__Scheduler.html#ab5ad36aaa0e937f3a3b2ef1a5e45d749">  293</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAP__Scheduler.html#ab5ad36aaa0e937f3a3b2ef1a5e45d749">AP_Scheduler::Log_Write_Performance</a>()</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keyword">const</span> <a class="code" href="structAP__HAL_1_1Util_1_1PersistentData.html">AP_HAL::Util::PersistentData</a> &amp;pd = <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a64273fdab59825cea305a403054c25bf">persistent_data</a>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keyword">struct </span><a class="code" href="structlog__Performance.html">log_Performance</a> pkt = {</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <a class="code" href="LogStructure_8h.html#abca6b52da10346c72b10dd04698e4420">LOG_PACKET_HEADER_INIT</a>(<a class="code" href="LogStructure_8h.html#aec1abc8a4fd0e25bbcf703a19b991a05a5c30960f9c243575ee6953a9894c428d">LOG_PERFORMANCE_MSG</a>),</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <a class="code" href="structlog__Performance.html#ad227529b83333ec9024f8163f1ad2339">time_us</a>          : <a class="code" href="namespaceAP__HAL.html#a7aa0ce7625c9680e30ff4a99940907a5">AP_HAL::micros64</a>(),</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="structlog__Performance.html#a5094da8d69f342c3fc8576c309ec3939">num_long_running</a> : <a class="code" href="classAP__Scheduler.html#a4ec06632df7f98446d76f5090ca8d43b">perf_info</a>.<a class="code" href="classAP_1_1PerfInfo.html#a35fb1b18a36c6e3294f4ac4915f292ae">get_num_long_running</a>(),</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <a class="code" href="structlog__Performance.html#ae35438bc4cdd512c413c71875d5e8528">num_loops</a>        : <a class="code" href="classAP__Scheduler.html#a4ec06632df7f98446d76f5090ca8d43b">perf_info</a>.<a class="code" href="classAP_1_1PerfInfo.html#a25542256993be3838d25c40707791060">get_num_loops</a>(),</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <a class="code" href="structlog__Performance.html#abc5d61532f499ee7431c1d4c1aa6316f">max_time</a>         : <a class="code" href="classAP__Scheduler.html#a4ec06632df7f98446d76f5090ca8d43b">perf_info</a>.<a class="code" href="classAP_1_1PerfInfo.html#a9a6c1174425ac173efb2acf8b82c0e0a">get_max_time</a>(),</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <a class="code" href="structlog__Performance.html#a665c4e2659c7a100d8342d1cb0750ddb">mem_avail</a>        : <a class="code" href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a>.<a class="code" href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">util</a>-&gt;<a class="code" href="classAP__HAL_1_1Util.html#a2a2e64f649d25593951054d44c0ed53b">available_memory</a>(),</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="structlog__Performance.html#a6871da3747262e21e06851aebf5fdb47">load</a>             : (uint16_t)(<a class="code" href="classAP__Scheduler.html#abda29cac2f54d56ff8bf7791a6667a9c">load_average</a>() * 1000),</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <a class="code" href="structlog__Performance.html#a375fce4cc2b5558e77ddf903e9c7f11d">internal_errors</a>  : <a class="code" href="namespaceAP.html#afceb236ff617aaaa2b08afacd72532b0">AP::internalerror</a>().<a class="code" href="classAP__InternalError.html#a4396aa49ba2d14f80df61bfbd9c17de3">errors</a>(),</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        <a class="code" href="structlog__Performance.html#a601db2fc5536ef85c0887b107cdd825c">internal_error_count</a> : <a class="code" href="namespaceAP.html#afceb236ff617aaaa2b08afacd72532b0">AP::internalerror</a>().<a class="code" href="classAP__InternalError.html#a1f7f14a65194ec4df6fb0f155f59a55a">count</a>(),</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <a class="code" href="structlog__Performance.html#a1827604a61a57494fee2cd7478e839cb">spi_count</a>        : pd.<a class="code" href="structAP__HAL_1_1Util_1_1PersistentData.html#a4f5c879b244083730a42e902fd307fad">spi_count</a>,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <a class="code" href="structlog__Performance.html#a423f53fecc28c605350c35fd67f0c7a4">i2c_count</a>        : pd.<a class="code" href="structAP__HAL_1_1Util_1_1PersistentData.html#a6fae0db0f91fce53a13ff9e25f74e058">i2c_count</a>,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    };</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <a class="code" href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a>().<a class="code" href="classAP__Logger.html#a32f5822b72789c7c83402b2af7544d09">WriteCriticalBlock</a>(&amp;pkt, <span class="keyword">sizeof</span>(pkt));</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceAP.html">AP</a> {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">  314</a></span>&#160;<a class="code" href="classAP__Scheduler.html">AP_Scheduler</a> &amp;<a class="code" href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">scheduler</a>()</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;{</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keywordflow">return</span> *<a class="code" href="classAP__Scheduler.html#a0826068d9555266bdda5efd19c4b891a">AP_Scheduler::get_singleton</a>();</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;}</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;};</div><div class="ttc" id="structAP__Scheduler_1_1Task_html_ac36c77bd5732d346601c8ff2e1dbfa88"><div class="ttname"><a href="structAP__Scheduler_1_1Task.html#ac36c77bd5732d346601c8ff2e1dbfa88">AP_Scheduler::Task::rate_hz</a></div><div class="ttdeci">float rate_hz</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00073">AP_Scheduler.h:73</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_ad2c5d0cd7fd4e472a47a9b7112d3bcf6"><div class="ttname"><a href="classAP__Scheduler.html#ad2c5d0cd7fd4e472a47a9b7112d3bcf6">AP_Scheduler::_singleton</a></div><div class="ttdeci">static AP_Scheduler * _singleton</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00066">AP_Scheduler.h:66</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Util_html_a2a2e64f649d25593951054d44c0ed53b"><div class="ttname"><a href="classAP__HAL_1_1Util.html#a2a2e64f649d25593951054d44c0ed53b">AP_HAL::Util::available_memory</a></div><div class="ttdeci">virtual uint32_t available_memory(void)</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00153">Util.h:153</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_ac8372d227a3ce3609bc361a8e0b55c17"><div class="ttname"><a href="classAP__Scheduler.html#ac8372d227a3ce3609bc361a8e0b55c17">AP_Scheduler::_fastloop_fn</a></div><div class="ttdeci">scheduler_fastloop_fn_t _fastloop_fn</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00150">AP_Scheduler.h:150</a></div></div>
<div class="ttc" id="classAP__Logger_html_a32f5822b72789c7c83402b2af7544d09"><div class="ttname"><a href="classAP__Logger.html#a32f5822b72789c7c83402b2af7544d09">AP_Logger::WriteCriticalBlock</a></div><div class="ttdeci">void WriteCriticalBlock(const void *pBuffer, uint16_t size)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Logger_8cpp_source.html#l00582">AP_Logger.cpp:582</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a755c219d23048f50b580fd0491a36d7f"><div class="ttname"><a href="classAP__Scheduler.html#a755c219d23048f50b580fd0491a36d7f">AP_Scheduler::debug_flags</a></div><div class="ttdeci">uint8_t debug_flags(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00105">AP_Scheduler.h:105</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Util_html_a6b7f7ba5272a4a2f7ae352fe35af90e1"><div class="ttname"><a href="classAP__HAL_1_1Util.html#a6b7f7ba5272a4a2f7ae352fe35af90e1">AP_HAL::Util::perf_alloc</a></div><div class="ttdeci">virtual perf_counter_t perf_alloc(perf_counter_type t, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00131">Util.h:131</a></div></div>
<div class="ttc" id="AP__InternalError_8h_html"><div class="ttname"><a href="AP__InternalError_8h.html">AP_InternalError.h</a></div></div>
<div class="ttc" id="structAP__HAL_1_1Util_1_1PersistentData_html_aa9f24b2ec5b919e948745878c8d96f59"><div class="ttname"><a href="structAP__HAL_1_1Util_1_1PersistentData.html#aa9f24b2ec5b919e948745878c8d96f59">AP_HAL::Util::PersistentData::scheduler_task</a></div><div class="ttdeci">int8_t scheduler_task</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00063">Util.h:63</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_abda29cac2f54d56ff8bf7791a6667a9c"><div class="ttname"><a href="classAP__Scheduler.html#abda29cac2f54d56ff8bf7791a6667a9c">AP_Scheduler::load_average</a></div><div class="ttdeci">float load_average()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00222">AP_Scheduler.cpp:222</a></div></div>
<div class="ttc" id="AP__HAL_8h_html"><div class="ttname"><a href="AP__HAL_8h.html">AP_HAL.h</a></div></div>
<div class="ttc" id="classAP__Scheduler_html"><div class="ttname"><a href="classAP__Scheduler.html">AP_Scheduler</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00053">AP_Scheduler.h:53</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a5de68a6345f4b9ce9eb4008ee4a6c161"><div class="ttname"><a href="classAP__Scheduler.html#a5de68a6345f4b9ce9eb4008ee4a6c161">AP_Scheduler::get_loop_rate_hz</a></div><div class="ttdeci">uint16_t get_loop_rate_hz(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00113">AP_Scheduler.h:113</a></div></div>
<div class="ttc" id="namespaceAP_html_afceb236ff617aaaa2b08afacd72532b0"><div class="ttname"><a href="namespaceAP.html#afceb236ff617aaaa2b08afacd72532b0">AP::internalerror</a></div><div class="ttdeci">AP_InternalError &amp; internalerror()</div><div class="ttdef"><b>Definition:</b> <a href="AP__InternalError_8cpp_source.html#l00031">AP_InternalError.cpp:31</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_ac997ff75649d6f705ce8798a02bc7ad1"><div class="ttname"><a href="classAP__Scheduler.html#ac997ff75649d6f705ce8798a02bc7ad1">AP_Scheduler::_loop_rate_hz</a></div><div class="ttdeci">AP_Int16 _loop_rate_hz</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00156">AP_Scheduler.h:156</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a463067370e88bd3c15d98b6e61abde41"><div class="ttname"><a href="classAP__Scheduler.html#a463067370e88bd3c15d98b6e61abde41">AP_Scheduler::update_logging</a></div><div class="ttdeci">void update_logging()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00279">AP_Scheduler.cpp:279</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a6ea2df59d699e91c31e1688ded595f1c"><div class="ttname"><a href="classAP__Scheduler.html#a6ea2df59d699e91c31e1688ded595f1c">AP_Scheduler::get_loop_period_us</a></div><div class="ttdeci">uint32_t get_loop_period_us()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00120">AP_Scheduler.h:120</a></div></div>
<div class="ttc" id="classAP__InternalError_html_a1f7f14a65194ec4df6fb0f155f59a55a"><div class="ttname"><a href="classAP__InternalError.html#a1f7f14a65194ec4df6fb0f155f59a55a">AP_InternalError::count</a></div><div class="ttdeci">uint32_t count() const</div><div class="ttdef"><b>Definition:</b> <a href="AP__InternalError_8h_source.html#l00058">AP_InternalError.h:58</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a82db30c491d6a4eb2a2c34750d7a1de5"><div class="ttname"><a href="classAP__Scheduler.html#a82db30c491d6a4eb2a2c34750d7a1de5">AP_Scheduler::get_loop_period_s</a></div><div class="ttdeci">float get_loop_period_s()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00127">AP_Scheduler.h:127</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a78a408c84f2a1bafde256ac650142e4d"><div class="ttname"><a href="AP__Param_8h.html#a78a408c84f2a1bafde256ac650142e4d">AP_GROUPINFO</a></div><div class="ttdeci">#define AP_GROUPINFO(name, idx, clazz, element, def)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00100">AP_Param.h:100</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a602e25048ddab792f4654d17d38e1dd0"><div class="ttname"><a href="classAP__Scheduler.html#a602e25048ddab792f4654d17d38e1dd0">AP_Scheduler::init</a></div><div class="ttdeci">void init(const Task *tasks, uint8_t num_tasks, uint32_t log_performance_bit)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00094">AP_Scheduler.cpp:94</a></div></div>
<div class="ttc" id="classAP_1_1PerfInfo_html_a25542256993be3838d25c40707791060"><div class="ttname"><a href="classAP_1_1PerfInfo.html#a25542256993be3838d25c40707791060">AP::PerfInfo::get_num_loops</a></div><div class="ttdeci">uint16_t get_num_loops() const</div><div class="ttdef"><b>Definition:</b> <a href="PerfInfo_8cpp_source.html#l00073">PerfInfo.cpp:73</a></div></div>
<div class="ttc" id="structlog__Performance_html_ad227529b83333ec9024f8163f1ad2339"><div class="ttname"><a href="structlog__Performance.html#ad227529b83333ec9024f8163f1ad2339">log_Performance::time_us</a></div><div class="ttdeci">uint64_t time_us</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01106">LogStructure.h:1106</a></div></div>
<div class="ttc" id="AP__Logger_8h_html"><div class="ttname"><a href="AP__Logger_8h.html">AP_Logger.h</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a9337a60383f4264fa96a20dbe43a4e2e"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a9337a60383f4264fa96a20dbe43a4e2e">AP_HAL::HAL::util</a></div><div class="ttdeci">AP_HAL::Util * util</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00115">HAL.h:115</a></div></div>
<div class="ttc" id="structlog__Performance_html_a423f53fecc28c605350c35fd67f0c7a4"><div class="ttname"><a href="structlog__Performance.html#a423f53fecc28c605350c35fd67f0c7a4">log_Performance::i2c_count</a></div><div class="ttdeci">uint32_t i2c_count</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01115">LogStructure.h:1115</a></div></div>
<div class="ttc" id="sumd_8cpp_html_abea63a461ba805d7c6c2facc133188c9"><div class="ttname"><a href="sumd_8cpp.html#abea63a461ba805d7c6c2facc133188c9">_debug</a></div><div class="ttdeci">static bool _debug</div><div class="ttdef"><b>Definition:</b> <a href="sumd_8cpp_source.html#l00100">sumd.cpp:100</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a6905e4a28913bce8c8a26342967ac0e4"><div class="ttname"><a href="classAP__Scheduler.html#a6905e4a28913bce8c8a26342967ac0e4">AP_Scheduler::_perf_counters</a></div><div class="ttdeci">AP_HAL::Util::perf_counter_t * _perf_counters</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00199">AP_Scheduler.h:199</a></div></div>
<div class="ttc" id="structlog__Performance_html_a5094da8d69f342c3fc8576c309ec3939"><div class="ttname"><a href="structlog__Performance.html#a5094da8d69f342c3fc8576c309ec3939">log_Performance::num_long_running</a></div><div class="ttdeci">uint16_t num_long_running</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01107">LogStructure.h:1107</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Util_html_a728035ef0889404b89a7bc05ab53818ea61efbe28519285a31c90582c6a36c6b1"><div class="ttname"><a href="classAP__HAL_1_1Util.html#a728035ef0889404b89a7bc05ab53818ea61efbe28519285a31c90582c6a36c6b1">AP_HAL::Util::PC_ELAPSED</a></div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00127">Util.h:127</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a6b26e7c51345c849165f4d2914b664f1"><div class="ttname"><a href="classAP__Scheduler.html#a6b26e7c51345c849165f4d2914b664f1">AP_Scheduler::_spare_micros</a></div><div class="ttdeci">uint32_t _spare_micros</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00187">AP_Scheduler.h:187</a></div></div>
<div class="ttc" id="BusTest_8cpp_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="BusTest_8cpp.html#a8f8f80d37794cde9472343e4487ba3eb">name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="BusTest_8cpp_source.html#l00011">BusTest.cpp:11</a></div></div>
<div class="ttc" id="structlog__Performance_html_ae35438bc4cdd512c413c71875d5e8528"><div class="ttname"><a href="structlog__Performance.html#ae35438bc4cdd512c413c71875d5e8528">log_Performance::num_loops</a></div><div class="ttdeci">uint16_t num_loops</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01108">LogStructure.h:1108</a></div></div>
<div class="ttc" id="structlog__Performance_html_a665c4e2659c7a100d8342d1cb0750ddb"><div class="ttname"><a href="structlog__Performance.html#a665c4e2659c7a100d8342d1cb0750ddb">log_Performance::mem_avail</a></div><div class="ttdeci">uint32_t mem_avail</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01110">LogStructure.h:1110</a></div></div>
<div class="ttc" id="structlog__Performance_html_a375fce4cc2b5558e77ddf903e9c7f11d"><div class="ttname"><a href="structlog__Performance.html#a375fce4cc2b5558e77ddf903e9c7f11d">log_Performance::internal_errors</a></div><div class="ttdeci">uint32_t internal_errors</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01112">LogStructure.h:1112</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a0826068d9555266bdda5efd19c4b891a"><div class="ttname"><a href="classAP__Scheduler.html#a0826068d9555266bdda5efd19c4b891a">AP_Scheduler::get_singleton</a></div><div class="ttdeci">static AP_Scheduler * get_singleton()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00088">AP_Scheduler.cpp:88</a></div></div>
<div class="ttc" id="AP__InertialSensor_8h_html"><div class="ttname"><a href="AP__InertialSensor_8h.html">AP_InertialSensor.h</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_ac20e0a677da03d415b99d0413ce631ae"><div class="ttname"><a href="classAP__Scheduler.html#ac20e0a677da03d415b99d0413ce631ae">AP_Scheduler::_task_time_allowed</a></div><div class="ttdeci">uint32_t _task_time_allowed</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00181">AP_Scheduler.h:181</a></div></div>
<div class="ttc" id="LogStructure_8h_html_aec1abc8a4fd0e25bbcf703a19b991a05a5c30960f9c243575ee6953a9894c428d"><div class="ttname"><a href="LogStructure_8h.html#aec1abc8a4fd0e25bbcf703a19b991a05a5c30960f9c243575ee6953a9894c428d">LOG_PERFORMANCE_MSG</a></div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01690">LogStructure.h:1690</a></div></div>
<div class="ttc" id="AP__Param_8h_html"><div class="ttname"><a href="AP__Param_8h.html">AP_Param.h</a></div><div class="ttdoc">A system for managing and storing variables that are of general interest to the system.</div></div>
<div class="ttc" id="namespaceAP_html_aa35bfac1ea2da16f110e8e72db7b3b20"><div class="ttname"><a href="namespaceAP.html#aa35bfac1ea2da16f110e8e72db7b3b20">AP::logger</a></div><div class="ttdeci">AP_Logger &amp; logger()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Logger_8cpp_source.html#l01182">AP_Logger.cpp:1182</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a557a774600d808afd5dd15b2791aa88e"><div class="ttname"><a href="classAP__Scheduler.html#a557a774600d808afd5dd15b2791aa88e">AP_Scheduler::_num_tasks</a></div><div class="ttdeci">uint8_t _num_tasks</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00171">AP_Scheduler.h:171</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a16d85af56e1c52ebe422743580f3a90d"><div class="ttname"><a href="classAP__Scheduler.html#a16d85af56e1c52ebe422743580f3a90d">AP_Scheduler::run</a></div><div class="ttdeci">void run(uint32_t time_available)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00119">AP_Scheduler.cpp:119</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html"><div class="ttname"><a href="classAP__HAL_1_1HAL.html">AP_HAL::HAL</a></div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00021">HAL.h:21</a></div></div>
<div class="ttc" id="namespaceAP_html"><div class="ttname"><a href="namespaceAP.html">AP</a></div><div class="ttdef"><b>Definition:</b> <a href="AC__Avoid_8cpp_source.html#l00655">AC_Avoid.cpp:655</a></div></div>
<div class="ttc" id="AP__Scheduler_8cpp_html_ac4824dfe0c68ba5d23e776016c6c74d1"><div class="ttname"><a href="AP__Scheduler_8cpp.html#ac4824dfe0c68ba5d23e776016c6c74d1">debug</a></div><div class="ttdeci">#define debug(level, fmt, args...)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00038">AP_Scheduler.cpp:38</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Util_html_a469e322494f23807b0b1b89b941ac2a6"><div class="ttname"><a href="classAP__HAL_1_1Util.html#a469e322494f23807b0b1b89b941ac2a6">AP_HAL::Util::perf_counter_t</a></div><div class="ttdeci">void * perf_counter_t</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00130">Util.h:130</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_afdcc6b11a2e2ee3392a9ebdf07dffb9f"><div class="ttname"><a href="classAP__Scheduler.html#afdcc6b11a2e2ee3392a9ebdf07dffb9f">AP_Scheduler::_last_run</a></div><div class="ttdeci">uint16_t * _last_run</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00178">AP_Scheduler.h:178</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a8a6f9248d207fe32900fb8d6bcdfabe9"><div class="ttname"><a href="classAP__Scheduler.html#a8a6f9248d207fe32900fb8d6bcdfabe9">AP_Scheduler::_log_performance_bit</a></div><div class="ttdeci">uint32_t _log_performance_bit</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00202">AP_Scheduler.h:202</a></div></div>
<div class="ttc" id="classAP_1_1PerfInfo_html_a800eed07b994dcd081eb9b84b0ad50fd"><div class="ttname"><a href="classAP_1_1PerfInfo.html#a800eed07b994dcd081eb9b84b0ad50fd">AP::PerfInfo::check_loop_time</a></div><div class="ttdeci">void check_loop_time(uint32_t time_in_micros)</div><div class="ttdef"><b>Definition:</b> <a href="PerfInfo_8cpp_source.html#l00032">PerfInfo.cpp:32</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_aa4acb0c2d9d1da3af6e8491365e2f29a"><div class="ttname"><a href="classAP__Scheduler.html#aa4acb0c2d9d1da3af6e8491365e2f29a">AP_Scheduler::tick</a></div><div class="ttdeci">void tick(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00110">AP_Scheduler.cpp:110</a></div></div>
<div class="ttc" id="structAP__Scheduler_1_1Task_html_ab9fbd24b9c70e16354d8d0947fe69384"><div class="ttname"><a href="structAP__Scheduler_1_1Task.html#ab9fbd24b9c70e16354d8d0947fe69384">AP_Scheduler::Task::max_time_micros</a></div><div class="ttdeci">uint16_t max_time_micros</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00074">AP_Scheduler.h:74</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a06fe6da5b571c7725fe1c8534323604e"><div class="ttname"><a href="classAP__Scheduler.html#a06fe6da5b571c7725fe1c8534323604e">AP_Scheduler::_debug</a></div><div class="ttdeci">AP_Int8 _debug</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00153">AP_Scheduler.h:153</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_ab5ad36aaa0e937f3a3b2ef1a5e45d749"><div class="ttname"><a href="classAP__Scheduler.html#ab5ad36aaa0e937f3a3b2ef1a5e45d749">AP_Scheduler::Log_Write_Performance</a></div><div class="ttdeci">void Log_Write_Performance()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00293">AP_Scheduler.cpp:293</a></div></div>
<div class="ttc" id="classAP_1_1PerfInfo_html_a629b5da9510f930dda772361776c05b4"><div class="ttname"><a href="classAP_1_1PerfInfo.html#a629b5da9510f930dda772361776c05b4">AP::PerfInfo::set_loop_rate</a></div><div class="ttdeci">void set_loop_rate(uint16_t rate_hz)</div><div class="ttdef"><b>Definition:</b> <a href="PerfInfo_8cpp_source.html#l00126">PerfInfo.cpp:126</a></div></div>
<div class="ttc" id="classAP_1_1PerfInfo_html_aa206e0cddd2693793323542bbf219739"><div class="ttname"><a href="classAP_1_1PerfInfo.html#aa206e0cddd2693793323542bbf219739">AP::PerfInfo::update_logging</a></div><div class="ttdeci">void update_logging()</div><div class="ttdef"><b>Definition:</b> <a href="PerfInfo_8cpp_source.html#l00114">PerfInfo.cpp:114</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_aac254dae02458baa122c8f61a8de0bb1"><div class="ttname"><a href="classAP__Scheduler.html#aac254dae02458baa122c8f61a8de0bb1">AP_Scheduler::AP_Scheduler</a></div><div class="ttdeci">AP_Scheduler(scheduler_fastloop_fn_t fastloop_fn=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00062">AP_Scheduler.cpp:62</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Util_html_a831bf144a4d14d413bd1c98b96dc35cb"><div class="ttname"><a href="classAP__HAL_1_1Util.html#a831bf144a4d14d413bd1c98b96dc35cb">AP_HAL::Util::perf_end</a></div><div class="ttdeci">virtual void perf_end(perf_counter_t h)</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00133">Util.h:133</a></div></div>
<div class="ttc" id="structAP__Param_1_1GroupInfo_html"><div class="ttname"><a href="structAP__Param_1_1GroupInfo.html">AP_Param::GroupInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00142">AP_Param.h:142</a></div></div>
<div class="ttc" id="structAP__HAL_1_1Util_1_1PersistentData_html"><div class="ttname"><a href="structAP__HAL_1_1Util_1_1PersistentData.html">AP_HAL::Util::PersistentData</a></div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00055">Util.h:55</a></div></div>
<div class="ttc" id="namespaceAP__HAL_html_a7aa0ce7625c9680e30ff4a99940907a5"><div class="ttname"><a href="namespaceAP__HAL.html#a7aa0ce7625c9680e30ff4a99940907a5">AP_HAL::micros64</a></div><div class="ttdeci">uint64_t micros64()</div><div class="ttdef"><b>Definition:</b> <a href="ChibiOS_2system_8cpp_source.html#l00167">system.cpp:167</a></div></div>
<div class="ttc" id="structAP__HAL_1_1Util_1_1PersistentData_html_a4f5c879b244083730a42e902fd307fad"><div class="ttname"><a href="structAP__HAL_1_1Util_1_1PersistentData.html#a4f5c879b244083730a42e902fd307fad">AP_HAL::Util::PersistentData::spi_count</a></div><div class="ttdeci">uint32_t spi_count</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00067">Util.h:67</a></div></div>
<div class="ttc" id="structAP__HAL_1_1Util_1_1PersistentData_html_a6fae0db0f91fce53a13ff9e25f74e058"><div class="ttname"><a href="structAP__HAL_1_1Util_1_1PersistentData.html#a6fae0db0f91fce53a13ff9e25f74e058">AP_HAL::Util::PersistentData::i2c_count</a></div><div class="ttdeci">uint32_t i2c_count</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00068">Util.h:68</a></div></div>
<div class="ttc" id="structAP__Scheduler_1_1Task_html"><div class="ttname"><a href="structAP__Scheduler_1_1Task.html">AP_Scheduler::Task</a></div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00070">AP_Scheduler.h:70</a></div></div>
<div class="ttc" id="structlog__Performance_html_abc5d61532f499ee7431c1d4c1aa6316f"><div class="ttname"><a href="structlog__Performance.html#abc5d61532f499ee7431c1d4c1aa6316f">log_Performance::max_time</a></div><div class="ttdeci">uint32_t max_time</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01109">LogStructure.h:1109</a></div></div>
<div class="ttc" id="structlog__Performance_html_a1827604a61a57494fee2cd7478e839cb"><div class="ttname"><a href="structlog__Performance.html#a1827604a61a57494fee2cd7478e839cb">log_Performance::spi_count</a></div><div class="ttdeci">uint32_t spi_count</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01114">LogStructure.h:1114</a></div></div>
<div class="ttc" id="AP__Vehicle_8h_html"><div class="ttname"><a href="AP__Vehicle_8h.html">AP_Vehicle.h</a></div></div>
<div class="ttc" id="structlog__Performance_html_a601db2fc5536ef85c0887b107cdd825c"><div class="ttname"><a href="structlog__Performance.html#a601db2fc5536ef85c0887b107cdd825c">log_Performance::internal_error_count</a></div><div class="ttdeci">uint32_t internal_error_count</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01113">LogStructure.h:1113</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a9214183e4771dcc7546e0eb91c814150"><div class="ttname"><a href="classAP__Scheduler.html#a9214183e4771dcc7546e0eb91c814150">AP_Scheduler::_last_loop_time_s</a></div><div class="ttdeci">float _last_loop_time_s</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00196">AP_Scheduler.h:196</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a8d5eeba086253d166ac8f195f39868b6"><div class="ttname"><a href="classAP__Scheduler.html#a8d5eeba086253d166ac8f195f39868b6">AP_Scheduler::loop</a></div><div class="ttdeci">void loop()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00232">AP_Scheduler.cpp:232</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a141789568619b15a4f5b536f819a95a3"><div class="ttname"><a href="classAP__Scheduler.html#a141789568619b15a4f5b536f819a95a3">AP_Scheduler::_task_time_started</a></div><div class="ttdeci">uint32_t _task_time_started</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00184">AP_Scheduler.h:184</a></div></div>
<div class="ttc" id="stdio_8h_html"><div class="ttname"><a href="stdio_8h.html">stdio.h</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Util_html_a8ee016bee7e471240be5a2c648015a1d"><div class="ttname"><a href="classAP__HAL_1_1Util.html#a8ee016bee7e471240be5a2c648015a1d">AP_HAL::Util::perf_begin</a></div><div class="ttdeci">virtual void perf_begin(perf_counter_t h)</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00132">Util.h:132</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_aa208b64f15deebbd5e72fe25b2a55f24"><div class="ttname"><a href="classAP__Scheduler.html#aa208b64f15deebbd5e72fe25b2a55f24">AP_Scheduler::_spare_ticks</a></div><div class="ttdeci">uint8_t _spare_ticks</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00190">AP_Scheduler.h:190</a></div></div>
<div class="ttc" id="classAP__InertialSensor_html_aa4faf114689e827390b5da7bc6fd5f20"><div class="ttname"><a href="classAP__InertialSensor.html#aa4faf114689e827390b5da7bc6fd5f20">AP_InertialSensor::wait_for_sample</a></div><div class="ttdeci">void wait_for_sample(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor_8cpp_source.html#l01358">AP_InertialSensor.cpp:1358</a></div></div>
<div class="ttc" id="structlog__Performance_html_a6871da3747262e21e06851aebf5fdb47"><div class="ttname"><a href="structlog__Performance.html#a6871da3747262e21e06851aebf5fdb47">log_Performance::load</a></div><div class="ttdeci">uint16_t load</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01111">LogStructure.h:1111</a></div></div>
<div class="ttc" id="AP__Scheduler_8cpp_html_ae08c3ca4ba26b63cda0bb3e3c6c02785"><div class="ttname"><a href="AP__Scheduler_8cpp.html#ae08c3ca4ba26b63cda0bb3e3c6c02785">hal</a></div><div class="ttdeci">const AP_HAL::HAL &amp; hal</div><div class="ttdef"><b>Definition:</b> <a href="AC__PID__test_8cpp_source.html#l00021">AC_PID_test.cpp:21</a></div></div>
<div class="ttc" id="classAP__HAL_1_1Scheduler_html_a78c4f1b1f192ac1c99544b6cc8f099b0"><div class="ttname"><a href="classAP__HAL_1_1Scheduler.html#a78c4f1b1f192ac1c99544b6cc8f099b0">AP_HAL::Scheduler::delay_microseconds</a></div><div class="ttdeci">virtual void delay_microseconds(uint16_t us)=0</div></div>
<div class="ttc" id="classAP__HAL_1_1Util_html_a64273fdab59825cea305a403054c25bf"><div class="ttname"><a href="classAP__HAL_1_1Util.html#a64273fdab59825cea305a403054c25bf">AP_HAL::Util::persistent_data</a></div><div class="ttdeci">struct PersistentData persistent_data</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00070">Util.h:70</a></div></div>
<div class="ttc" id="classAP_1_1PerfInfo_html_a9a6c1174425ac173efb2acf8b82c0e0a"><div class="ttname"><a href="classAP_1_1PerfInfo.html#a9a6c1174425ac173efb2acf8b82c0e0a">AP::PerfInfo::get_max_time</a></div><div class="ttdeci">uint32_t get_max_time() const</div><div class="ttdef"><b>Definition:</b> <a href="PerfInfo_8cpp_source.html#l00079">PerfInfo.cpp:79</a></div></div>
<div class="ttc" id="AP__Scheduler_8h_html"><div class="ttname"><a href="AP__Scheduler_8h.html">AP_Scheduler.h</a></div></div>
<div class="ttc" id="namespaceAP_html_ac571aa5a2ef71b7f4b4b2bfa09143fb9"><div class="ttname"><a href="namespaceAP.html#ac571aa5a2ef71b7f4b4b2bfa09143fb9">AP::ins</a></div><div class="ttdeci">AP_InertialSensor &amp; ins()</div><div class="ttdef"><b>Definition:</b> <a href="AP__InertialSensor_8cpp_source.html#l02076">AP_InertialSensor.cpp:2076</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a843cd9988490ee4c6c5f590f3537b43c"><div class="ttname"><a href="classAP__Scheduler.html#a843cd9988490ee4c6c5f590f3537b43c">AP_Scheduler::_tasks</a></div><div class="ttdeci">const struct Task * _tasks</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00168">AP_Scheduler.h:168</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a8e7219b4917480f699f9bfcec582fa11"><div class="ttname"><a href="classAP__Scheduler.html#a8e7219b4917480f699f9bfcec582fa11">AP_Scheduler::time_available_usec</a></div><div class="ttdeci">uint16_t time_available_usec(void)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00210">AP_Scheduler.cpp:210</a></div></div>
<div class="ttc" id="namespaceAP__HAL_html_a71832f03d849a0c088f04fc98d3c8143"><div class="ttname"><a href="namespaceAP__HAL.html#a71832f03d849a0c088f04fc98d3c8143">AP_HAL::panic</a></div><div class="ttdeci">void panic(const char *errormsg,...) FMT_PRINTF(1</div><div class="ttdef"><b>Definition:</b> <a href="ChibiOS_2system_8cpp_source.html#l00140">system.cpp:140</a></div></div>
<div class="ttc" id="classAP_1_1PerfInfo_html_a35fb1b18a36c6e3294f4ac4915f292ae"><div class="ttname"><a href="classAP_1_1PerfInfo.html#a35fb1b18a36c6e3294f4ac4915f292ae">AP::PerfInfo::get_num_long_running</a></div><div class="ttdeci">uint16_t get_num_long_running() const</div><div class="ttdef"><b>Definition:</b> <a href="PerfInfo_8cpp_source.html#l00091">PerfInfo.cpp:91</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a17856eb311134db5b97fa62ca2f8d2f9"><div class="ttname"><a href="classAP__Scheduler.html#a17856eb311134db5b97fa62ca2f8d2f9">AP_Scheduler::var_info</a></div><div class="ttdeci">static const struct AP_Param::GroupInfo var_info[]</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00143">AP_Scheduler.h:143</a></div></div>
<div class="ttc" id="AP__Scheduler_8cpp_html_a8bed03ebb2c9cf4622eff2c8eadf8e84"><div class="ttname"><a href="AP__Scheduler_8cpp.html#a8bed03ebb2c9cf4622eff2c8eadf8e84">SCHEDULER_DEFAULT_LOOP_RATE</a></div><div class="ttdeci">#define SCHEDULER_DEFAULT_LOOP_RATE</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00035">AP_Scheduler.cpp:35</a></div></div>
<div class="ttc" id="classAP_1_1PerfInfo_html_a427d86ad9b709fcec98bc21fbc06da30"><div class="ttname"><a href="classAP_1_1PerfInfo.html#a427d86ad9b709fcec98bc21fbc06da30">AP::PerfInfo::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdef"><b>Definition:</b> <a href="PerfInfo_8cpp_source.html#l00015">PerfInfo.cpp:15</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_acb1a139e45dbe0c449e6f389cb0a5633"><div class="ttname"><a href="classAP__Scheduler.html#acb1a139e45dbe0c449e6f389cb0a5633">AP_Scheduler::_tick_counter</a></div><div class="ttdeci">uint16_t _tick_counter</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00175">AP_Scheduler.h:175</a></div></div>
<div class="ttc" id="LogStructure_8h_html_abca6b52da10346c72b10dd04698e4420"><div class="ttname"><a href="LogStructure_8h.html#abca6b52da10346c72b10dd04698e4420">LOG_PACKET_HEADER_INIT</a></div><div class="ttdeci">#define LOG_PACKET_HEADER_INIT(id)</div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l00110">LogStructure.h:110</a></div></div>
<div class="ttc" id="namespaceAP_html_acdeafe5406efd2650ba54d24d3aecb7c"><div class="ttname"><a href="namespaceAP.html#acdeafe5406efd2650ba54d24d3aecb7c">AP::scheduler</a></div><div class="ttdeci">AP_Scheduler &amp; scheduler()</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8cpp_source.html#l00314">AP_Scheduler.cpp:314</a></div></div>
<div class="ttc" id="structlog__Performance_html"><div class="ttname"><a href="structlog__Performance.html">log_Performance</a></div><div class="ttdef"><b>Definition:</b> <a href="LogStructure_8h_source.html#l01104">LogStructure.h:1104</a></div></div>
<div class="ttc" id="namespaceAP__HAL_html_a8293355e35887733b1fd151aef08a787"><div class="ttname"><a href="namespaceAP__HAL.html#a8293355e35887733b1fd151aef08a787">AP_HAL::micros</a></div><div class="ttdeci">uint32_t micros()</div><div class="ttdef"><b>Definition:</b> <a href="ChibiOS_2system_8cpp_source.html#l00152">system.cpp:152</a></div></div>
<div class="ttc" id="AP__Param_8h_html_a0f9acb038a5283b964b862aea8cc5051"><div class="ttname"><a href="AP__Param_8h.html#a0f9acb038a5283b964b862aea8cc5051">AP_GROUPEND</a></div><div class="ttdeci">#define AP_GROUPEND</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8h_source.html#l00118">AP_Param.h:118</a></div></div>
<div class="ttc" id="classAP__HAL_1_1HAL_html_a94ab41309b1ff10b8b862b826e59c882"><div class="ttname"><a href="classAP__HAL_1_1HAL.html#a94ab41309b1ff10b8b862b826e59c882">AP_HAL::HAL::scheduler</a></div><div class="ttdeci">AP_HAL::Scheduler * scheduler</div><div class="ttdef"><b>Definition:</b> <a href="HAL_8h_source.html#l00114">HAL.h:114</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a0453a692bad08260da3b146ebc3ddafa"><div class="ttname"><a href="classAP__Scheduler.html#a0453a692bad08260da3b146ebc3ddafa">AP_Scheduler::_loop_timer_start_us</a></div><div class="ttdeci">uint32_t _loop_timer_start_us</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00193">AP_Scheduler.h:193</a></div></div>
<div class="ttc" id="classAP__Param_html_a5f6dcfce1c0a79cf5bd81283e22f3201"><div class="ttname"><a href="classAP__Param.html#a5f6dcfce1c0a79cf5bd81283e22f3201">AP_Param::setup_object_defaults</a></div><div class="ttdeci">static void setup_object_defaults(const void *object_pointer, const struct GroupInfo *group_info)</div><div class="ttdef"><b>Definition:</b> <a href="AP__Param_8cpp_source.html#l01265">AP_Param.cpp:1265</a></div></div>
<div class="ttc" id="classAP__InternalError_html_a4396aa49ba2d14f80df61bfbd9c17de3"><div class="ttname"><a href="classAP__InternalError.html#a4396aa49ba2d14f80df61bfbd9c17de3">AP_InternalError::errors</a></div><div class="ttdeci">uint32_t errors() const</div><div class="ttdef"><b>Definition:</b> <a href="AP__InternalError_8h_source.html#l00061">AP_InternalError.h:61</a></div></div>
<div class="ttc" id="classAP__Scheduler_html_a4ec06632df7f98446d76f5090ca8d43b"><div class="ttname"><a href="classAP__Scheduler.html#a4ec06632df7f98446d76f5090ca8d43b">AP_Scheduler::perf_info</a></div><div class="ttdeci">AP::PerfInfo perf_info</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00146">AP_Scheduler.h:146</a></div></div>
<div class="ttc" id="structAP__Scheduler_1_1Task_html_ae8b2138ab213591aaa1a639a8101df79"><div class="ttname"><a href="structAP__Scheduler_1_1Task.html#ae8b2138ab213591aaa1a639a8101df79">AP_Scheduler::Task::function</a></div><div class="ttdeci">task_fn_t function</div><div class="ttdef"><b>Definition:</b> <a href="AP__Scheduler_8h_source.html#l00071">AP_Scheduler.h:71</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jul 11 2019 14:17:35 for APM:Libraries by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
